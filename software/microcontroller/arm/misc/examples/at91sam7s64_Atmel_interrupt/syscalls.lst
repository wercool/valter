   1              		.file	"syscalls.c"
   9              	.Ltext0:
  10              		.align	2
  12              	my_putc:
  13              	.LFB290:
  14              		.file 1 "syscalls.c"
   1:syscalls.c    **** /***********************************************************************/
   2:syscalls.c    **** /*                                                                     */
   3:syscalls.c    **** /*  SYSCALLS.C:  System Calls                                          */
   4:syscalls.c    **** /*  most of this is from newlib-lpc and a Keil-demo                    */
   5:syscalls.c    **** /*                                                                     */
   6:syscalls.c    **** /*  These are "reentrant functions" as needed by                       */
   7:syscalls.c    **** /*  the WinARM-newlib-config, see newlib-manual.                       */
   8:syscalls.c    **** /*  Collected and modified by Martin Thomas                            */
   9:syscalls.c    **** /*                                                                     */
  10:syscalls.c    **** /***********************************************************************/
  11:syscalls.c    **** 
  12:syscalls.c    **** 
  13:syscalls.c    **** #include <stdlib.h>
  14:syscalls.c    **** #include <reent.h>
  15:syscalls.c    **** #include <sys/stat.h>
  16:syscalls.c    **** 
  17:syscalls.c    **** #include "Board.h"
  18:syscalls.c    **** 
  19:syscalls.c    **** static void my_putc(char c) 
  20:syscalls.c    **** {
  15              		.loc 1 20 0
  16              		@ Function supports interworking.
  17              		@ args = 0, pretend = 0, frame = 0
  18              		@ frame_needed = 0, uses_anonymous_args = 0
  19              		@ link register save eliminated.
  20              	.LVL0:
  21              		@ lr needed for prologue
  22 0000 FF0000E2 		and	r0, r0, #255
  23              	.L3:
  24              	.LBB6:
  25              	.LBB7:
  26              		.file 2 "lib_AT91SAM7S64.h"
   1:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   2:lib_AT91SAM7S64.h **** //*         ATMEL Microcontroller Software Support  -  ROUSSET  -
   3:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   4:lib_AT91SAM7S64.h **** //* DISCLAIMER:  THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR
   5:lib_AT91SAM7S64.h **** //* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
   6:lib_AT91SAM7S64.h **** //* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
   7:lib_AT91SAM7S64.h **** //* DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT, INDIRECT,
   8:lib_AT91SAM7S64.h **** //* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   9:lib_AT91SAM7S64.h **** //* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
  10:lib_AT91SAM7S64.h **** //* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  11:lib_AT91SAM7S64.h **** //* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  12:lib_AT91SAM7S64.h **** //* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
  13:lib_AT91SAM7S64.h **** //* EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  14:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  15:lib_AT91SAM7S64.h **** //* File Name           : lib_AT91SAM7S64.h
  16:lib_AT91SAM7S64.h **** //* Object              : AT91SAM7S64 inlined functions
  17:lib_AT91SAM7S64.h **** //* Generated           : AT91 SW Application Group  08/30/2005 (15:52:59)
  18:lib_AT91SAM7S64.h **** //*
  19:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_dbgu.h/1.1/Thu Aug 25 12:56:22 2005//
  20:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pmc_SAM7S.h/1.4/Tue Aug 30 13:00:43 2005//
  21:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_VREG_6085B.h/1.1/Tue Feb  1 16:20:47 2005//
  22:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rstc_6098A.h/1.1/Wed Oct  6 10:39:20 2004//
  23:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_ssc.h/1.4/Fri Jan 31 12:19:20 2003//
  24:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_wdtc_6080A.h/1.1/Wed Oct  6 10:38:30 2004//
  25:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_usart.h/1.5/Thu Nov 21 16:01:54 2002//
  26:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_spi2.h/1.2/Tue Aug 23 15:37:28 2005//
  27:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pitc_6079A.h/1.2/Tue Nov  9 14:43:56 2004//
  28:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_aic_6075b.h/1.2/Thu Jul  7 07:48:22 2005//
  29:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_twi.h/1.3/Mon Jul 19 14:27:58 2004//
  30:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_adc.h/1.6/Fri Oct 17 09:12:38 2003//
  31:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rttc_6081A.h/1.1/Wed Oct  6 10:39:38 2004//
  32:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_udp.h/1.5/Tue Aug 30 12:13:47 2005//
  33:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_tc_1753b.h/1.1/Fri Jan 31 12:20:02 2003//
  34:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_MC_SAM7S.h/1.1/Thu Mar 25 15:19:14 2004//
  35:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pio.h/1.3/Fri Jan 31 12:18:56 2003//
  36:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_PWM_SAM.h/1.3/Thu Jan 22 10:10:50 2004//
  37:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pdc.h/1.2/Tue Jul  2 13:29:40 2002//
  38:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  39:lib_AT91SAM7S64.h **** 
  40:lib_AT91SAM7S64.h **** #ifndef lib_AT91SAM7S64_H
  41:lib_AT91SAM7S64.h **** #define lib_AT91SAM7S64_H
  42:lib_AT91SAM7S64.h **** 
  43:lib_AT91SAM7S64.h **** /* *****************************************************************************
  44:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR AIC
  45:lib_AT91SAM7S64.h ****    ***************************************************************************** */
  46:lib_AT91SAM7S64.h **** #define AT91C_AIC_BRANCH_OPCODE ((void (*) ()) 0xE51FFF20) // ldr, pc, [pc, #-&F20]
  47:lib_AT91SAM7S64.h **** 
  48:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  49:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ConfigureIt
  50:lib_AT91SAM7S64.h **** //* \brief Interrupt Handler Initialization
  51:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  52:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_AIC_ConfigureIt (
  53:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,  // \arg pointer to the AIC registers
  54:lib_AT91SAM7S64.h **** 	unsigned int irq_id,     // \arg interrupt number to initialize
  55:lib_AT91SAM7S64.h **** 	unsigned int priority,   // \arg priority to give to the interrupt
  56:lib_AT91SAM7S64.h **** 	unsigned int src_type,   // \arg activation and sense of activation
  57:lib_AT91SAM7S64.h **** 	void (*newHandler) () ) // \arg address of the interrupt handler
  58:lib_AT91SAM7S64.h **** {
  59:lib_AT91SAM7S64.h **** 	unsigned int oldHandler;
  60:lib_AT91SAM7S64.h ****     unsigned int mask ;
  61:lib_AT91SAM7S64.h **** 
  62:lib_AT91SAM7S64.h ****     oldHandler = pAic->AIC_SVR[irq_id];
  63:lib_AT91SAM7S64.h **** 
  64:lib_AT91SAM7S64.h ****     mask = 0x1 << irq_id ;
  65:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  66:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
  67:lib_AT91SAM7S64.h ****     //* Save the interrupt handler routine pointer and the interrupt priority
  68:lib_AT91SAM7S64.h ****     pAic->AIC_SVR[irq_id] = (unsigned int) newHandler ;
  69:lib_AT91SAM7S64.h ****     //* Store the Source Mode Register
  70:lib_AT91SAM7S64.h ****     pAic->AIC_SMR[irq_id] = src_type | priority  ;
  71:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the interrupt controller
  72:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
  73:lib_AT91SAM7S64.h **** 
  74:lib_AT91SAM7S64.h **** 	return oldHandler;
  75:lib_AT91SAM7S64.h **** }
  76:lib_AT91SAM7S64.h **** 
  77:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  78:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_EnableIt
  79:lib_AT91SAM7S64.h **** //* \brief Enable corresponding IT number
  80:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  81:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_EnableIt (
  82:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  83:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  84:lib_AT91SAM7S64.h **** {
  85:lib_AT91SAM7S64.h ****     //* Enable the interrupt on the interrupt controller
  86:lib_AT91SAM7S64.h ****     pAic->AIC_IECR = 0x1 << irq_id ;
  87:lib_AT91SAM7S64.h **** }
  88:lib_AT91SAM7S64.h **** 
  89:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  90:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_DisableIt
  91:lib_AT91SAM7S64.h **** //* \brief Disable corresponding IT number
  92:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  93:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_DisableIt (
  94:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  95:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  96:lib_AT91SAM7S64.h **** {
  97:lib_AT91SAM7S64.h ****     unsigned int mask = 0x1 << irq_id;
  98:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  99:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
 100:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 101:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
 102:lib_AT91SAM7S64.h **** }
 103:lib_AT91SAM7S64.h **** 
 104:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 105:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ClearIt
 106:lib_AT91SAM7S64.h **** //* \brief Clear corresponding IT number
 107:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 108:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_ClearIt (
 109:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 110:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number to initialize
 111:lib_AT91SAM7S64.h **** {
 112:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 113:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = (0x1 << irq_id);
 114:lib_AT91SAM7S64.h **** }
 115:lib_AT91SAM7S64.h **** 
 116:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 117:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_AcknowledgeIt
 118:lib_AT91SAM7S64.h **** //* \brief Acknowledge corresponding IT number
 119:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 120:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_AcknowledgeIt (
 121:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic)     // \arg pointer to the AIC registers
 122:lib_AT91SAM7S64.h **** {
 123:lib_AT91SAM7S64.h ****     pAic->AIC_EOICR = pAic->AIC_EOICR;
 124:lib_AT91SAM7S64.h **** }
 125:lib_AT91SAM7S64.h **** 
 126:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 127:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_SetExceptionVector
 128:lib_AT91SAM7S64.h **** //* \brief Configure vector handler
 129:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 130:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_SetExceptionVector (
 131:lib_AT91SAM7S64.h **** 	unsigned int *pVector, // \arg pointer to the AIC registers
 132:lib_AT91SAM7S64.h **** 	void (*Handler) () )   // \arg Interrupt Handler
 133:lib_AT91SAM7S64.h **** {
 134:lib_AT91SAM7S64.h **** 	unsigned int oldVector = *pVector;
 135:lib_AT91SAM7S64.h **** 
 136:lib_AT91SAM7S64.h **** 	if ((unsigned int) Handler == (unsigned int) AT91C_AIC_BRANCH_OPCODE)
 137:lib_AT91SAM7S64.h **** 		*pVector = (unsigned int) AT91C_AIC_BRANCH_OPCODE;
 138:lib_AT91SAM7S64.h **** 	else
 139:lib_AT91SAM7S64.h **** 		*pVector = (((((unsigned int) Handler) - ((unsigned int) pVector) - 0x8) >> 2) & 0x00FFFFFF) | 0x
 140:lib_AT91SAM7S64.h **** 
 141:lib_AT91SAM7S64.h **** 	return oldVector;
 142:lib_AT91SAM7S64.h **** }
 143:lib_AT91SAM7S64.h **** 
 144:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 145:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Trig
 146:lib_AT91SAM7S64.h **** //* \brief Trig an IT
 147:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 148:lib_AT91SAM7S64.h **** __inline void  AT91F_AIC_Trig (
 149:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 150:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number
 151:lib_AT91SAM7S64.h **** {
 152:lib_AT91SAM7S64.h **** 	pAic->AIC_ISCR = (0x1 << irq_id) ;
 153:lib_AT91SAM7S64.h **** }
 154:lib_AT91SAM7S64.h **** 
 155:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 156:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsActive
 157:lib_AT91SAM7S64.h **** //* \brief Test if an IT is active
 158:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 159:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsActive (
 160:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 161:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 162:lib_AT91SAM7S64.h **** {
 163:lib_AT91SAM7S64.h **** 	return (pAic->AIC_ISR & (0x1 << irq_id));
 164:lib_AT91SAM7S64.h **** }
 165:lib_AT91SAM7S64.h **** 
 166:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 167:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsPending
 168:lib_AT91SAM7S64.h **** //* \brief Test if an IT is pending
 169:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 170:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsPending (
 171:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 172:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 173:lib_AT91SAM7S64.h **** {
 174:lib_AT91SAM7S64.h **** 	return (pAic->AIC_IPR & (0x1 << irq_id));
 175:lib_AT91SAM7S64.h **** }
 176:lib_AT91SAM7S64.h **** 
 177:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 178:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Open
 179:lib_AT91SAM7S64.h **** //* \brief Set exception vectors and AIC registers to default values
 180:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 181:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_Open(
 182:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,        // \arg pointer to the AIC registers
 183:lib_AT91SAM7S64.h **** 	void (*IrqHandler) (),  // \arg Default IRQ vector exception
 184:lib_AT91SAM7S64.h **** 	void (*FiqHandler) (),  // \arg Default FIQ vector exception
 185:lib_AT91SAM7S64.h **** 	void (*DefaultHandler)  (), // \arg Default Handler set in ISR
 186:lib_AT91SAM7S64.h **** 	void (*SpuriousHandler) (), // \arg Default Spurious Handler
 187:lib_AT91SAM7S64.h **** 	unsigned int protectMode)   // \arg Debug Control Register
 188:lib_AT91SAM7S64.h **** {
 189:lib_AT91SAM7S64.h **** 	int i;
 190:lib_AT91SAM7S64.h **** 
 191:lib_AT91SAM7S64.h **** 	// Disable all interrupts and set IVR to the default handler
 192:lib_AT91SAM7S64.h **** 	for (i = 0; i < 32; ++i) {
 193:lib_AT91SAM7S64.h **** 		AT91F_AIC_DisableIt(pAic, i);
 194:lib_AT91SAM7S64.h **** 		AT91F_AIC_ConfigureIt(pAic, i, AT91C_AIC_PRIOR_LOWEST, AT91C_AIC_SRCTYPE_HIGH_LEVEL, DefaultHandl
 195:lib_AT91SAM7S64.h **** 	}
 196:lib_AT91SAM7S64.h **** 
 197:lib_AT91SAM7S64.h **** 	// Set the IRQ exception vector
 198:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x18, IrqHandler);
 199:lib_AT91SAM7S64.h **** 	// Set the Fast Interrupt exception vector
 200:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x1C, FiqHandler);
 201:lib_AT91SAM7S64.h **** 
 202:lib_AT91SAM7S64.h **** 	pAic->AIC_SPU = (unsigned int) SpuriousHandler;
 203:lib_AT91SAM7S64.h **** 	pAic->AIC_DCR = protectMode;
 204:lib_AT91SAM7S64.h **** }
 205:lib_AT91SAM7S64.h **** /* *****************************************************************************
 206:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PDC
 207:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 208:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 209:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextRx
 210:lib_AT91SAM7S64.h **** //* \brief Set the next receive transfer descriptor
 211:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 212:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextRx (
 213:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,     // \arg pointer to a PDC controller
 214:lib_AT91SAM7S64.h **** 	char *address,       // \arg address to the next bloc to be received
 215:lib_AT91SAM7S64.h **** 	unsigned int bytes)  // \arg number of bytes to be received
 216:lib_AT91SAM7S64.h **** {
 217:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNPR = (unsigned int) address;
 218:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNCR = bytes;
 219:lib_AT91SAM7S64.h **** }
 220:lib_AT91SAM7S64.h **** 
 221:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 222:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextTx
 223:lib_AT91SAM7S64.h **** //* \brief Set the next transmit transfer descriptor
 224:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 225:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextTx (
 226:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 227:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 228:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 229:lib_AT91SAM7S64.h **** {
 230:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNPR = (unsigned int) address;
 231:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNCR = bytes;
 232:lib_AT91SAM7S64.h **** }
 233:lib_AT91SAM7S64.h **** 
 234:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 235:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetRx
 236:lib_AT91SAM7S64.h **** //* \brief Set the receive transfer descriptor
 237:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 238:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetRx (
 239:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 240:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be received
 241:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be received
 242:lib_AT91SAM7S64.h **** {
 243:lib_AT91SAM7S64.h **** 	pPDC->PDC_RPR = (unsigned int) address;
 244:lib_AT91SAM7S64.h **** 	pPDC->PDC_RCR = bytes;
 245:lib_AT91SAM7S64.h **** }
 246:lib_AT91SAM7S64.h **** 
 247:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 248:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetTx
 249:lib_AT91SAM7S64.h **** //* \brief Set the transmit transfer descriptor
 250:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 251:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetTx (
 252:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 253:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 254:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 255:lib_AT91SAM7S64.h **** {
 256:lib_AT91SAM7S64.h **** 	pPDC->PDC_TPR = (unsigned int) address;
 257:lib_AT91SAM7S64.h **** 	pPDC->PDC_TCR = bytes;
 258:lib_AT91SAM7S64.h **** }
 259:lib_AT91SAM7S64.h **** 
 260:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 261:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableTx
 262:lib_AT91SAM7S64.h **** //* \brief Enable transmit
 263:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 264:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableTx (
 265:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 266:lib_AT91SAM7S64.h **** {
 267:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTEN;
 268:lib_AT91SAM7S64.h **** }
 269:lib_AT91SAM7S64.h **** 
 270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableRx
 272:lib_AT91SAM7S64.h **** //* \brief Enable receive
 273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 274:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableRx (
 275:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 276:lib_AT91SAM7S64.h **** {
 277:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTEN;
 278:lib_AT91SAM7S64.h **** }
 279:lib_AT91SAM7S64.h **** 
 280:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 281:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableTx
 282:lib_AT91SAM7S64.h **** //* \brief Disable transmit
 283:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 284:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableTx (
 285:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 286:lib_AT91SAM7S64.h **** {
 287:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTDIS;
 288:lib_AT91SAM7S64.h **** }
 289:lib_AT91SAM7S64.h **** 
 290:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 291:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableRx
 292:lib_AT91SAM7S64.h **** //* \brief Disable receive
 293:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 294:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableRx (
 295:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 296:lib_AT91SAM7S64.h **** {
 297:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTDIS;
 298:lib_AT91SAM7S64.h **** }
 299:lib_AT91SAM7S64.h **** 
 300:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 301:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsTxEmpty
 302:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been sent
 303:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 304:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsTxEmpty ( // \return return 1 if transfer is complete
 305:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 306:lib_AT91SAM7S64.h **** {
 307:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TCR);
 308:lib_AT91SAM7S64.h **** }
 309:lib_AT91SAM7S64.h **** 
 310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 311:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextTxEmpty
 312:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 314:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextTxEmpty ( // \return return 1 if transfer is complete
 315:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 316:lib_AT91SAM7S64.h **** {
 317:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TNCR);
 318:lib_AT91SAM7S64.h **** }
 319:lib_AT91SAM7S64.h **** 
 320:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 321:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsRxEmpty
 322:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been filled
 323:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 324:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsRxEmpty ( // \return return 1 if transfer is complete
 325:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 326:lib_AT91SAM7S64.h **** {
 327:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RCR);
 328:lib_AT91SAM7S64.h **** }
 329:lib_AT91SAM7S64.h **** 
 330:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 331:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextRxEmpty
 332:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 333:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 334:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextRxEmpty ( // \return return 1 if transfer is complete
 335:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 336:lib_AT91SAM7S64.h **** {
 337:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RNCR);
 338:lib_AT91SAM7S64.h **** }
 339:lib_AT91SAM7S64.h **** 
 340:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 341:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Open
 342:lib_AT91SAM7S64.h **** //* \brief Open PDC: disable TX and RX reset transfer descriptors, re-enable RX and TX
 343:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 344:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Open (
 345:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 346:lib_AT91SAM7S64.h **** {
 347:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 348:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 349:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 350:lib_AT91SAM7S64.h **** 
 351:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 352:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 353:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 354:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 355:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 356:lib_AT91SAM7S64.h **** 
 357:lib_AT91SAM7S64.h ****     //* Enable the RX and TX PDC transfer requests
 358:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableRx(pPDC);
 359:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableTx(pPDC);
 360:lib_AT91SAM7S64.h **** }
 361:lib_AT91SAM7S64.h **** 
 362:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 363:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Close
 364:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 365:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 366:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Close (
 367:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 368:lib_AT91SAM7S64.h **** {
 369:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 370:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 371:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 372:lib_AT91SAM7S64.h **** 
 373:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 374:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 375:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 376:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 377:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 378:lib_AT91SAM7S64.h **** 
 379:lib_AT91SAM7S64.h **** }
 380:lib_AT91SAM7S64.h **** 
 381:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 382:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SendFrame
 383:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 384:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 385:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_SendFrame(
 386:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 387:lib_AT91SAM7S64.h **** 	char *pBuffer,
 388:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 389:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 390:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 391:lib_AT91SAM7S64.h **** {
 392:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsTxEmpty(pPDC)) {
 393:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 394:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetTx(pPDC, pBuffer, szBuffer);
 395:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pNextBuffer, szNextBuffer);
 396:lib_AT91SAM7S64.h **** 		return 2;
 397:lib_AT91SAM7S64.h **** 	}
 398:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextTxEmpty(pPDC)) {
 399:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 400:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pBuffer, szBuffer);
 401:lib_AT91SAM7S64.h **** 		return 1;
 402:lib_AT91SAM7S64.h **** 	}
 403:lib_AT91SAM7S64.h **** 	else {
 404:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 405:lib_AT91SAM7S64.h **** 		return 0;
 406:lib_AT91SAM7S64.h **** 	}
 407:lib_AT91SAM7S64.h **** }
 408:lib_AT91SAM7S64.h **** 
 409:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 410:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_ReceiveFrame
 411:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 412:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 413:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_ReceiveFrame (
 414:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 415:lib_AT91SAM7S64.h **** 	char *pBuffer,
 416:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 417:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 418:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 419:lib_AT91SAM7S64.h **** {
 420:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsRxEmpty(pPDC)) {
 421:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 422:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetRx(pPDC, pBuffer, szBuffer);
 423:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pNextBuffer, szNextBuffer);
 424:lib_AT91SAM7S64.h **** 		return 2;
 425:lib_AT91SAM7S64.h **** 	}
 426:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextRxEmpty(pPDC)) {
 427:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 428:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pBuffer, szBuffer);
 429:lib_AT91SAM7S64.h **** 		return 1;
 430:lib_AT91SAM7S64.h **** 	}
 431:lib_AT91SAM7S64.h **** 	else {
 432:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 433:lib_AT91SAM7S64.h **** 		return 0;
 434:lib_AT91SAM7S64.h **** 	}
 435:lib_AT91SAM7S64.h **** }
 436:lib_AT91SAM7S64.h **** /* *****************************************************************************
 437:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR DBGU
 438:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 439:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 440:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptEnable
 441:lib_AT91SAM7S64.h **** //* \brief Enable DBGU Interrupt
 442:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 443:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptEnable(
 444:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 445:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be enabled
 446:lib_AT91SAM7S64.h **** {
 447:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IER = flag;
 448:lib_AT91SAM7S64.h **** }
 449:lib_AT91SAM7S64.h **** 
 450:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 451:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptDisable
 452:lib_AT91SAM7S64.h **** //* \brief Disable DBGU Interrupt
 453:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 454:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptDisable(
 455:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 456:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be disabled
 457:lib_AT91SAM7S64.h **** {
 458:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IDR = flag;
 459:lib_AT91SAM7S64.h **** }
 460:lib_AT91SAM7S64.h **** 
 461:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 462:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_GetInterruptMaskStatus
 463:lib_AT91SAM7S64.h **** //* \brief Return DBGU Interrupt Mask Status
 464:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 465:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_DBGU_GetInterruptMaskStatus( // \return DBGU Interrupt Mask Status
 466:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu) // \arg  pointer to a DBGU controller
 467:lib_AT91SAM7S64.h **** {
 468:lib_AT91SAM7S64.h ****         return pDbgu->DBGU_IMR;
 469:lib_AT91SAM7S64.h **** }
 470:lib_AT91SAM7S64.h **** 
 471:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 472:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_IsInterruptMasked
 473:lib_AT91SAM7S64.h **** //* \brief Test if DBGU Interrupt is Masked 
 474:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 475:lib_AT91SAM7S64.h **** __inline int AT91F_DBGU_IsInterruptMasked(
 476:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 477:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 478:lib_AT91SAM7S64.h **** {
 479:lib_AT91SAM7S64.h ****         return (AT91F_DBGU_GetInterruptMaskStatus(pDbgu) & flag);
 480:lib_AT91SAM7S64.h **** }
 481:lib_AT91SAM7S64.h **** 
 482:lib_AT91SAM7S64.h **** /* *****************************************************************************
 483:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PIO
 484:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 485:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 486:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPeriph
 487:lib_AT91SAM7S64.h **** //* \brief Enable pins to be drived by peripheral
 488:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 489:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPeriph(
 490:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 491:lib_AT91SAM7S64.h **** 	unsigned int periphAEnable,  // \arg PERIPH A to enable
 492:lib_AT91SAM7S64.h **** 	unsigned int periphBEnable)  // \arg PERIPH B to enable
 493:lib_AT91SAM7S64.h **** 
 494:lib_AT91SAM7S64.h **** {
 495:lib_AT91SAM7S64.h **** 	pPio->PIO_ASR = periphAEnable;
 496:lib_AT91SAM7S64.h **** 	pPio->PIO_BSR = periphBEnable;
 497:lib_AT91SAM7S64.h **** 	pPio->PIO_PDR = (periphAEnable | periphBEnable); // Set in Periph mode
 498:lib_AT91SAM7S64.h **** }
 499:lib_AT91SAM7S64.h **** 
 500:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 501:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOutput
 502:lib_AT91SAM7S64.h **** //* \brief Enable PIO in output mode
 503:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 504:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOutput(
 505:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 506:lib_AT91SAM7S64.h **** 	unsigned int pioEnable)      // \arg PIO to be enabled
 507:lib_AT91SAM7S64.h **** {
 508:lib_AT91SAM7S64.h **** 	pPio->PIO_PER = pioEnable; // Set in PIO mode
 509:lib_AT91SAM7S64.h **** 	pPio->PIO_OER = pioEnable; // Configure in Output
 510:lib_AT91SAM7S64.h **** }
 511:lib_AT91SAM7S64.h **** 
 512:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 513:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInput
 514:lib_AT91SAM7S64.h **** //* \brief Enable PIO in input mode
 515:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 516:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInput(
 517:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 518:lib_AT91SAM7S64.h **** 	unsigned int inputEnable)      // \arg PIO to be enabled
 519:lib_AT91SAM7S64.h **** {
 520:lib_AT91SAM7S64.h **** 	// Disable output
 521:lib_AT91SAM7S64.h **** 	pPio->PIO_ODR  = inputEnable;
 522:lib_AT91SAM7S64.h **** 	pPio->PIO_PER  = inputEnable;
 523:lib_AT91SAM7S64.h **** }
 524:lib_AT91SAM7S64.h **** 
 525:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 526:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOpendrain
 527:lib_AT91SAM7S64.h **** //* \brief Configure PIO in open drain
 528:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 529:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOpendrain(
 530:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 531:lib_AT91SAM7S64.h **** 	unsigned int multiDrvEnable) // \arg pio to be configured in open drain
 532:lib_AT91SAM7S64.h **** {
 533:lib_AT91SAM7S64.h **** 	// Configure the multi-drive option
 534:lib_AT91SAM7S64.h **** 	pPio->PIO_MDDR = ~multiDrvEnable;
 535:lib_AT91SAM7S64.h **** 	pPio->PIO_MDER = multiDrvEnable;
 536:lib_AT91SAM7S64.h **** }
 537:lib_AT91SAM7S64.h **** 
 538:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 539:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPullup
 540:lib_AT91SAM7S64.h **** //* \brief Enable pullup on PIO
 541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 542:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPullup(
 543:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 544:lib_AT91SAM7S64.h **** 	unsigned int pullupEnable)   // \arg enable pullup on PIO
 545:lib_AT91SAM7S64.h **** {
 546:lib_AT91SAM7S64.h **** 		// Connect or not Pullup
 547:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUDR = ~pullupEnable;
 548:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUER = pullupEnable;
 549:lib_AT91SAM7S64.h **** }
 550:lib_AT91SAM7S64.h **** 
 551:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 552:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgDirectDrive
 553:lib_AT91SAM7S64.h **** //* \brief Enable direct drive on PIO
 554:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 555:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgDirectDrive(
 556:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 557:lib_AT91SAM7S64.h **** 	unsigned int directDrive)    // \arg PIO to be configured with direct drive
 558:lib_AT91SAM7S64.h **** 
 559:lib_AT91SAM7S64.h **** {
 560:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 561:lib_AT91SAM7S64.h **** 	pPio->PIO_OWDR  = ~directDrive;
 562:lib_AT91SAM7S64.h **** 	pPio->PIO_OWER  = directDrive;
 563:lib_AT91SAM7S64.h **** }
 564:lib_AT91SAM7S64.h **** 
 565:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 566:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInputFilter
 567:lib_AT91SAM7S64.h **** //* \brief Enable input filter on input PIO
 568:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 569:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInputFilter(
 570:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 571:lib_AT91SAM7S64.h **** 	unsigned int inputFilter)    // \arg PIO to be configured with input filter
 572:lib_AT91SAM7S64.h **** 
 573:lib_AT91SAM7S64.h **** {
 574:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 575:lib_AT91SAM7S64.h **** 	pPio->PIO_IFDR  = ~inputFilter;
 576:lib_AT91SAM7S64.h **** 	pPio->PIO_IFER  = inputFilter;
 577:lib_AT91SAM7S64.h **** }
 578:lib_AT91SAM7S64.h **** 
 579:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 580:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInput
 581:lib_AT91SAM7S64.h **** //* \brief Return PIO input value
 582:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 583:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInput( // \return PIO input
 584:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 585:lib_AT91SAM7S64.h **** {
 586:lib_AT91SAM7S64.h **** 	return pPio->PIO_PDSR;
 587:lib_AT91SAM7S64.h **** }
 588:lib_AT91SAM7S64.h **** 
 589:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 590:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputSet
 591:lib_AT91SAM7S64.h **** //* \brief Test if PIO is input flag is active
 592:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 593:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputSet(
 594:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 595:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  flag to be tested
 596:lib_AT91SAM7S64.h **** {
 597:lib_AT91SAM7S64.h **** 	return (AT91F_PIO_GetInput(pPio) & flag);
 598:lib_AT91SAM7S64.h **** }
 599:lib_AT91SAM7S64.h **** 
 600:lib_AT91SAM7S64.h **** 
 601:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 602:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_SetOutput
 603:lib_AT91SAM7S64.h **** //* \brief Set to 1 output PIO
 604:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 605:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_SetOutput(
 606:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 607:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be set
 608:lib_AT91SAM7S64.h **** {
 609:lib_AT91SAM7S64.h **** 	pPio->PIO_SODR = flag;
 610:lib_AT91SAM7S64.h **** }
 611:lib_AT91SAM7S64.h **** 
 612:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 613:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ClearOutput
 614:lib_AT91SAM7S64.h **** //* \brief Set to 0 output PIO
 615:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 616:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ClearOutput(
 617:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 618:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be cleared
 619:lib_AT91SAM7S64.h **** {
 620:lib_AT91SAM7S64.h **** 	pPio->PIO_CODR = flag;
 621:lib_AT91SAM7S64.h **** }
 622:lib_AT91SAM7S64.h **** 
 623:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 624:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ForceOutput
 625:lib_AT91SAM7S64.h **** //* \brief Force output when Direct drive option is enabled
 626:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 627:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ForceOutput(
 628:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 629:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be forced
 630:lib_AT91SAM7S64.h **** {
 631:lib_AT91SAM7S64.h **** 	pPio->PIO_ODSR = flag;
 632:lib_AT91SAM7S64.h **** }
 633:lib_AT91SAM7S64.h **** 
 634:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 635:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Enable
 636:lib_AT91SAM7S64.h **** //* \brief Enable PIO
 637:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 638:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Enable(
 639:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 640:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled 
 641:lib_AT91SAM7S64.h **** {
 642:lib_AT91SAM7S64.h ****         pPio->PIO_PER = flag;
 643:lib_AT91SAM7S64.h **** }
 644:lib_AT91SAM7S64.h **** 
 645:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 646:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Disable
 647:lib_AT91SAM7S64.h **** //* \brief Disable PIO
 648:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 649:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Disable(
 650:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 651:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled 
 652:lib_AT91SAM7S64.h **** {
 653:lib_AT91SAM7S64.h ****         pPio->PIO_PDR = flag;
 654:lib_AT91SAM7S64.h **** }
 655:lib_AT91SAM7S64.h **** 
 656:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 657:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetStatus
 658:lib_AT91SAM7S64.h **** //* \brief Return PIO Status
 659:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 660:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetStatus( // \return PIO Status
 661:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 662:lib_AT91SAM7S64.h **** {
 663:lib_AT91SAM7S64.h ****         return pPio->PIO_PSR;
 664:lib_AT91SAM7S64.h **** }
 665:lib_AT91SAM7S64.h **** 
 666:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 667:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsSet
 668:lib_AT91SAM7S64.h **** //* \brief Test if PIO is Set
 669:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 670:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsSet(
 671:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 672:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 673:lib_AT91SAM7S64.h **** {
 674:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetStatus(pPio) & flag);
 675:lib_AT91SAM7S64.h **** }
 676:lib_AT91SAM7S64.h **** 
 677:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 678:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputEnable
 679:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 680:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 681:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputEnable(
 682:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 683:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be enabled
 684:lib_AT91SAM7S64.h **** {
 685:lib_AT91SAM7S64.h ****         pPio->PIO_OER = flag;
 686:lib_AT91SAM7S64.h **** }
 687:lib_AT91SAM7S64.h **** 
 688:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 689:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputDisable
 690:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 691:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 692:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputDisable(
 693:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 694:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be disabled
 695:lib_AT91SAM7S64.h **** {
 696:lib_AT91SAM7S64.h ****         pPio->PIO_ODR = flag;
 697:lib_AT91SAM7S64.h **** }
 698:lib_AT91SAM7S64.h **** 
 699:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 700:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputStatus
 701:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Status
 702:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 703:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputStatus( // \return PIO Output Status
 704:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 705:lib_AT91SAM7S64.h **** {
 706:lib_AT91SAM7S64.h ****         return pPio->PIO_OSR;
 707:lib_AT91SAM7S64.h **** }
 708:lib_AT91SAM7S64.h **** 
 709:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 710:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOuputSet
 711:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output is Set
 712:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 713:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputSet(
 714:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 715:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 716:lib_AT91SAM7S64.h **** {
 717:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputStatus(pPio) & flag);
 718:lib_AT91SAM7S64.h **** }
 719:lib_AT91SAM7S64.h **** 
 720:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 721:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterEnable
 722:lib_AT91SAM7S64.h **** //* \brief Input Filter Enable PIO
 723:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 724:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterEnable(
 725:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 726:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be enabled
 727:lib_AT91SAM7S64.h **** {
 728:lib_AT91SAM7S64.h ****         pPio->PIO_IFER = flag;
 729:lib_AT91SAM7S64.h **** }
 730:lib_AT91SAM7S64.h **** 
 731:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 732:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterDisable
 733:lib_AT91SAM7S64.h **** //* \brief Input Filter Disable PIO
 734:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 735:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterDisable(
 736:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 737:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be disabled
 738:lib_AT91SAM7S64.h **** {
 739:lib_AT91SAM7S64.h ****         pPio->PIO_IFDR = flag;
 740:lib_AT91SAM7S64.h **** }
 741:lib_AT91SAM7S64.h **** 
 742:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 743:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInputFilterStatus
 744:lib_AT91SAM7S64.h **** //* \brief Return PIO Input Filter Status
 745:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 746:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInputFilterStatus( // \return PIO Input Filter Status
 747:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 748:lib_AT91SAM7S64.h **** {
 749:lib_AT91SAM7S64.h ****         return pPio->PIO_IFSR;
 750:lib_AT91SAM7S64.h **** }
 751:lib_AT91SAM7S64.h **** 
 752:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 753:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputFilterSet
 754:lib_AT91SAM7S64.h **** //* \brief Test if PIO Input filter is Set
 755:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 756:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputFilterSet(
 757:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 758:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 759:lib_AT91SAM7S64.h **** {
 760:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInputFilterStatus(pPio) & flag);
 761:lib_AT91SAM7S64.h **** }
 762:lib_AT91SAM7S64.h **** 
 763:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 764:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputDataStatus
 765:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Data Status 
 766:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 767:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputDataStatus( // \return PIO Output Data Status 
 768:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 769:lib_AT91SAM7S64.h **** {
 770:lib_AT91SAM7S64.h ****         return pPio->PIO_ODSR;
 771:lib_AT91SAM7S64.h **** }
 772:lib_AT91SAM7S64.h **** 
 773:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 774:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptEnable
 775:lib_AT91SAM7S64.h **** //* \brief Enable PIO Interrupt
 776:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 777:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptEnable(
 778:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 779:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be enabled
 780:lib_AT91SAM7S64.h **** {
 781:lib_AT91SAM7S64.h ****         pPio->PIO_IER = flag;
 782:lib_AT91SAM7S64.h **** }
 783:lib_AT91SAM7S64.h **** 
 784:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 785:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptDisable
 786:lib_AT91SAM7S64.h **** //* \brief Disable PIO Interrupt
 787:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 788:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptDisable(
 789:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 790:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be disabled
 791:lib_AT91SAM7S64.h **** {
 792:lib_AT91SAM7S64.h ****         pPio->PIO_IDR = flag;
 793:lib_AT91SAM7S64.h **** }
 794:lib_AT91SAM7S64.h **** 
 795:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 796:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptMaskStatus
 797:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Mask Status
 798:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 799:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptMaskStatus( // \return PIO Interrupt Mask Status
 800:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 801:lib_AT91SAM7S64.h **** {
 802:lib_AT91SAM7S64.h ****         return pPio->PIO_IMR;
 803:lib_AT91SAM7S64.h **** }
 804:lib_AT91SAM7S64.h **** 
 805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 806:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptStatus
 807:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 808:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 809:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptStatus( // \return PIO Interrupt Status
 810:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 811:lib_AT91SAM7S64.h **** {
 812:lib_AT91SAM7S64.h ****         return pPio->PIO_ISR;
 813:lib_AT91SAM7S64.h **** }
 814:lib_AT91SAM7S64.h **** 
 815:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 816:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptMasked
 817:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Masked 
 818:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 819:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptMasked(
 820:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 821:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 822:lib_AT91SAM7S64.h **** {
 823:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptMaskStatus(pPio) & flag);
 824:lib_AT91SAM7S64.h **** }
 825:lib_AT91SAM7S64.h **** 
 826:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 827:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptSet
 828:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Set
 829:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 830:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptSet(
 831:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 832:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 833:lib_AT91SAM7S64.h **** {
 834:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptStatus(pPio) & flag);
 835:lib_AT91SAM7S64.h **** }
 836:lib_AT91SAM7S64.h **** 
 837:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 838:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverEnable
 839:lib_AT91SAM7S64.h **** //* \brief Multi Driver Enable PIO
 840:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 841:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverEnable(
 842:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 843:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled
 844:lib_AT91SAM7S64.h **** {
 845:lib_AT91SAM7S64.h ****         pPio->PIO_MDER = flag;
 846:lib_AT91SAM7S64.h **** }
 847:lib_AT91SAM7S64.h **** 
 848:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 849:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverDisable
 850:lib_AT91SAM7S64.h **** //* \brief Multi Driver Disable PIO
 851:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 852:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverDisable(
 853:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 854:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled
 855:lib_AT91SAM7S64.h **** {
 856:lib_AT91SAM7S64.h ****         pPio->PIO_MDDR = flag;
 857:lib_AT91SAM7S64.h **** }
 858:lib_AT91SAM7S64.h **** 
 859:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 860:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetMultiDriverStatus
 861:lib_AT91SAM7S64.h **** //* \brief Return PIO Multi Driver Status
 862:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 863:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetMultiDriverStatus( // \return PIO Multi Driver Status
 864:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 865:lib_AT91SAM7S64.h **** {
 866:lib_AT91SAM7S64.h ****         return pPio->PIO_MDSR;
 867:lib_AT91SAM7S64.h **** }
 868:lib_AT91SAM7S64.h **** 
 869:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 870:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsMultiDriverSet
 871:lib_AT91SAM7S64.h **** //* \brief Test if PIO MultiDriver is Set
 872:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 873:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsMultiDriverSet(
 874:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 875:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 876:lib_AT91SAM7S64.h **** {
 877:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetMultiDriverStatus(pPio) & flag);
 878:lib_AT91SAM7S64.h **** }
 879:lib_AT91SAM7S64.h **** 
 880:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 881:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_A_RegisterSelection
 882:lib_AT91SAM7S64.h **** //* \brief PIO A Register Selection 
 883:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 884:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_A_RegisterSelection(
 885:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 886:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio A register selection
 887:lib_AT91SAM7S64.h **** {
 888:lib_AT91SAM7S64.h ****         pPio->PIO_ASR = flag;
 889:lib_AT91SAM7S64.h **** }
 890:lib_AT91SAM7S64.h **** 
 891:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 892:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_B_RegisterSelection
 893:lib_AT91SAM7S64.h **** //* \brief PIO B Register Selection 
 894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 895:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_B_RegisterSelection(
 896:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 897:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio B register selection 
 898:lib_AT91SAM7S64.h **** {
 899:lib_AT91SAM7S64.h ****         pPio->PIO_BSR = flag;
 900:lib_AT91SAM7S64.h **** }
 901:lib_AT91SAM7S64.h **** 
 902:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 903:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Get_AB_RegisterStatus
 904:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 905:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 906:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_Get_AB_RegisterStatus( // \return PIO AB Register Status
 907:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 908:lib_AT91SAM7S64.h **** {
 909:lib_AT91SAM7S64.h ****         return pPio->PIO_ABSR;
 910:lib_AT91SAM7S64.h **** }
 911:lib_AT91SAM7S64.h **** 
 912:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 913:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsAB_RegisterSet
 914:lib_AT91SAM7S64.h **** //* \brief Test if PIO AB Register is Set
 915:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 916:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsAB_RegisterSet(
 917:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 918:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 919:lib_AT91SAM7S64.h **** {
 920:lib_AT91SAM7S64.h ****         return (AT91F_PIO_Get_AB_RegisterStatus(pPio) & flag);
 921:lib_AT91SAM7S64.h **** }
 922:lib_AT91SAM7S64.h **** 
 923:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 924:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteEnable
 925:lib_AT91SAM7S64.h **** //* \brief Output Write Enable PIO
 926:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 927:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteEnable(
 928:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 929:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be enabled
 930:lib_AT91SAM7S64.h **** {
 931:lib_AT91SAM7S64.h ****         pPio->PIO_OWER = flag;
 932:lib_AT91SAM7S64.h **** }
 933:lib_AT91SAM7S64.h **** 
 934:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 935:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteDisable
 936:lib_AT91SAM7S64.h **** //* \brief Output Write Disable PIO
 937:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 938:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteDisable(
 939:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 940:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be disabled
 941:lib_AT91SAM7S64.h **** {
 942:lib_AT91SAM7S64.h ****         pPio->PIO_OWDR = flag;
 943:lib_AT91SAM7S64.h **** }
 944:lib_AT91SAM7S64.h **** 
 945:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 946:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputWriteStatus
 947:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Write Status
 948:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 949:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputWriteStatus( // \return PIO Output Write Status
 950:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 951:lib_AT91SAM7S64.h **** {
 952:lib_AT91SAM7S64.h ****         return pPio->PIO_OWSR;
 953:lib_AT91SAM7S64.h **** }
 954:lib_AT91SAM7S64.h **** 
 955:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 956:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputWriteSet
 957:lib_AT91SAM7S64.h **** //* \brief Test if PIO OutputWrite is Set
 958:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 959:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputWriteSet(
 960:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 961:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 962:lib_AT91SAM7S64.h **** {
 963:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputWriteStatus(pPio) & flag);
 964:lib_AT91SAM7S64.h **** }
 965:lib_AT91SAM7S64.h **** 
 966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 967:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetCfgPullup
 968:lib_AT91SAM7S64.h **** //* \brief Return PIO Configuration Pullup
 969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 970:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetCfgPullup( // \return PIO Configuration Pullup 
 971:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 972:lib_AT91SAM7S64.h **** {
 973:lib_AT91SAM7S64.h ****         return pPio->PIO_PPUSR;
 974:lib_AT91SAM7S64.h **** }
 975:lib_AT91SAM7S64.h **** 
 976:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 977:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputDataStatusSet
 978:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output Data Status is Set 
 979:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 980:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputDataStatusSet(
 981:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 982:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 983:lib_AT91SAM7S64.h **** {
 984:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputDataStatus(pPio) & flag);
 985:lib_AT91SAM7S64.h **** }
 986:lib_AT91SAM7S64.h **** 
 987:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 988:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsCfgPullupStatusSet
 989:lib_AT91SAM7S64.h **** //* \brief Test if PIO Configuration Pullup Status is Set
 990:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 991:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsCfgPullupStatusSet(
 992:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 993:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 994:lib_AT91SAM7S64.h **** {
 995:lib_AT91SAM7S64.h ****         return (~AT91F_PIO_GetCfgPullup(pPio) & flag);
 996:lib_AT91SAM7S64.h **** }
 997:lib_AT91SAM7S64.h **** 
 998:lib_AT91SAM7S64.h **** /* *****************************************************************************
 999:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PMC
1000:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1001:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1002:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkEnableReg
1003:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Enable Register of the PMC controller
1004:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1005:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkEnableReg (
1006:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1007:lib_AT91SAM7S64.h **** 	unsigned int mode)
1008:lib_AT91SAM7S64.h **** {
1009:lib_AT91SAM7S64.h **** 	//* Write to the SCER register
1010:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = mode;
1011:lib_AT91SAM7S64.h **** }
1012:lib_AT91SAM7S64.h **** 
1013:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1014:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkDisableReg
1015:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Disable Register of the PMC controller
1016:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1017:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkDisableReg (
1018:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1019:lib_AT91SAM7S64.h **** 	unsigned int mode)
1020:lib_AT91SAM7S64.h **** {
1021:lib_AT91SAM7S64.h **** 	//* Write to the SCDR register
1022:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = mode;
1023:lib_AT91SAM7S64.h **** }
1024:lib_AT91SAM7S64.h **** 
1025:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1026:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetSysClkStatusReg
1027:lib_AT91SAM7S64.h **** //* \brief Return the System Clock Status Register of the PMC controller
1028:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1029:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetSysClkStatusReg (
1030:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC // pointer to a CAN controller
1031:lib_AT91SAM7S64.h **** 	)
1032:lib_AT91SAM7S64.h **** {
1033:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SCSR;
1034:lib_AT91SAM7S64.h **** }
1035:lib_AT91SAM7S64.h **** 
1036:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1037:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePeriphClock
1038:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1039:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1040:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePeriphClock (
1041:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1042:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1043:lib_AT91SAM7S64.h **** {
1044:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCER = periphIds;
1045:lib_AT91SAM7S64.h **** }
1046:lib_AT91SAM7S64.h **** 
1047:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1048:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePeriphClock
1049:lib_AT91SAM7S64.h **** //* \brief Disable peripheral clock
1050:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1051:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePeriphClock (
1052:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1053:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1054:lib_AT91SAM7S64.h **** {
1055:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCDR = periphIds;
1056:lib_AT91SAM7S64.h **** }
1057:lib_AT91SAM7S64.h **** 
1058:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1059:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetPeriphClock
1060:lib_AT91SAM7S64.h **** //* \brief Get peripheral clock status
1061:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1062:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetPeriphClock (
1063:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1064:lib_AT91SAM7S64.h **** {
1065:lib_AT91SAM7S64.h **** 	return pPMC->PMC_PCSR;
1066:lib_AT91SAM7S64.h **** }
1067:lib_AT91SAM7S64.h **** 
1068:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1069:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscillatorReg
1070:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1071:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1072:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscillatorReg (
1073:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1074:lib_AT91SAM7S64.h **** 	unsigned int mode)
1075:lib_AT91SAM7S64.h **** {
1076:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR = mode;
1077:lib_AT91SAM7S64.h **** }
1078:lib_AT91SAM7S64.h **** 
1079:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1080:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainOscillatorReg
1081:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1082:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1083:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainOscillatorReg (
1084:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1085:lib_AT91SAM7S64.h **** {
1086:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MOR;
1087:lib_AT91SAM7S64.h **** }
1088:lib_AT91SAM7S64.h **** 
1089:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1090:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_EnableMainOscillator
1091:lib_AT91SAM7S64.h **** //* \brief Enable the main oscillator
1092:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1093:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_EnableMainOscillator(
1094:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1095:lib_AT91SAM7S64.h **** {
1096:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= AT91C_CKGR_MOSCEN;
1097:lib_AT91SAM7S64.h **** }
1098:lib_AT91SAM7S64.h **** 
1099:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1100:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_DisableMainOscillator
1101:lib_AT91SAM7S64.h **** //* \brief Disable the main oscillator
1102:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1103:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_DisableMainOscillator (
1104:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1105:lib_AT91SAM7S64.h **** {
1106:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_MOSCEN;
1107:lib_AT91SAM7S64.h **** }
1108:lib_AT91SAM7S64.h **** 
1109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1110:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscStartUpTime
1111:lib_AT91SAM7S64.h **** //* \brief Cfg MOR Register according to the main osc startup time
1112:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1113:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscStartUpTime (
1114:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1115:lib_AT91SAM7S64.h **** 	unsigned int startup_time,  // \arg main osc startup time in microsecond (us)
1116:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1117:lib_AT91SAM7S64.h **** {
1118:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_OSCOUNT;
1119:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= ((slowClock * startup_time)/(8*1000000)) << 8;
1120:lib_AT91SAM7S64.h **** }
1121:lib_AT91SAM7S64.h **** 
1122:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1123:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClockFreqReg
1124:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1125:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1126:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClockFreqReg (
1127:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1128:lib_AT91SAM7S64.h **** {
1129:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MCFR;
1130:lib_AT91SAM7S64.h **** }
1131:lib_AT91SAM7S64.h **** 
1132:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1133:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClock
1134:lib_AT91SAM7S64.h **** //* \brief Return Main clock in Hz
1135:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1136:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClock (
1137:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1138:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1139:lib_AT91SAM7S64.h **** {
1140:lib_AT91SAM7S64.h **** 	return ((pCKGR->CKGR_MCFR  & AT91C_CKGR_MAINF) * slowClock) >> 4;
1141:lib_AT91SAM7S64.h **** }
1142:lib_AT91SAM7S64.h **** 
1143:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1144:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgMCKReg
1145:lib_AT91SAM7S64.h **** //* \brief Cfg Master Clock Register
1146:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1147:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgMCKReg (
1148:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1149:lib_AT91SAM7S64.h **** 	unsigned int mode)
1150:lib_AT91SAM7S64.h **** {
1151:lib_AT91SAM7S64.h **** 	pPMC->PMC_MCKR = mode;
1152:lib_AT91SAM7S64.h **** }
1153:lib_AT91SAM7S64.h **** 
1154:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1155:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMCKReg
1156:lib_AT91SAM7S64.h **** //* \brief Return Master Clock Register
1157:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1158:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMCKReg(
1159:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1160:lib_AT91SAM7S64.h **** {
1161:lib_AT91SAM7S64.h **** 	return pPMC->PMC_MCKR;
1162:lib_AT91SAM7S64.h **** }
1163:lib_AT91SAM7S64.h **** 
1164:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1165:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMasterClock
1166:lib_AT91SAM7S64.h **** //* \brief Return master clock in Hz which correponds to processor clock for ARM7
1167:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1168:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMasterClock (
1169:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1170:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1171:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1172:lib_AT91SAM7S64.h **** {
1173:lib_AT91SAM7S64.h **** 	unsigned int reg = pPMC->PMC_MCKR;
1174:lib_AT91SAM7S64.h **** 	unsigned int prescaler = (1 << ((reg & AT91C_PMC_PRES) >> 2));
1175:lib_AT91SAM7S64.h **** 	unsigned int pllDivider, pllMultiplier;
1176:lib_AT91SAM7S64.h **** 
1177:lib_AT91SAM7S64.h **** 	switch (reg & AT91C_PMC_CSS) {
1178:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_SLOW_CLK: // Slow clock selected
1179:lib_AT91SAM7S64.h **** 			return slowClock / prescaler;
1180:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_MAIN_CLK: // Main clock is selected
1181:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / prescaler;
1182:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_PLL_CLK: // PLLB clock is selected
1183:lib_AT91SAM7S64.h **** 			reg = pCKGR->CKGR_PLLR;
1184:lib_AT91SAM7S64.h **** 			pllDivider    = (reg  & AT91C_CKGR_DIV);
1185:lib_AT91SAM7S64.h **** 			pllMultiplier = ((reg  & AT91C_CKGR_MUL) >> 16) + 1;
1186:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / pllDivider * pllMultiplier / prescaler;
1187:lib_AT91SAM7S64.h **** 	}
1188:lib_AT91SAM7S64.h **** 	return 0;
1189:lib_AT91SAM7S64.h **** }
1190:lib_AT91SAM7S64.h **** 
1191:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1192:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePCK
1193:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1194:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1195:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePCK (
1196:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1197:lib_AT91SAM7S64.h **** 	unsigned int pck,  // \arg Peripheral clock identifier 0 .. 7
1198:lib_AT91SAM7S64.h **** 	unsigned int mode)
1199:lib_AT91SAM7S64.h **** {
1200:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCKR[pck] = mode;
1201:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = (1 << pck) << 8;
1202:lib_AT91SAM7S64.h **** }
1203:lib_AT91SAM7S64.h **** 
1204:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1205:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePCK
1206:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1207:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1208:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePCK (
1209:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1210:lib_AT91SAM7S64.h **** 	unsigned int pck)  // \arg Peripheral clock identifier 0 .. 7
1211:lib_AT91SAM7S64.h **** {
1212:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = (1 << pck) << 8;
1213:lib_AT91SAM7S64.h **** }
1214:lib_AT91SAM7S64.h **** 
1215:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1216:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnableIt
1217:lib_AT91SAM7S64.h **** //* \brief Enable PMC interrupt
1218:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1219:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnableIt (
1220:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC,     // pointer to a PMC controller
1221:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1222:lib_AT91SAM7S64.h **** {
1223:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1224:lib_AT91SAM7S64.h **** 	pPMC->PMC_IER = flag;
1225:lib_AT91SAM7S64.h **** }
1226:lib_AT91SAM7S64.h **** 
1227:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1228:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisableIt
1229:lib_AT91SAM7S64.h **** //* \brief Disable PMC interrupt
1230:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1231:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisableIt (
1232:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // pointer to a PMC controller
1233:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1234:lib_AT91SAM7S64.h **** {
1235:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1236:lib_AT91SAM7S64.h **** 	pPMC->PMC_IDR = flag;
1237:lib_AT91SAM7S64.h **** }
1238:lib_AT91SAM7S64.h **** 
1239:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1240:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetStatus
1241:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Status
1242:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1243:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetStatus( // \return PMC Interrupt Status
1244:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1245:lib_AT91SAM7S64.h **** {
1246:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SR;
1247:lib_AT91SAM7S64.h **** }
1248:lib_AT91SAM7S64.h **** 
1249:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1250:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetInterruptMaskStatus
1251:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Mask Status
1252:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1253:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetInterruptMaskStatus( // \return PMC Interrupt Mask Status
1254:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1255:lib_AT91SAM7S64.h **** {
1256:lib_AT91SAM7S64.h **** 	return pPMC->PMC_IMR;
1257:lib_AT91SAM7S64.h **** }
1258:lib_AT91SAM7S64.h **** 
1259:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1260:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsInterruptMasked
1261:lib_AT91SAM7S64.h **** //* \brief Test if PMC Interrupt is Masked
1262:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1263:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsInterruptMasked(
1264:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1265:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1266:lib_AT91SAM7S64.h **** {
1267:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetInterruptMaskStatus(pPMC) & flag);
1268:lib_AT91SAM7S64.h **** }
1269:lib_AT91SAM7S64.h **** 
1270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsStatusSet
1272:lib_AT91SAM7S64.h **** //* \brief Test if PMC Status is Set
1273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1274:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsStatusSet(
1275:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1276:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1277:lib_AT91SAM7S64.h **** {
1278:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetStatus(pPMC) & flag);
1279:lib_AT91SAM7S64.h **** }
1280:lib_AT91SAM7S64.h **** 
1281:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1282:lib_AT91SAM7S64.h **** //  \fn    AT91F_CKGR_CfgPLLReg
1283:lib_AT91SAM7S64.h **** //  \brief Cfg the PLL Register
1284:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1285:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgPLLReg (
1286:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1287:lib_AT91SAM7S64.h **** 	unsigned int mode)
1288:lib_AT91SAM7S64.h **** {
1289:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_PLLR = mode;
1290:lib_AT91SAM7S64.h **** }
1291:lib_AT91SAM7S64.h **** 
1292:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1293:lib_AT91SAM7S64.h **** //  \fn    AT91F_CKGR_GetPLLReg
1294:lib_AT91SAM7S64.h **** //  \brief Get the PLL Register
1295:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1296:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetPLLReg (
1297:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1298:lib_AT91SAM7S64.h **** {
1299:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_PLLR;
1300:lib_AT91SAM7S64.h **** }
1301:lib_AT91SAM7S64.h **** 
1302:lib_AT91SAM7S64.h **** 
1303:lib_AT91SAM7S64.h **** 
1304:lib_AT91SAM7S64.h **** /* *****************************************************************************
1305:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RSTC
1306:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1307:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1308:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSoftReset
1309:lib_AT91SAM7S64.h **** //* \brief Start Software Reset
1310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1311:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSoftReset(
1312:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1313:lib_AT91SAM7S64.h ****         unsigned int reset)
1314:lib_AT91SAM7S64.h **** {
1315:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RCR = (0xA5000000 | reset);
1316:lib_AT91SAM7S64.h **** }
1317:lib_AT91SAM7S64.h **** 
1318:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1319:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSetMode
1320:lib_AT91SAM7S64.h **** //* \brief Set Reset Mode
1321:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1322:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSetMode(
1323:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1324:lib_AT91SAM7S64.h ****         unsigned int mode)
1325:lib_AT91SAM7S64.h **** {
1326:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RMR = (0xA5000000 | mode);
1327:lib_AT91SAM7S64.h **** }
1328:lib_AT91SAM7S64.h **** 
1329:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1330:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetMode
1331:lib_AT91SAM7S64.h **** //* \brief Get Reset Mode
1332:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1333:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetMode(
1334:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1335:lib_AT91SAM7S64.h **** {
1336:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RMR);
1337:lib_AT91SAM7S64.h **** }
1338:lib_AT91SAM7S64.h **** 
1339:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1340:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetStatus
1341:lib_AT91SAM7S64.h **** //* \brief Get Reset Status
1342:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1343:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetStatus(
1344:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1345:lib_AT91SAM7S64.h **** {
1346:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RSR);
1347:lib_AT91SAM7S64.h **** }
1348:lib_AT91SAM7S64.h **** 
1349:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1350:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTIsSoftRstActive
1351:lib_AT91SAM7S64.h **** //* \brief Return !=0 if software reset is still not completed
1352:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1353:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTIsSoftRstActive(
1354:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1355:lib_AT91SAM7S64.h **** {
1356:lib_AT91SAM7S64.h **** 	return ((pRSTC->RSTC_RSR) & AT91C_RSTC_SRCMP);
1357:lib_AT91SAM7S64.h **** }
1358:lib_AT91SAM7S64.h **** /* *****************************************************************************
1359:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RTTC
1360:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1361:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1362:lib_AT91SAM7S64.h **** //* \fn     AT91F_SetRTT_TimeBase()
1363:lib_AT91SAM7S64.h **** //* \brief  Set the RTT prescaler according to the TimeBase in ms
1364:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1365:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetTimeBase(
1366:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1367:lib_AT91SAM7S64.h ****         unsigned int ms)
1368:lib_AT91SAM7S64.h **** {
1369:lib_AT91SAM7S64.h **** 	if (ms > 2000)
1370:lib_AT91SAM7S64.h **** 		return 1;   // AT91C_TIME_OUT_OF_RANGE
1371:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1372:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (((ms << 15) /1000) & 0xFFFF);	
1373:lib_AT91SAM7S64.h **** 	return 0;
1374:lib_AT91SAM7S64.h **** }
1375:lib_AT91SAM7S64.h **** 
1376:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1377:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTSetPrescaler()
1378:lib_AT91SAM7S64.h **** //* \brief  Set the new prescaler value
1379:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1380:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetPrescaler(
1381:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1382:lib_AT91SAM7S64.h ****         unsigned int rtpres)
1383:lib_AT91SAM7S64.h **** {
1384:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1385:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (rtpres & 0xFFFF);	
1386:lib_AT91SAM7S64.h **** 	return (pRTTC->RTTC_RTMR);
1387:lib_AT91SAM7S64.h **** }
1388:lib_AT91SAM7S64.h **** 
1389:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1390:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTRestart()
1391:lib_AT91SAM7S64.h **** //* \brief  Restart the RTT prescaler
1392:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1393:lib_AT91SAM7S64.h **** __inline void AT91F_RTTRestart(
1394:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1395:lib_AT91SAM7S64.h **** {
1396:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTRST;	
1397:lib_AT91SAM7S64.h **** }
1398:lib_AT91SAM7S64.h **** 
1399:lib_AT91SAM7S64.h **** 
1400:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1401:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmINT()
1402:lib_AT91SAM7S64.h **** //* \brief  Enable RTT Alarm Interrupt
1403:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1404:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmINT(
1405:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1406:lib_AT91SAM7S64.h **** {
1407:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_ALMIEN;
1408:lib_AT91SAM7S64.h **** }
1409:lib_AT91SAM7S64.h **** 
1410:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1411:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearAlarmINT()
1412:lib_AT91SAM7S64.h **** //* \brief  Disable RTT Alarm Interrupt
1413:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1414:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearAlarmINT(
1415:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1416:lib_AT91SAM7S64.h **** {
1417:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_ALMIEN;
1418:lib_AT91SAM7S64.h **** }
1419:lib_AT91SAM7S64.h **** 
1420:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1421:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetRttIncINT()
1422:lib_AT91SAM7S64.h **** //* \brief  Enable RTT INC Interrupt
1423:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1424:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetRttIncINT(
1425:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1426:lib_AT91SAM7S64.h **** {
1427:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTINCIEN;
1428:lib_AT91SAM7S64.h **** }
1429:lib_AT91SAM7S64.h **** 
1430:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1431:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearRttIncINT()
1432:lib_AT91SAM7S64.h **** //* \brief  Disable RTT INC Interrupt
1433:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1434:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearRttIncINT(
1435:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1436:lib_AT91SAM7S64.h **** {
1437:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_RTTINCIEN;
1438:lib_AT91SAM7S64.h **** }
1439:lib_AT91SAM7S64.h **** 
1440:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1441:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmValue()
1442:lib_AT91SAM7S64.h **** //* \brief  Set RTT Alarm Value
1443:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1444:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmValue(
1445:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, unsigned int alarm)
1446:lib_AT91SAM7S64.h **** {
1447:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTAR = alarm;
1448:lib_AT91SAM7S64.h **** }
1449:lib_AT91SAM7S64.h **** 
1450:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1451:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_GetAlarmValue()
1452:lib_AT91SAM7S64.h **** //* \brief  Get RTT Alarm Value
1453:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1454:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetAlarmValue(
1455:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1456:lib_AT91SAM7S64.h **** {
1457:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTAR);
1458:lib_AT91SAM7S64.h **** }
1459:lib_AT91SAM7S64.h **** 
1460:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1461:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTGetStatus()
1462:lib_AT91SAM7S64.h **** //* \brief  Read the RTT status
1463:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1464:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetStatus(
1465:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1466:lib_AT91SAM7S64.h **** {
1467:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTSR);
1468:lib_AT91SAM7S64.h **** }
1469:lib_AT91SAM7S64.h **** 
1470:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1471:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ReadValue()
1472:lib_AT91SAM7S64.h **** //* \brief  Read the RTT value
1473:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1474:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTReadValue(
1475:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1476:lib_AT91SAM7S64.h **** {
1477:lib_AT91SAM7S64.h ****         register volatile unsigned int val1,val2;
1478:lib_AT91SAM7S64.h **** 	do
1479:lib_AT91SAM7S64.h **** 	{
1480:lib_AT91SAM7S64.h **** 		val1 = pRTTC->RTTC_RTVR;
1481:lib_AT91SAM7S64.h **** 		val2 = pRTTC->RTTC_RTVR;
1482:lib_AT91SAM7S64.h **** 	}	
1483:lib_AT91SAM7S64.h **** 	while(val1 != val2);
1484:lib_AT91SAM7S64.h **** 	return(val1);
1485:lib_AT91SAM7S64.h **** }
1486:lib_AT91SAM7S64.h **** /* *****************************************************************************
1487:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PITC
1488:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1489:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1490:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITInit
1491:lib_AT91SAM7S64.h **** //* \brief System timer init : period in second, system clock freq in MHz
1492:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1493:lib_AT91SAM7S64.h **** __inline void AT91F_PITInit(
1494:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1495:lib_AT91SAM7S64.h ****         unsigned int period,
1496:lib_AT91SAM7S64.h ****         unsigned int pit_frequency)
1497:lib_AT91SAM7S64.h **** {
1498:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = period? (period * pit_frequency + 8) >> 4 : 0; // +8 to avoid %10 and /10
1499:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITEN;	 
1500:lib_AT91SAM7S64.h **** }
1501:lib_AT91SAM7S64.h **** 
1502:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1503:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITSetPIV
1504:lib_AT91SAM7S64.h **** //* \brief Set the PIT Periodic Interval Value 
1505:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1506:lib_AT91SAM7S64.h **** __inline void AT91F_PITSetPIV(
1507:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1508:lib_AT91SAM7S64.h ****         unsigned int piv)
1509:lib_AT91SAM7S64.h **** {
1510:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = piv | (pPITC->PITC_PIMR & (AT91C_PITC_PITEN | AT91C_PITC_PITIEN));
1511:lib_AT91SAM7S64.h **** }
1512:lib_AT91SAM7S64.h **** 
1513:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1514:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITEnableInt
1515:lib_AT91SAM7S64.h **** //* \brief Enable PIT periodic interrupt
1516:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1517:lib_AT91SAM7S64.h **** __inline void AT91F_PITEnableInt(
1518:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1519:lib_AT91SAM7S64.h **** {
1520:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITIEN;	 
1521:lib_AT91SAM7S64.h **** }
1522:lib_AT91SAM7S64.h **** 
1523:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1524:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITDisableInt
1525:lib_AT91SAM7S64.h **** //* \brief Disable PIT periodic interrupt
1526:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1527:lib_AT91SAM7S64.h **** __inline void AT91F_PITDisableInt(
1528:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1529:lib_AT91SAM7S64.h **** {
1530:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR &= ~AT91C_PITC_PITIEN;	 
1531:lib_AT91SAM7S64.h **** }
1532:lib_AT91SAM7S64.h **** 
1533:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1534:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetMode
1535:lib_AT91SAM7S64.h **** //* \brief Read PIT mode register
1536:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1537:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetMode(
1538:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1539:lib_AT91SAM7S64.h **** {
1540:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIMR);
1541:lib_AT91SAM7S64.h **** }
1542:lib_AT91SAM7S64.h **** 
1543:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1544:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetStatus
1545:lib_AT91SAM7S64.h **** //* \brief Read PIT status register
1546:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1547:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetStatus(
1548:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1549:lib_AT91SAM7S64.h **** {
1550:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PISR);
1551:lib_AT91SAM7S64.h **** }
1552:lib_AT91SAM7S64.h **** 
1553:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1554:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIIR
1555:lib_AT91SAM7S64.h **** //* \brief Read PIT CPIV and PICNT without ressetting the counters
1556:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1557:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIIR(
1558:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1559:lib_AT91SAM7S64.h **** {
1560:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIIR);
1561:lib_AT91SAM7S64.h **** }
1562:lib_AT91SAM7S64.h **** 
1563:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1564:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIVR
1565:lib_AT91SAM7S64.h **** //* \brief Read System timer CPIV and PICNT without ressetting the counters
1566:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1567:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIVR(
1568:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1569:lib_AT91SAM7S64.h **** {
1570:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIVR);
1571:lib_AT91SAM7S64.h **** }
1572:lib_AT91SAM7S64.h **** /* *****************************************************************************
1573:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR WDTC
1574:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1575:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1576:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSetMode
1577:lib_AT91SAM7S64.h **** //* \brief Set Watchdog Mode Register
1578:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1579:lib_AT91SAM7S64.h **** __inline void AT91F_WDTSetMode(
1580:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC,
1581:lib_AT91SAM7S64.h ****         unsigned int Mode)
1582:lib_AT91SAM7S64.h **** {
1583:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDMR = Mode;
1584:lib_AT91SAM7S64.h **** }
1585:lib_AT91SAM7S64.h **** 
1586:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1587:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTRestart
1588:lib_AT91SAM7S64.h **** //* \brief Restart Watchdog
1589:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1590:lib_AT91SAM7S64.h **** __inline void AT91F_WDTRestart(
1591:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1592:lib_AT91SAM7S64.h **** {
1593:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDCR = 0xA5000001;
1594:lib_AT91SAM7S64.h **** }
1595:lib_AT91SAM7S64.h **** 
1596:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1597:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSGettatus
1598:lib_AT91SAM7S64.h **** //* \brief Get Watchdog Status
1599:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1600:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTSGettatus(
1601:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1602:lib_AT91SAM7S64.h **** {
1603:lib_AT91SAM7S64.h **** 	return(pWDTC->WDTC_WDSR & 0x3);
1604:lib_AT91SAM7S64.h **** }
1605:lib_AT91SAM7S64.h **** 
1606:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1607:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTGetPeriod
1608:lib_AT91SAM7S64.h **** //* \brief Translate ms into Watchdog Compatible value
1609:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1610:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTGetPeriod(unsigned int ms)
1611:lib_AT91SAM7S64.h **** {
1612:lib_AT91SAM7S64.h **** 	if ((ms < 4) || (ms > 16000))
1613:lib_AT91SAM7S64.h **** 		return 0;
1614:lib_AT91SAM7S64.h **** 	return((ms << 8) / 1000);
1615:lib_AT91SAM7S64.h **** }
1616:lib_AT91SAM7S64.h **** /* *****************************************************************************
1617:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR VREG
1618:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1619:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1620:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Enable_LowPowerMode
1621:lib_AT91SAM7S64.h **** //* \brief Enable VREG Low Power Mode
1622:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1623:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Enable_LowPowerMode(
1624:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1625:lib_AT91SAM7S64.h **** {
1626:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR |= AT91C_VREG_PSTDBY;	 
1627:lib_AT91SAM7S64.h **** }
1628:lib_AT91SAM7S64.h **** 
1629:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1630:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Disable_LowPowerMode
1631:lib_AT91SAM7S64.h **** //* \brief Disable VREG Low Power Mode
1632:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1633:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Disable_LowPowerMode(
1634:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1635:lib_AT91SAM7S64.h **** {
1636:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR &= ~AT91C_VREG_PSTDBY;	 
1637:lib_AT91SAM7S64.h **** }/* *****************************************************************************
1638:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR MC
1639:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1640:lib_AT91SAM7S64.h **** 
1641:lib_AT91SAM7S64.h **** #define AT91C_MC_CORRECT_KEY  ((unsigned int) 0x5A << 24) // (MC) Correct Protect Key
1642:lib_AT91SAM7S64.h **** 
1643:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1644:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_Remap
1645:lib_AT91SAM7S64.h **** //* \brief Make Remap
1646:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1647:lib_AT91SAM7S64.h **** __inline void AT91F_MC_Remap (void)     //  
1648:lib_AT91SAM7S64.h **** {
1649:lib_AT91SAM7S64.h ****     AT91PS_MC pMC = (AT91PS_MC) AT91C_BASE_MC;
1650:lib_AT91SAM7S64.h ****     
1651:lib_AT91SAM7S64.h ****     pMC->MC_RCR = AT91C_MC_RCB;
1652:lib_AT91SAM7S64.h **** }
1653:lib_AT91SAM7S64.h **** 
1654:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1655:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_CfgModeReg
1656:lib_AT91SAM7S64.h **** //* \brief Configure the EFC Mode Register of the MC controller
1657:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1658:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_CfgModeReg (
1659:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1660:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
1661:lib_AT91SAM7S64.h **** {
1662:lib_AT91SAM7S64.h **** 	// Write to the FMR register
1663:lib_AT91SAM7S64.h **** 	pMC->MC_FMR = mode;
1664:lib_AT91SAM7S64.h **** }
1665:lib_AT91SAM7S64.h **** 
1666:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1667:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetModeReg
1668:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1669:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1670:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetModeReg(
1671:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1672:lib_AT91SAM7S64.h **** {
1673:lib_AT91SAM7S64.h **** 	return pMC->MC_FMR;
1674:lib_AT91SAM7S64.h **** }
1675:lib_AT91SAM7S64.h **** 
1676:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1677:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_ComputeFMCN
1678:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1679:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1680:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_ComputeFMCN(
1681:lib_AT91SAM7S64.h **** 	int master_clock) // master clock in Hz
1682:lib_AT91SAM7S64.h **** {
1683:lib_AT91SAM7S64.h **** 	return (master_clock/1000000 +2);
1684:lib_AT91SAM7S64.h **** }
1685:lib_AT91SAM7S64.h **** 
1686:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1687:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_PerformCmd
1688:lib_AT91SAM7S64.h **** //* \brief Perform EFC Command
1689:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1690:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_PerformCmd (
1691:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1692:lib_AT91SAM7S64.h ****     unsigned int transfer_cmd)
1693:lib_AT91SAM7S64.h **** {
1694:lib_AT91SAM7S64.h **** 	pMC->MC_FCR = transfer_cmd;	
1695:lib_AT91SAM7S64.h **** }
1696:lib_AT91SAM7S64.h **** 
1697:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1698:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetStatus
1699:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Status
1700:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1701:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetStatus(
1702:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1703:lib_AT91SAM7S64.h **** {
1704:lib_AT91SAM7S64.h **** 	return pMC->MC_FSR;
1705:lib_AT91SAM7S64.h **** }
1706:lib_AT91SAM7S64.h **** 
1707:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1708:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptMasked
1709:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Masked 
1710:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1711:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptMasked(
1712:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1713:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1714:lib_AT91SAM7S64.h **** {
1715:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetModeReg(pMC) & flag);
1716:lib_AT91SAM7S64.h **** }
1717:lib_AT91SAM7S64.h **** 
1718:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1719:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptSet
1720:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Set
1721:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1722:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptSet(
1723:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1724:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1725:lib_AT91SAM7S64.h **** {
1726:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetStatus(pMC) & flag);
1727:lib_AT91SAM7S64.h **** }
1728:lib_AT91SAM7S64.h **** 
1729:lib_AT91SAM7S64.h **** /* *****************************************************************************
1730:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SPI
1731:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1732:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1733:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgCs
1734:lib_AT91SAM7S64.h **** //* \brief Configure SPI chip select register
1735:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1736:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgCs (
1737:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1738:lib_AT91SAM7S64.h **** 	int cs,     // SPI cs number (0 to 3)
1739:lib_AT91SAM7S64.h ****  	int val)   //  chip select register
1740:lib_AT91SAM7S64.h **** {
1741:lib_AT91SAM7S64.h **** 	//* Write to the CSR register
1742:lib_AT91SAM7S64.h **** 	*(pSPI->SPI_CSR + cs) = val;
1743:lib_AT91SAM7S64.h **** }
1744:lib_AT91SAM7S64.h **** 
1745:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1746:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_EnableIt
1747:lib_AT91SAM7S64.h **** //* \brief Enable SPI interrupt
1748:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1749:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_EnableIt (
1750:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1751:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1752:lib_AT91SAM7S64.h **** {
1753:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1754:lib_AT91SAM7S64.h **** 	pSPI->SPI_IER = flag;
1755:lib_AT91SAM7S64.h **** }
1756:lib_AT91SAM7S64.h **** 
1757:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1758:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_DisableIt
1759:lib_AT91SAM7S64.h **** //* \brief Disable SPI interrupt
1760:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1761:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_DisableIt (
1762:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1763:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1764:lib_AT91SAM7S64.h **** {
1765:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1766:lib_AT91SAM7S64.h **** 	pSPI->SPI_IDR = flag;
1767:lib_AT91SAM7S64.h **** }
1768:lib_AT91SAM7S64.h **** 
1769:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1770:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Reset
1771:lib_AT91SAM7S64.h **** //* \brief Reset the SPI controller
1772:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1773:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Reset (
1774:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1775:lib_AT91SAM7S64.h **** 	)
1776:lib_AT91SAM7S64.h **** {
1777:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1778:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SWRST;
1779:lib_AT91SAM7S64.h **** }
1780:lib_AT91SAM7S64.h **** 
1781:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1782:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Enable
1783:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1784:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1785:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Enable (
1786:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1787:lib_AT91SAM7S64.h **** 	)
1788:lib_AT91SAM7S64.h **** {
1789:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1790:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIEN;
1791:lib_AT91SAM7S64.h **** }
1792:lib_AT91SAM7S64.h **** 
1793:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1794:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Disable
1795:lib_AT91SAM7S64.h **** //* \brief Disable the SPI controller
1796:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1797:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Disable (
1798:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1799:lib_AT91SAM7S64.h **** 	)
1800:lib_AT91SAM7S64.h **** {
1801:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1802:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1803:lib_AT91SAM7S64.h **** }
1804:lib_AT91SAM7S64.h **** 
1805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1806:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgMode
1807:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1808:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1809:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgMode (
1810:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1811:lib_AT91SAM7S64.h **** 	int mode)        // mode register 
1812:lib_AT91SAM7S64.h **** {
1813:lib_AT91SAM7S64.h **** 	//* Write to the MR register
1814:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR = mode;
1815:lib_AT91SAM7S64.h **** }
1816:lib_AT91SAM7S64.h **** 
1817:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1818:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgPCS
1819:lib_AT91SAM7S64.h **** //* \brief Switch to the correct PCS of SPI Mode Register : Fixed Peripheral Selected
1820:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1821:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgPCS (
1822:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1823:lib_AT91SAM7S64.h **** 	char PCS_Device) // PCS of the Device
1824:lib_AT91SAM7S64.h **** {	
1825:lib_AT91SAM7S64.h ****  	//* Write to the MR register
1826:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR &= 0xFFF0FFFF;
1827:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR |= ( (PCS_Device<<16) & AT91C_SPI_PCS );
1828:lib_AT91SAM7S64.h **** }
1829:lib_AT91SAM7S64.h **** 
1830:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1831:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_ReceiveFrame
1832:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1833:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1834:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_ReceiveFrame (
1835:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1836:lib_AT91SAM7S64.h **** 	char *pBuffer,
1837:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1838:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1839:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1840:lib_AT91SAM7S64.h **** {
1841:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
1842:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1843:lib_AT91SAM7S64.h **** 		pBuffer,
1844:lib_AT91SAM7S64.h **** 		szBuffer,
1845:lib_AT91SAM7S64.h **** 		pNextBuffer,
1846:lib_AT91SAM7S64.h **** 		szNextBuffer);
1847:lib_AT91SAM7S64.h **** }
1848:lib_AT91SAM7S64.h **** 
1849:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1850:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_SendFrame
1851:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1852:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1853:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_SendFrame(
1854:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1855:lib_AT91SAM7S64.h **** 	char *pBuffer,
1856:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1857:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1858:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1859:lib_AT91SAM7S64.h **** {
1860:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
1861:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1862:lib_AT91SAM7S64.h **** 		pBuffer,
1863:lib_AT91SAM7S64.h **** 		szBuffer,
1864:lib_AT91SAM7S64.h **** 		pNextBuffer,
1865:lib_AT91SAM7S64.h **** 		szNextBuffer);
1866:lib_AT91SAM7S64.h **** }
1867:lib_AT91SAM7S64.h **** 
1868:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1869:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Close
1870:lib_AT91SAM7S64.h **** //* \brief Close SPI: disable IT disable transfert, close PDC
1871:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1872:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Close (
1873:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI)     // \arg pointer to a SPI controller
1874:lib_AT91SAM7S64.h **** {
1875:lib_AT91SAM7S64.h ****     //* Reset all the Chip Select register
1876:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[0] = 0 ;
1877:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[1] = 0 ;
1878:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[2] = 0 ;
1879:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[3] = 0 ;
1880:lib_AT91SAM7S64.h **** 
1881:lib_AT91SAM7S64.h ****     //* Reset the SPI mode
1882:lib_AT91SAM7S64.h ****     pSPI->SPI_MR = 0  ;
1883:lib_AT91SAM7S64.h **** 
1884:lib_AT91SAM7S64.h ****     //* Disable all interrupts
1885:lib_AT91SAM7S64.h ****     pSPI->SPI_IDR = 0xFFFFFFFF ;
1886:lib_AT91SAM7S64.h **** 
1887:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
1888:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pSPI->SPI_RPR));
1889:lib_AT91SAM7S64.h **** 
1890:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
1891:lib_AT91SAM7S64.h ****     pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1892:lib_AT91SAM7S64.h **** }
1893:lib_AT91SAM7S64.h **** 
1894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1895:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_PutChar
1896:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
1897:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1898:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_PutChar (
1899:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1900:lib_AT91SAM7S64.h **** 	unsigned int character,
1901:lib_AT91SAM7S64.h ****              unsigned int cs_number )
1902:lib_AT91SAM7S64.h **** {
1903:lib_AT91SAM7S64.h ****     unsigned int value_for_cs;
1904:lib_AT91SAM7S64.h ****     value_for_cs = (~(1 << cs_number)) & 0xF;  //Place a zero among a 4 ONEs number
1905:lib_AT91SAM7S64.h ****     pSPI->SPI_TDR = (character & 0xFFFF) | (value_for_cs << 16);
1906:lib_AT91SAM7S64.h **** }
1907:lib_AT91SAM7S64.h **** 
1908:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1909:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetChar
1910:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
1911:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1912:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_GetChar (
1913:lib_AT91SAM7S64.h **** 	const AT91PS_SPI pSPI)
1914:lib_AT91SAM7S64.h **** {
1915:lib_AT91SAM7S64.h ****     return((pSPI->SPI_RDR) & 0xFFFF);
1916:lib_AT91SAM7S64.h **** }
1917:lib_AT91SAM7S64.h **** 
1918:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1919:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetInterruptMaskStatus
1920:lib_AT91SAM7S64.h **** //* \brief Return SPI Interrupt Mask Status
1921:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1922:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_GetInterruptMaskStatus( // \return SPI Interrupt Mask Status
1923:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi) // \arg  pointer to a SPI controller
1924:lib_AT91SAM7S64.h **** {
1925:lib_AT91SAM7S64.h ****         return pSpi->SPI_IMR;
1926:lib_AT91SAM7S64.h **** }
1927:lib_AT91SAM7S64.h **** 
1928:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1929:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_IsInterruptMasked
1930:lib_AT91SAM7S64.h **** //* \brief Test if SPI Interrupt is Masked 
1931:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1932:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_IsInterruptMasked(
1933:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi,   // \arg  pointer to a SPI controller
1934:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1935:lib_AT91SAM7S64.h **** {
1936:lib_AT91SAM7S64.h ****         return (AT91F_SPI_GetInterruptMaskStatus(pSpi) & flag);
1937:lib_AT91SAM7S64.h **** }
1938:lib_AT91SAM7S64.h **** 
1939:lib_AT91SAM7S64.h **** /* *****************************************************************************
1940:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR ADC
1941:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1942:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1943:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableIt
1944:lib_AT91SAM7S64.h **** //* \brief Enable ADC interrupt
1945:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1946:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableIt (
1947:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC,     // pointer to a ADC controller
1948:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1949:lib_AT91SAM7S64.h **** {
1950:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1951:lib_AT91SAM7S64.h **** 	pADC->ADC_IER = flag;
1952:lib_AT91SAM7S64.h **** }
1953:lib_AT91SAM7S64.h **** 
1954:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1955:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableIt
1956:lib_AT91SAM7S64.h **** //* \brief Disable ADC interrupt
1957:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1958:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableIt (
1959:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
1960:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1961:lib_AT91SAM7S64.h **** {
1962:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1963:lib_AT91SAM7S64.h **** 	pADC->ADC_IDR = flag;
1964:lib_AT91SAM7S64.h **** }
1965:lib_AT91SAM7S64.h **** 
1966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1967:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetStatus
1968:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Status
1969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1970:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetStatus( // \return ADC Interrupt Status
1971:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1972:lib_AT91SAM7S64.h **** {
1973:lib_AT91SAM7S64.h **** 	return pADC->ADC_SR;
1974:lib_AT91SAM7S64.h **** }
1975:lib_AT91SAM7S64.h **** 
1976:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1977:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetInterruptMaskStatus
1978:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Mask Status
1979:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1980:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetInterruptMaskStatus( // \return ADC Interrupt Mask Status
1981:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1982:lib_AT91SAM7S64.h **** {
1983:lib_AT91SAM7S64.h **** 	return pADC->ADC_IMR;
1984:lib_AT91SAM7S64.h **** }
1985:lib_AT91SAM7S64.h **** 
1986:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1987:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsInterruptMasked
1988:lib_AT91SAM7S64.h **** //* \brief Test if ADC Interrupt is Masked 
1989:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1990:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsInterruptMasked(
1991:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
1992:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1993:lib_AT91SAM7S64.h **** {
1994:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetInterruptMaskStatus(pADC) & flag);
1995:lib_AT91SAM7S64.h **** }
1996:lib_AT91SAM7S64.h **** 
1997:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1998:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsStatusSet
1999:lib_AT91SAM7S64.h **** //* \brief Test if ADC Status is Set
2000:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2001:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsStatusSet(
2002:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
2003:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2004:lib_AT91SAM7S64.h **** {
2005:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetStatus(pADC) & flag);
2006:lib_AT91SAM7S64.h **** }
2007:lib_AT91SAM7S64.h **** 
2008:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2009:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgModeReg
2010:lib_AT91SAM7S64.h **** //* \brief Configure the Mode Register of the ADC controller
2011:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2012:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgModeReg (
2013:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2014:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
2015:lib_AT91SAM7S64.h **** {
2016:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2017:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = mode;
2018:lib_AT91SAM7S64.h **** }
2019:lib_AT91SAM7S64.h **** 
2020:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2021:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetModeReg
2022:lib_AT91SAM7S64.h **** //* \brief Return the Mode Register of the ADC controller value
2023:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2024:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetModeReg (
2025:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2026:lib_AT91SAM7S64.h **** 	)
2027:lib_AT91SAM7S64.h **** {
2028:lib_AT91SAM7S64.h **** 	return pADC->ADC_MR;	
2029:lib_AT91SAM7S64.h **** }
2030:lib_AT91SAM7S64.h **** 
2031:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2032:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgTimings
2033:lib_AT91SAM7S64.h **** //* \brief Configure the different necessary timings of the ADC controller
2034:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2035:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgTimings (
2036:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2037:lib_AT91SAM7S64.h **** 	unsigned int mck_clock, // in MHz 
2038:lib_AT91SAM7S64.h **** 	unsigned int adc_clock, // in MHz 
2039:lib_AT91SAM7S64.h **** 	unsigned int startup_time, // in us 
2040:lib_AT91SAM7S64.h **** 	unsigned int sample_and_hold_time)	// in ns  
2041:lib_AT91SAM7S64.h **** {
2042:lib_AT91SAM7S64.h **** 	unsigned int prescal,startup,shtim;
2043:lib_AT91SAM7S64.h **** 	
2044:lib_AT91SAM7S64.h **** 	prescal = mck_clock/(2*adc_clock) - 1;
2045:lib_AT91SAM7S64.h **** 	startup = adc_clock*startup_time/8 - 1;
2046:lib_AT91SAM7S64.h **** 	shtim = adc_clock*sample_and_hold_time/1000 - 1;
2047:lib_AT91SAM7S64.h **** 	
2048:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2049:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = ( (prescal<<8) & AT91C_ADC_PRESCAL) | ( (startup<<16) & AT91C_ADC_STARTUP) | ( (sht
2050:lib_AT91SAM7S64.h **** }
2051:lib_AT91SAM7S64.h **** 
2052:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2053:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableChannel
2054:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2055:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2056:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableChannel (
2057:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2058:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2059:lib_AT91SAM7S64.h **** {
2060:lib_AT91SAM7S64.h **** 	//* Write to the CHER register
2061:lib_AT91SAM7S64.h **** 	pADC->ADC_CHER = channel;
2062:lib_AT91SAM7S64.h **** }
2063:lib_AT91SAM7S64.h **** 
2064:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2065:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableChannel
2066:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2067:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2068:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableChannel (
2069:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2070:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2071:lib_AT91SAM7S64.h **** {
2072:lib_AT91SAM7S64.h **** 	//* Write to the CHDR register
2073:lib_AT91SAM7S64.h **** 	pADC->ADC_CHDR = channel;
2074:lib_AT91SAM7S64.h **** }
2075:lib_AT91SAM7S64.h **** 
2076:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2077:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetChannelStatus
2078:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2079:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2080:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetChannelStatus (
2081:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2082:lib_AT91SAM7S64.h **** 	)
2083:lib_AT91SAM7S64.h **** {
2084:lib_AT91SAM7S64.h **** 	return pADC->ADC_CHSR;	
2085:lib_AT91SAM7S64.h **** }
2086:lib_AT91SAM7S64.h **** 
2087:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2088:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_StartConversion
2089:lib_AT91SAM7S64.h **** //* \brief Software request for a analog to digital conversion 
2090:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2091:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_StartConversion (
2092:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2093:lib_AT91SAM7S64.h **** 	)
2094:lib_AT91SAM7S64.h **** {
2095:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_START;	
2096:lib_AT91SAM7S64.h **** }
2097:lib_AT91SAM7S64.h **** 
2098:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2099:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_SoftReset
2100:lib_AT91SAM7S64.h **** //* \brief Software reset
2101:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2102:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_SoftReset (
2103:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2104:lib_AT91SAM7S64.h **** 	)
2105:lib_AT91SAM7S64.h **** {
2106:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_SWRST;	
2107:lib_AT91SAM7S64.h **** }
2108:lib_AT91SAM7S64.h **** 
2109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2110:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetLastConvertedData
2111:lib_AT91SAM7S64.h **** //* \brief Return the Last Converted Data
2112:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2113:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetLastConvertedData (
2114:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2115:lib_AT91SAM7S64.h **** 	)
2116:lib_AT91SAM7S64.h **** {
2117:lib_AT91SAM7S64.h **** 	return pADC->ADC_LCDR;	
2118:lib_AT91SAM7S64.h **** }
2119:lib_AT91SAM7S64.h **** 
2120:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2121:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH0
2122:lib_AT91SAM7S64.h **** //* \brief Return the Channel 0 Converted Data
2123:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2124:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH0 (
2125:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2126:lib_AT91SAM7S64.h **** 	)
2127:lib_AT91SAM7S64.h **** {
2128:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR0;	
2129:lib_AT91SAM7S64.h **** }
2130:lib_AT91SAM7S64.h **** 
2131:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2132:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH1
2133:lib_AT91SAM7S64.h **** //* \brief Return the Channel 1 Converted Data
2134:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2135:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH1 (
2136:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2137:lib_AT91SAM7S64.h **** 	)
2138:lib_AT91SAM7S64.h **** {
2139:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR1;	
2140:lib_AT91SAM7S64.h **** }
2141:lib_AT91SAM7S64.h **** 
2142:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2143:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH2
2144:lib_AT91SAM7S64.h **** //* \brief Return the Channel 2 Converted Data
2145:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2146:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH2 (
2147:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2148:lib_AT91SAM7S64.h **** 	)
2149:lib_AT91SAM7S64.h **** {
2150:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR2;	
2151:lib_AT91SAM7S64.h **** }
2152:lib_AT91SAM7S64.h **** 
2153:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2154:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH3
2155:lib_AT91SAM7S64.h **** //* \brief Return the Channel 3 Converted Data
2156:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2157:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH3 (
2158:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2159:lib_AT91SAM7S64.h **** 	)
2160:lib_AT91SAM7S64.h **** {
2161:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR3;	
2162:lib_AT91SAM7S64.h **** }
2163:lib_AT91SAM7S64.h **** 
2164:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2165:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH4
2166:lib_AT91SAM7S64.h **** //* \brief Return the Channel 4 Converted Data
2167:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2168:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH4 (
2169:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2170:lib_AT91SAM7S64.h **** 	)
2171:lib_AT91SAM7S64.h **** {
2172:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR4;	
2173:lib_AT91SAM7S64.h **** }
2174:lib_AT91SAM7S64.h **** 
2175:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2176:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH5
2177:lib_AT91SAM7S64.h **** //* \brief Return the Channel 5 Converted Data
2178:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2179:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH5 (
2180:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2181:lib_AT91SAM7S64.h **** 	)
2182:lib_AT91SAM7S64.h **** {
2183:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR5;	
2184:lib_AT91SAM7S64.h **** }
2185:lib_AT91SAM7S64.h **** 
2186:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2187:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH6
2188:lib_AT91SAM7S64.h **** //* \brief Return the Channel 6 Converted Data
2189:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2190:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH6 (
2191:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2192:lib_AT91SAM7S64.h **** 	)
2193:lib_AT91SAM7S64.h **** {
2194:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR6;	
2195:lib_AT91SAM7S64.h **** }
2196:lib_AT91SAM7S64.h **** 
2197:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2198:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH7
2199:lib_AT91SAM7S64.h **** //* \brief Return the Channel 7 Converted Data
2200:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2201:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH7 (
2202:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2203:lib_AT91SAM7S64.h **** 	)
2204:lib_AT91SAM7S64.h **** {
2205:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR7;	
2206:lib_AT91SAM7S64.h **** }
2207:lib_AT91SAM7S64.h **** 
2208:lib_AT91SAM7S64.h **** /* *****************************************************************************
2209:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SSC
2210:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2211:lib_AT91SAM7S64.h **** //* Define the standard I2S mode configuration
2212:lib_AT91SAM7S64.h **** 
2213:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Clock Mode Register
2214:lib_AT91SAM7S64.h **** //* Parameters :  nb_bit_by_slot : 8, 16 or 32 bits
2215:lib_AT91SAM7S64.h **** //* 			  nb_slot_by_frame : number of channels
2216:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_MASTER_TX_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2217:lib_AT91SAM7S64.h **** 									   AT91C_SSC_CKS_DIV   +\
2218:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKO_CONTINOUS      +\
2219:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKG_NONE    +\
2220:lib_AT91SAM7S64.h ****                                        AT91C_SSC_START_FALL_RF +\
2221:lib_AT91SAM7S64.h ****                            			   AT91C_SSC_STTOUT  +\
2222:lib_AT91SAM7S64.h ****                             		   ((1<<16) & AT91C_SSC_STTDLY) +\
2223:lib_AT91SAM7S64.h ****                             		   ((((nb_bit_by_slot*nb_slot_by_frame)/2)-1) <<24))
2224:lib_AT91SAM7S64.h **** 
2225:lib_AT91SAM7S64.h **** 
2226:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Frame Mode Register
2227:lib_AT91SAM7S64.h **** //* Parameters : nb_bit_by_slot : 8, 16 or 32 bits
2228:lib_AT91SAM7S64.h **** //* 			 nb_slot_by_frame : number of channels
2229:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_TX_FRAME_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2230:lib_AT91SAM7S64.h **** 									(nb_bit_by_slot-1)  +\
2231:lib_AT91SAM7S64.h ****                             		AT91C_SSC_MSBF   +\
2232:lib_AT91SAM7S64.h ****                             		(((nb_slot_by_frame-1)<<8) & AT91C_SSC_DATNB)  +\
2233:lib_AT91SAM7S64.h ****                             		(((nb_bit_by_slot-1)<<16) & AT91C_SSC_FSLEN) +\
2234:lib_AT91SAM7S64.h ****                             		AT91C_SSC_FSOS_NEGATIVE)
2235:lib_AT91SAM7S64.h **** 
2236:lib_AT91SAM7S64.h **** 
2237:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2238:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SetBaudrate
2239:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2240:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2241:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_SetBaudrate (
2242:lib_AT91SAM7S64.h ****         AT91PS_SSC pSSC,        // \arg pointer to a SSC controller
2243:lib_AT91SAM7S64.h ****         unsigned int mainClock, // \arg peripheral clock
2244:lib_AT91SAM7S64.h ****         unsigned int speed)     // \arg SSC baudrate
2245:lib_AT91SAM7S64.h **** {
2246:lib_AT91SAM7S64.h ****         unsigned int baud_value;
2247:lib_AT91SAM7S64.h ****         //* Define the baud rate divisor register
2248:lib_AT91SAM7S64.h ****         if (speed == 0)
2249:lib_AT91SAM7S64.h ****            baud_value = 0;
2250:lib_AT91SAM7S64.h ****         else
2251:lib_AT91SAM7S64.h ****         {
2252:lib_AT91SAM7S64.h ****            baud_value = (unsigned int) (mainClock * 10)/(2*speed);
2253:lib_AT91SAM7S64.h ****            if ((baud_value % 10) >= 5)
2254:lib_AT91SAM7S64.h ****                   baud_value = (baud_value / 10) + 1;
2255:lib_AT91SAM7S64.h ****            else
2256:lib_AT91SAM7S64.h ****                   baud_value /= 10;
2257:lib_AT91SAM7S64.h ****         }
2258:lib_AT91SAM7S64.h **** 
2259:lib_AT91SAM7S64.h ****         pSSC->SSC_CMR = baud_value;
2260:lib_AT91SAM7S64.h **** }
2261:lib_AT91SAM7S64.h **** 
2262:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2263:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_Configure
2264:lib_AT91SAM7S64.h **** //* \brief Configure SSC
2265:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2266:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_Configure (
2267:lib_AT91SAM7S64.h ****              AT91PS_SSC pSSC,          // \arg pointer to a SSC controller
2268:lib_AT91SAM7S64.h ****              unsigned int syst_clock,  // \arg System Clock Frequency
2269:lib_AT91SAM7S64.h ****              unsigned int baud_rate,   // \arg Expected Baud Rate Frequency
2270:lib_AT91SAM7S64.h ****              unsigned int clock_rx,    // \arg Receiver Clock Parameters
2271:lib_AT91SAM7S64.h ****              unsigned int mode_rx,     // \arg mode Register to be programmed
2272:lib_AT91SAM7S64.h ****              unsigned int clock_tx,    // \arg Transmitter Clock Parameters
2273:lib_AT91SAM7S64.h ****              unsigned int mode_tx)     // \arg mode Register to be programmed
2274:lib_AT91SAM7S64.h **** {
2275:lib_AT91SAM7S64.h ****     //* Disable interrupts
2276:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = (unsigned int) -1;
2277:lib_AT91SAM7S64.h **** 
2278:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2279:lib_AT91SAM7S64.h **** 	pSSC->SSC_CR = AT91C_SSC_SWRST | AT91C_SSC_RXDIS | AT91C_SSC_TXDIS ;
2280:lib_AT91SAM7S64.h **** 
2281:lib_AT91SAM7S64.h ****     //* Define the Clock Mode Register
2282:lib_AT91SAM7S64.h **** 	AT91F_SSC_SetBaudrate(pSSC, syst_clock, baud_rate);
2283:lib_AT91SAM7S64.h **** 
2284:lib_AT91SAM7S64.h ****      //* Write the Receive Clock Mode Register
2285:lib_AT91SAM7S64.h **** 	pSSC->SSC_RCMR =  clock_rx;
2286:lib_AT91SAM7S64.h **** 
2287:lib_AT91SAM7S64.h ****      //* Write the Transmit Clock Mode Register
2288:lib_AT91SAM7S64.h **** 	pSSC->SSC_TCMR =  clock_tx;
2289:lib_AT91SAM7S64.h **** 
2290:lib_AT91SAM7S64.h ****      //* Write the Receive Frame Mode Register
2291:lib_AT91SAM7S64.h **** 	pSSC->SSC_RFMR =  mode_rx;
2292:lib_AT91SAM7S64.h **** 
2293:lib_AT91SAM7S64.h ****      //* Write the Transmit Frame Mode Register
2294:lib_AT91SAM7S64.h **** 	pSSC->SSC_TFMR =  mode_tx;
2295:lib_AT91SAM7S64.h **** 
2296:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2297:lib_AT91SAM7S64.h **** 	AT91F_PDC_Open((AT91PS_PDC) &(pSSC->SSC_RPR));
2298:lib_AT91SAM7S64.h **** 
2299:lib_AT91SAM7S64.h **** 
2300:lib_AT91SAM7S64.h **** }
2301:lib_AT91SAM7S64.h **** 
2302:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2303:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableRx
2304:lib_AT91SAM7S64.h **** //* \brief Enable receiving datas
2305:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2306:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableRx (
2307:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2308:lib_AT91SAM7S64.h **** {
2309:lib_AT91SAM7S64.h ****     //* Enable receiver
2310:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXEN;
2311:lib_AT91SAM7S64.h **** }
2312:lib_AT91SAM7S64.h **** 
2313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2314:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableRx
2315:lib_AT91SAM7S64.h **** //* \brief Disable receiving datas
2316:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2317:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableRx (
2318:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2319:lib_AT91SAM7S64.h **** {
2320:lib_AT91SAM7S64.h ****     //* Disable receiver
2321:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXDIS;
2322:lib_AT91SAM7S64.h **** }
2323:lib_AT91SAM7S64.h **** 
2324:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2325:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableTx
2326:lib_AT91SAM7S64.h **** //* \brief Enable sending datas
2327:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2328:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableTx (
2329:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2330:lib_AT91SAM7S64.h **** {
2331:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2332:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXEN;
2333:lib_AT91SAM7S64.h **** }
2334:lib_AT91SAM7S64.h **** 
2335:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2336:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableTx
2337:lib_AT91SAM7S64.h **** //* \brief Disable sending datas
2338:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2339:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableTx (
2340:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2341:lib_AT91SAM7S64.h **** {
2342:lib_AT91SAM7S64.h ****     //* Disable  transmitter
2343:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXDIS;
2344:lib_AT91SAM7S64.h **** }
2345:lib_AT91SAM7S64.h **** 
2346:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2347:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableIt
2348:lib_AT91SAM7S64.h **** //* \brief Enable SSC IT
2349:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2350:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableIt (
2351:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2352:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2353:lib_AT91SAM7S64.h **** {
2354:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2355:lib_AT91SAM7S64.h **** 	pSSC->SSC_IER = flag;
2356:lib_AT91SAM7S64.h **** }
2357:lib_AT91SAM7S64.h **** 
2358:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2359:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableIt
2360:lib_AT91SAM7S64.h **** //* \brief Disable SSC IT
2361:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2362:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableIt (
2363:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2364:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2365:lib_AT91SAM7S64.h **** {
2366:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
2367:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = flag;
2368:lib_AT91SAM7S64.h **** }
2369:lib_AT91SAM7S64.h **** 
2370:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2371:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_ReceiveFrame
2372:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2373:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2374:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_ReceiveFrame (
2375:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2376:lib_AT91SAM7S64.h **** 	char *pBuffer,
2377:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2378:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2379:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2380:lib_AT91SAM7S64.h **** {
2381:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
2382:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2383:lib_AT91SAM7S64.h **** 		pBuffer,
2384:lib_AT91SAM7S64.h **** 		szBuffer,
2385:lib_AT91SAM7S64.h **** 		pNextBuffer,
2386:lib_AT91SAM7S64.h **** 		szNextBuffer);
2387:lib_AT91SAM7S64.h **** }
2388:lib_AT91SAM7S64.h **** 
2389:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2390:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SendFrame
2391:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2392:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2393:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_SendFrame(
2394:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2395:lib_AT91SAM7S64.h **** 	char *pBuffer,
2396:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2397:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2398:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2399:lib_AT91SAM7S64.h **** {
2400:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
2401:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2402:lib_AT91SAM7S64.h **** 		pBuffer,
2403:lib_AT91SAM7S64.h **** 		szBuffer,
2404:lib_AT91SAM7S64.h **** 		pNextBuffer,
2405:lib_AT91SAM7S64.h **** 		szNextBuffer);
2406:lib_AT91SAM7S64.h **** }
2407:lib_AT91SAM7S64.h **** 
2408:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2409:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_GetInterruptMaskStatus
2410:lib_AT91SAM7S64.h **** //* \brief Return SSC Interrupt Mask Status
2411:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2412:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_GetInterruptMaskStatus( // \return SSC Interrupt Mask Status
2413:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc) // \arg  pointer to a SSC controller
2414:lib_AT91SAM7S64.h **** {
2415:lib_AT91SAM7S64.h ****         return pSsc->SSC_IMR;
2416:lib_AT91SAM7S64.h **** }
2417:lib_AT91SAM7S64.h **** 
2418:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2419:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_IsInterruptMasked
2420:lib_AT91SAM7S64.h **** //* \brief Test if SSC Interrupt is Masked 
2421:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2422:lib_AT91SAM7S64.h **** __inline int AT91F_SSC_IsInterruptMasked(
2423:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc,   // \arg  pointer to a SSC controller
2424:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2425:lib_AT91SAM7S64.h **** {
2426:lib_AT91SAM7S64.h ****         return (AT91F_SSC_GetInterruptMaskStatus(pSsc) & flag);
2427:lib_AT91SAM7S64.h **** }
2428:lib_AT91SAM7S64.h **** 
2429:lib_AT91SAM7S64.h **** /* *****************************************************************************
2430:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR USART
2431:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2432:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2433:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2434:lib_AT91SAM7S64.h **** //* \brief Calculate the baudrate
2435:lib_AT91SAM7S64.h **** //* Standard Asynchronous Mode : 8 bits , 1 stop , no parity
2436:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_MODE ( AT91C_US_USMODE_NORMAL + \
2437:lib_AT91SAM7S64.h ****                         AT91C_US_NBSTOP_1_BIT + \
2438:lib_AT91SAM7S64.h ****                         AT91C_US_PAR_NONE + \
2439:lib_AT91SAM7S64.h ****                         AT91C_US_CHRL_8_BITS + \
2440:lib_AT91SAM7S64.h ****                         AT91C_US_CLKS_CLOCK )
2441:lib_AT91SAM7S64.h **** 
2442:lib_AT91SAM7S64.h **** //* Standard External Asynchronous Mode : 8 bits , 1 stop , no parity
2443:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_SCK_MODE ( AT91C_US_USMODE_NORMAL + \
2444:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2445:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2446:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2447:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_EXT )
2448:lib_AT91SAM7S64.h **** 
2449:lib_AT91SAM7S64.h **** //* Standard Synchronous Mode : 8 bits , 1 stop , no parity
2450:lib_AT91SAM7S64.h **** #define AT91C_US_SYNC_MODE ( AT91C_US_SYNC + \
2451:lib_AT91SAM7S64.h ****                        AT91C_US_USMODE_NORMAL + \
2452:lib_AT91SAM7S64.h ****                        AT91C_US_NBSTOP_1_BIT + \
2453:lib_AT91SAM7S64.h ****                        AT91C_US_PAR_NONE + \
2454:lib_AT91SAM7S64.h ****                        AT91C_US_CHRL_8_BITS + \
2455:lib_AT91SAM7S64.h ****                        AT91C_US_CLKS_CLOCK )
2456:lib_AT91SAM7S64.h **** 
2457:lib_AT91SAM7S64.h **** //* SCK used Label
2458:lib_AT91SAM7S64.h **** #define AT91C_US_SCK_USED (AT91C_US_CKLO | AT91C_US_CLKS_EXT)
2459:lib_AT91SAM7S64.h **** 
2460:lib_AT91SAM7S64.h **** //* Standard ISO T=0 Mode : 8 bits , 1 stop , parity
2461:lib_AT91SAM7S64.h **** #define AT91C_US_ISO_READER_MODE ( AT91C_US_USMODE_ISO7816_0 + \
2462:lib_AT91SAM7S64.h **** 					   		 AT91C_US_CLKS_CLOCK +\
2463:lib_AT91SAM7S64.h ****                        		 AT91C_US_NBSTOP_1_BIT + \
2464:lib_AT91SAM7S64.h ****                        		 AT91C_US_PAR_EVEN + \
2465:lib_AT91SAM7S64.h ****                        		 AT91C_US_CHRL_8_BITS + \
2466:lib_AT91SAM7S64.h ****                        		 AT91C_US_CKLO +\
2467:lib_AT91SAM7S64.h ****                        		 AT91C_US_OVER)
2468:lib_AT91SAM7S64.h **** 
2469:lib_AT91SAM7S64.h **** //* Standard IRDA mode
2470:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_IRDA_MODE (  AT91C_US_USMODE_IRDA + \
2471:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2472:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2473:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2474:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_CLOCK )
2475:lib_AT91SAM7S64.h **** 
2476:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2477:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2478:lib_AT91SAM7S64.h **** //* \brief Caluculate baud_value according to the main clock and the baud rate
2479:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2480:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Baudrate (
2481:lib_AT91SAM7S64.h **** 	const unsigned int main_clock, // \arg peripheral clock
2482:lib_AT91SAM7S64.h **** 	const unsigned int baud_rate)  // \arg UART baudrate
2483:lib_AT91SAM7S64.h **** {
2484:lib_AT91SAM7S64.h **** 	unsigned int baud_value = ((main_clock*10)/(baud_rate * 16));
2485:lib_AT91SAM7S64.h **** 	if ((baud_value % 10) >= 5)
2486:lib_AT91SAM7S64.h **** 		baud_value = (baud_value / 10) + 1;
2487:lib_AT91SAM7S64.h **** 	else
2488:lib_AT91SAM7S64.h **** 		baud_value /= 10;
2489:lib_AT91SAM7S64.h **** 	return baud_value;
2490:lib_AT91SAM7S64.h **** }
2491:lib_AT91SAM7S64.h **** 
2492:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2493:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetBaudrate
2494:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2495:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2496:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetBaudrate (
2497:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2498:lib_AT91SAM7S64.h **** 	unsigned int mainClock, // \arg peripheral clock
2499:lib_AT91SAM7S64.h **** 	unsigned int speed)     // \arg UART baudrate
2500:lib_AT91SAM7S64.h **** {
2501:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2502:lib_AT91SAM7S64.h **** 	pUSART->US_BRGR = AT91F_US_Baudrate(mainClock, speed);
2503:lib_AT91SAM7S64.h **** }
2504:lib_AT91SAM7S64.h **** 
2505:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2506:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetTimeguard
2507:lib_AT91SAM7S64.h **** //* \brief Set USART timeguard
2508:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2509:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetTimeguard (
2510:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2511:lib_AT91SAM7S64.h **** 	unsigned int timeguard) // \arg timeguard value
2512:lib_AT91SAM7S64.h **** {
2513:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2514:lib_AT91SAM7S64.h **** 	pUSART->US_TTGR = timeguard ;
2515:lib_AT91SAM7S64.h **** }
2516:lib_AT91SAM7S64.h **** 
2517:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2518:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableIt
2519:lib_AT91SAM7S64.h **** //* \brief Enable USART IT
2520:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2521:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableIt (
2522:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2523:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2524:lib_AT91SAM7S64.h **** {
2525:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2526:lib_AT91SAM7S64.h **** 	pUSART->US_IER = flag;
2527:lib_AT91SAM7S64.h **** }
2528:lib_AT91SAM7S64.h **** 
2529:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2530:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableIt
2531:lib_AT91SAM7S64.h **** //* \brief Disable USART IT
2532:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2533:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableIt (
2534:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2535:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2536:lib_AT91SAM7S64.h **** {
2537:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2538:lib_AT91SAM7S64.h **** 	pUSART->US_IDR = flag;
2539:lib_AT91SAM7S64.h **** }
2540:lib_AT91SAM7S64.h **** 
2541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2542:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Configure
2543:lib_AT91SAM7S64.h **** //* \brief Configure USART
2544:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2545:lib_AT91SAM7S64.h **** __inline void AT91F_US_Configure (
2546:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,     // \arg pointer to a USART controller
2547:lib_AT91SAM7S64.h **** 	unsigned int mainClock,  // \arg peripheral clock
2548:lib_AT91SAM7S64.h **** 	unsigned int mode ,      // \arg mode Register to be programmed
2549:lib_AT91SAM7S64.h **** 	unsigned int baudRate ,  // \arg baudrate to be programmed
2550:lib_AT91SAM7S64.h **** 	unsigned int timeguard ) // \arg timeguard to be programmed
2551:lib_AT91SAM7S64.h **** {
2552:lib_AT91SAM7S64.h ****     //* Disable interrupts
2553:lib_AT91SAM7S64.h ****     pUSART->US_IDR = (unsigned int) -1;
2554:lib_AT91SAM7S64.h **** 
2555:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2556:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RSTRX | AT91C_US_RSTTX | AT91C_US_RXDIS | AT91C_US_TXDIS ;
2557:lib_AT91SAM7S64.h **** 
2558:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2559:lib_AT91SAM7S64.h **** 	AT91F_US_SetBaudrate(pUSART, mainClock, baudRate);
2560:lib_AT91SAM7S64.h **** 
2561:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2562:lib_AT91SAM7S64.h **** 	AT91F_US_SetTimeguard(pUSART, timeguard);
2563:lib_AT91SAM7S64.h **** 
2564:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2565:lib_AT91SAM7S64.h ****     AT91F_PDC_Open((AT91PS_PDC) &(pUSART->US_RPR));
2566:lib_AT91SAM7S64.h **** 
2567:lib_AT91SAM7S64.h ****     //* Define the USART mode
2568:lib_AT91SAM7S64.h ****     pUSART->US_MR = mode  ;
2569:lib_AT91SAM7S64.h **** 
2570:lib_AT91SAM7S64.h **** }
2571:lib_AT91SAM7S64.h **** 
2572:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2573:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableRx
2574:lib_AT91SAM7S64.h **** //* \brief Enable receiving characters
2575:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2576:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableRx (
2577:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2578:lib_AT91SAM7S64.h **** {
2579:lib_AT91SAM7S64.h ****     //* Enable receiver
2580:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2581:lib_AT91SAM7S64.h **** }
2582:lib_AT91SAM7S64.h **** 
2583:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2584:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableTx
2585:lib_AT91SAM7S64.h **** //* \brief Enable sending characters
2586:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2587:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableTx (
2588:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2589:lib_AT91SAM7S64.h **** {
2590:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2591:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2592:lib_AT91SAM7S64.h **** }
2593:lib_AT91SAM7S64.h **** 
2594:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2595:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetRx
2596:lib_AT91SAM7S64.h **** //* \brief Reset Receiver and re-enable it
2597:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2598:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetRx (
2599:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2600:lib_AT91SAM7S64.h **** {
2601:lib_AT91SAM7S64.h **** 	//* Reset receiver
2602:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTRX;
2603:lib_AT91SAM7S64.h ****     //* Re-Enable receiver
2604:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2605:lib_AT91SAM7S64.h **** }
2606:lib_AT91SAM7S64.h **** 
2607:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2608:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetTx
2609:lib_AT91SAM7S64.h **** //* \brief Reset Transmitter and re-enable it
2610:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2611:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetTx (
2612:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2613:lib_AT91SAM7S64.h **** {
2614:lib_AT91SAM7S64.h **** 	//* Reset transmitter
2615:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTTX;
2616:lib_AT91SAM7S64.h ****     //* Enable transmitter
2617:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2618:lib_AT91SAM7S64.h **** }
2619:lib_AT91SAM7S64.h **** 
2620:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2621:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableRx
2622:lib_AT91SAM7S64.h **** //* \brief Disable Receiver
2623:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2624:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableRx (
2625:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2626:lib_AT91SAM7S64.h **** {
2627:lib_AT91SAM7S64.h ****     //* Disable receiver
2628:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXDIS;
2629:lib_AT91SAM7S64.h **** }
2630:lib_AT91SAM7S64.h **** 
2631:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2632:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableTx
2633:lib_AT91SAM7S64.h **** //* \brief Disable Transmitter
2634:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2635:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableTx (
2636:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2637:lib_AT91SAM7S64.h **** {
2638:lib_AT91SAM7S64.h ****     //* Disable transmitter
2639:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS;
2640:lib_AT91SAM7S64.h **** }
2641:lib_AT91SAM7S64.h **** 
2642:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2643:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Close
2644:lib_AT91SAM7S64.h **** //* \brief Close USART: disable IT disable receiver and transmitter, close PDC
2645:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2646:lib_AT91SAM7S64.h **** __inline void AT91F_US_Close (
2647:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2648:lib_AT91SAM7S64.h **** {
2649:lib_AT91SAM7S64.h ****     //* Reset the baud rate divisor register
2650:lib_AT91SAM7S64.h ****     pUSART->US_BRGR = 0 ;
2651:lib_AT91SAM7S64.h **** 
2652:lib_AT91SAM7S64.h ****     //* Reset the USART mode
2653:lib_AT91SAM7S64.h ****     pUSART->US_MR = 0  ;
2654:lib_AT91SAM7S64.h **** 
2655:lib_AT91SAM7S64.h ****     //* Reset the Timeguard Register
2656:lib_AT91SAM7S64.h ****     pUSART->US_TTGR = 0;
2657:lib_AT91SAM7S64.h **** 
2658:lib_AT91SAM7S64.h ****     //* Disable all interrupts
2659:lib_AT91SAM7S64.h ****     pUSART->US_IDR = 0xFFFFFFFF ;
2660:lib_AT91SAM7S64.h **** 
2661:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
2662:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pUSART->US_RPR));
2663:lib_AT91SAM7S64.h **** 
2664:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
2665:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS | AT91C_US_RXDIS | AT91C_US_RSTTX | AT91C_US_RSTRX ;
2666:lib_AT91SAM7S64.h **** }
2667:lib_AT91SAM7S64.h **** 
2668:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2669:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_TxReady
2670:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be written in US_THR
2671:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2672:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_TxReady (
2673:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2674:lib_AT91SAM7S64.h **** {
2675:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_TXRDY);
  27              		.loc 2 2675 0
  28 0004 0D2CE0E3 		mvn	r2, #3328
  29 0008 EB3012E5 		ldr	r3, [r2, #-235]
  30              	.LBE7:
  31              	.LBE6:
  21:syscalls.c    **** 	while (!AT91F_US_TxReady((AT91PS_USART)AT91C_BASE_DBGU));
  32              		.loc 1 21 0
  33 000c 020013E3 		tst	r3, #2
  34 0010 FFFFFF0A 		beq	.L3
  35              	.LBB8:
  36              	.LBB9:
2676:lib_AT91SAM7S64.h **** }
2677:lib_AT91SAM7S64.h **** 
2678:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2679:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_RxReady
2680:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be read in US_RHR
2681:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2682:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_RxReady (
2683:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2684:lib_AT91SAM7S64.h **** {
2685:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_RXRDY);
2686:lib_AT91SAM7S64.h **** }
2687:lib_AT91SAM7S64.h **** 
2688:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2689:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Error
2690:lib_AT91SAM7S64.h **** //* \brief Return the error flag
2691:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2692:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Error (
2693:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2694:lib_AT91SAM7S64.h **** {
2695:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR &
2696:lib_AT91SAM7S64.h ****     	(AT91C_US_OVRE |  // Overrun error
2697:lib_AT91SAM7S64.h ****     	 AT91C_US_FRAME | // Framing error
2698:lib_AT91SAM7S64.h ****     	 AT91C_US_PARE));  // Parity error
2699:lib_AT91SAM7S64.h **** }
2700:lib_AT91SAM7S64.h **** 
2701:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2702:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_PutChar
2703:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
2704:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2705:lib_AT91SAM7S64.h **** __inline void AT91F_US_PutChar (
2706:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2707:lib_AT91SAM7S64.h **** 	int character )
2708:lib_AT91SAM7S64.h **** {
2709:lib_AT91SAM7S64.h ****     pUSART->US_THR = (character & 0x1FF);
  37              		.loc 2 2709 0
  38 0014 803BA0E1 		mov	r3, r0, asl #23
  39 0018 A33BA0E1 		mov	r3, r3, lsr #23
  40 001c E33002E5 		str	r3, [r2, #-227]
  41              	.LBE9:
  42              	.LBE8:
  22:syscalls.c    **** 	AT91F_US_PutChar((AT91PS_USART)AT91C_BASE_DBGU, c);
  23:syscalls.c    **** }
  43              		.loc 1 23 0
  44 0020 1EFF2FE1 		bx	lr
  45              	.LFE290:
  47              		.align	2
  48              		.global	_read_r
  50              	_read_r:
  51              	.LFB293:
  24:syscalls.c    **** 
  25:syscalls.c    **** static int  my_kbhit( void ) 
  26:syscalls.c    **** {
  27:syscalls.c    **** 	if ((AT91F_US_RxReady((AT91PS_USART)AT91C_BASE_DBGU)) == 0) return 0;
  28:syscalls.c    **** 	else return 1;
  29:syscalls.c    **** }
  30:syscalls.c    **** 
  31:syscalls.c    **** static char my_getc( void )
  32:syscalls.c    **** {
  33:syscalls.c    **** 	return AT91F_US_GetChar((AT91PS_USART)AT91C_BASE_DBGU);
  34:syscalls.c    **** }
  35:syscalls.c    **** 
  36:syscalls.c    **** _ssize_t _read_r(
  37:syscalls.c    ****     struct _reent *r, 
  38:syscalls.c    ****     int file, 
  39:syscalls.c    ****     void *ptr, 
  40:syscalls.c    ****     size_t len)
  41:syscalls.c    **** {
  52              		.loc 1 41 0
  53              		@ Function supports interworking.
  54              		@ args = 0, pretend = 0, frame = 0
  55              		@ frame_needed = 0, uses_anonymous_args = 0
  56              	.LVL1:
  57 0024 04E02DE5 		str	lr, [sp, #-4]!
  58              	.LCFI0:
  59              		.loc 1 41 0
  60 0028 0300A0E1 		mov	r0, r3
  61              	.LVL2:
  42:syscalls.c    **** 	char c;
  43:syscalls.c    **** 	int  i;
  44:syscalls.c    **** 	unsigned char *p;
  45:syscalls.c    **** 	
  46:syscalls.c    **** 	p = (unsigned char*)ptr;
  62              		.loc 1 46 0
  63 002c 0010A0E3 		mov	r1, #0
  64              	.LVL3:
  65 0030 150000EA 		b	.L9
  66              	.LVL4:
  67              	.L16:
  68              	.LBB18:
  69              	.LBB19:
  70              	.LBB20:
  71              	.LBB21:
  72              		.loc 2 2685 0
  73 0034 0DCCE0E3 		mvn	ip, #3328
  74 0038 EB301CE5 		ldr	r3, [ip, #-235]
  75              	.LVL5:
  76              	.LBE21:
  77              	.LBE20:
  78              		.loc 1 27 0
  79 003c 010013E3 		tst	r3, #1
  80 0040 1900001A 		bne	.L18
  81 0044 0B0000EA 		b	.L16
  82              	.LVL6:
  83              	.L12:
  84              	.LBE19:
  85              	.LBE18:
  47:syscalls.c    **** 	
  48:syscalls.c    **** 	for (i = 0; i < len; i++) {
  49:syscalls.c    **** 		// c = uart0Getch();
  50:syscalls.c    **** 		// c = uart0GetchW();
  51:syscalls.c    **** 		while ( !my_kbhit() ) ;
  52:syscalls.c    **** 		c = (char) my_getc();
  53:syscalls.c    **** 		if (c == 0x0D) {
  54:syscalls.c    **** 			*p='\0';
  86              		.loc 1 54 0
  87 0048 0030A0E3 		mov	r3, #0
  88              	.LVL7:
  89 004c 0030CEE5 		strb	r3, [lr, #0]
  90 0050 1E0000EA 		b	.L13
  91              	.LVL8:
  92              	.L19:
  55:syscalls.c    **** 			break;
  56:syscalls.c    **** 		}
  57:syscalls.c    **** 		*p++ = c;
  93              		.loc 1 57 0
  94 0054 0230C1E7 		strb	r3, [r1, r2]
  95              		.loc 1 48 0
  96 0058 011081E2 		add	r1, r1, #1
  97              	.LVL9:
  98              	.L9:
  99 005c 000051E1 		cmp	r1, r0
 100              		.loc 1 41 0
 101 0060 01E082E0 		add	lr, r2, r1
 102              		.loc 1 48 0
 103 0064 0B00001A 		bne	.L16
 104 0068 1E0000EA 		b	.L13
 105              	.LVL10:
 106              	.L18:
 107              	.LBB22:
 108              	.LBB23:
 109              	.LBB24:
 110              	.LBB25:
2710:lib_AT91SAM7S64.h **** }
2711:lib_AT91SAM7S64.h **** 
2712:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2713:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_GetChar
2714:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
2715:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2716:lib_AT91SAM7S64.h **** __inline int AT91F_US_GetChar (
2717:lib_AT91SAM7S64.h **** 	const AT91PS_USART pUSART)
2718:lib_AT91SAM7S64.h **** {
2719:lib_AT91SAM7S64.h ****     return((pUSART->US_RHR) & 0x1FF);
 111              		.loc 2 2719 0
 112 006c E7301CE5 		ldr	r3, [ip, #-231]
 113              	.LBE25:
 114              	.LBE24:
 115              	.LBE23:
 116              	.LBE22:
 117              		.loc 1 52 0
 118 0070 FF3003E2 		and	r3, r3, #255
 119              	.LVL11:
 120              		.loc 1 53 0
 121 0074 0D0053E3 		cmp	r3, #13
 122 0078 1300001A 		bne	.L19
 123 007c 100000EA 		b	.L12
 124              	.LVL12:
 125              	.L13:
  58:syscalls.c    **** 		////// uart0_putc(c);
  59:syscalls.c    **** 	}
  60:syscalls.c    **** 	return len - i;
  61:syscalls.c    **** }
 126              		.loc 1 61 0
 127 0080 000061E0 		rsb	r0, r1, r0
 128              	.LVL13:
 129 0084 04E09DE4 		ldr	lr, [sp], #4
 130 0088 1EFF2FE1 		bx	lr
 131              	.LFE293:
 133              		.align	2
 134              		.global	_write_r
 136              	_write_r:
 137              	.LFB294:
  62:syscalls.c    **** 
  63:syscalls.c    **** 
  64:syscalls.c    **** _ssize_t _write_r (
  65:syscalls.c    ****     struct _reent *r, 
  66:syscalls.c    ****     int file, 
  67:syscalls.c    ****     const void *ptr, 
  68:syscalls.c    ****     size_t len)
  69:syscalls.c    **** {
 138              		.loc 1 69 0
 139              		@ Function supports interworking.
 140              		@ args = 0, pretend = 0, frame = 0
 141              		@ frame_needed = 0, uses_anonymous_args = 0
 142              	.LVL14:
 143 008c 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 144              	.LCFI1:
 145              		.loc 1 69 0
 146 0090 0250A0E1 		mov	r5, r2
 147 0094 0360A0E1 		mov	r6, r3
  70:syscalls.c    **** 	int i;
  71:syscalls.c    **** 	const unsigned char *p;
  72:syscalls.c    **** 	
  73:syscalls.c    **** 	p = (const unsigned char*) ptr;
 148              		.loc 1 73 0
 149 0098 0040A0E3 		mov	r4, #0
 150              	.LVL15:
 151 009c 2C0000EA 		b	.L21
 152              	.LVL16:
 153              	.L22:
  74:syscalls.c    **** 	
  75:syscalls.c    **** 	for (i = 0; i < len; i++) {
  76:syscalls.c    **** 		if (*p == '\n' ) my_putc('\r');
 154              		.loc 1 76 0
 155 00a0 0530D4E7 		ldrb	r3, [r4, r5]	@ zero_extendqisi2
 156 00a4 0A0053E3 		cmp	r3, #10
 157 00a8 FEFFFF0B 		bleq	my_putc
 158              	.LVL17:
 159              	.L23:
  77:syscalls.c    **** 		my_putc(*p++);
 160              		.loc 1 77 0
 161 00ac 0500D4E7 		ldrb	r0, [r4, r5]	@ zero_extendqisi2
 162              		.loc 1 75 0
 163 00b0 014084E2 		add	r4, r4, #1
 164              		.loc 1 77 0
 165 00b4 FEFFFFEB 		bl	my_putc
 166              	.LVL18:
 167              	.L21:
 168              		.loc 1 75 0
 169 00b8 060054E1 		cmp	r4, r6
 170              		.loc 1 76 0
 171 00bc 0D00A0E3 		mov	r0, #13
 172              	.LVL19:
 173              		.loc 1 75 0
 174 00c0 2600001A 		bne	.L22
  78:syscalls.c    **** 	}
  79:syscalls.c    **** 	
  80:syscalls.c    **** 	return len;
  81:syscalls.c    **** }
 175              		.loc 1 81 0
 176 00c4 0400A0E1 		mov	r0, r4
 177 00c8 7040BDE8 		ldmfd	sp!, {r4, r5, r6, lr}
 178 00cc 1EFF2FE1 		bx	lr
 179              	.LFE294:
 181              		.align	2
 182              		.global	_close_r
 184              	_close_r:
 185              	.LFB295:
  82:syscalls.c    **** 
  83:syscalls.c    **** 
  84:syscalls.c    **** int _close_r(
  85:syscalls.c    ****     struct _reent *r, 
  86:syscalls.c    ****     int file)
  87:syscalls.c    **** {
 186              		.loc 1 87 0
 187              		@ Function supports interworking.
 188              		@ args = 0, pretend = 0, frame = 0
 189              		@ frame_needed = 0, uses_anonymous_args = 0
 190              		@ link register save eliminated.
 191              	.LVL20:
  88:syscalls.c    **** 	return 0;
  89:syscalls.c    **** }
 192              		.loc 1 89 0
 193 00d0 0000A0E3 		mov	r0, #0
 194              	.LVL21:
 195              		.loc 1 87 0
 196              		@ lr needed for prologue
 197              		.loc 1 89 0
 198 00d4 1EFF2FE1 		bx	lr
 199              	.LFE295:
 201              		.align	2
 202              		.global	_lseek_r
 204              	_lseek_r:
 205              	.LFB296:
  90:syscalls.c    **** 
  91:syscalls.c    **** 
  92:syscalls.c    **** _off_t _lseek_r(
  93:syscalls.c    ****     struct _reent *r, 
  94:syscalls.c    ****     int file, 
  95:syscalls.c    ****     _off_t ptr, 
  96:syscalls.c    ****     int dir)
  97:syscalls.c    **** {
 206              		.loc 1 97 0
 207              		@ Function supports interworking.
 208              		@ args = 0, pretend = 0, frame = 0
 209              		@ frame_needed = 0, uses_anonymous_args = 0
 210              		@ link register save eliminated.
 211              	.LVL22:
  98:syscalls.c    **** 	return (_off_t)0;	/*  Always indicate we are at file beginning.  */
  99:syscalls.c    **** }
 212              		.loc 1 99 0
 213 00d8 0000A0E3 		mov	r0, #0
 214              	.LVL23:
 215              		.loc 1 97 0
 216              		@ lr needed for prologue
 217              		.loc 1 99 0
 218 00dc 1EFF2FE1 		bx	lr
 219              	.LFE296:
 221              		.align	2
 222              		.global	_fstat_r
 224              	_fstat_r:
 225              	.LFB297:
 100:syscalls.c    **** 
 101:syscalls.c    **** 
 102:syscalls.c    **** int _fstat_r(
 103:syscalls.c    ****     struct _reent *r, 
 104:syscalls.c    ****     int file, 
 105:syscalls.c    ****     struct stat *st)
 106:syscalls.c    **** {
 226              		.loc 1 106 0
 227              		@ Function supports interworking.
 228              		@ args = 0, pretend = 0, frame = 0
 229              		@ frame_needed = 0, uses_anonymous_args = 0
 230              		@ link register save eliminated.
 231              	.LVL24:
 107:syscalls.c    **** 	/*  Always set as character device.				*/
 108:syscalls.c    **** 	st->st_mode = S_IFCHR;
 232              		.loc 1 108 0
 233 00e0 023AA0E3 		mov	r3, #8192
 109:syscalls.c    **** 	/* assigned to strong type with implicit 	*/
 110:syscalls.c    **** 	/* signed/unsigned conversion.  Required by 	*/
 111:syscalls.c    **** 	/* newlib.					*/
 112:syscalls.c    **** 
 113:syscalls.c    **** 	return 0;
 114:syscalls.c    **** }
 234              		.loc 1 114 0
 235 00e4 0000A0E3 		mov	r0, #0
 236              	.LVL25:
 237              		.loc 1 106 0
 238              		@ lr needed for prologue
 239              		.loc 1 108 0
 240 00e8 043082E5 		str	r3, [r2, #4]
 241              		.loc 1 114 0
 242 00ec 1EFF2FE1 		bx	lr
 243              	.LFE297:
 245              		.align	2
 246              		.global	isatty
 248              	isatty:
 249              	.LFB298:
 115:syscalls.c    **** 
 116:syscalls.c    **** 
 117:syscalls.c    **** int isatty(int file); /* avoid warning */
 118:syscalls.c    **** 
 119:syscalls.c    **** int isatty(int file)
 120:syscalls.c    **** {
 250              		.loc 1 120 0
 251              		@ Function supports interworking.
 252              		@ args = 0, pretend = 0, frame = 0
 253              		@ frame_needed = 0, uses_anonymous_args = 0
 254              		@ link register save eliminated.
 255              	.LVL26:
 121:syscalls.c    **** 	return 1;
 122:syscalls.c    **** }
 256              		.loc 1 122 0
 257 00f0 0100A0E3 		mov	r0, #1
 258              	.LVL27:
 259              		.loc 1 120 0
 260              		@ lr needed for prologue
 261              		.loc 1 122 0
 262 00f4 1EFF2FE1 		bx	lr
 263              	.LFE298:
 265              		.align	2
 266              		.global	_sbrk_r
 268              	_sbrk_r:
 269              	.LFB299:
 123:syscalls.c    **** 
 124:syscalls.c    **** 
 125:syscalls.c    **** #if 0
 126:syscalls.c    **** static void _exit (int n) {
 127:syscalls.c    **** label:  goto label; /* endless loop */
 128:syscalls.c    **** }
 129:syscalls.c    **** #endif 
 130:syscalls.c    **** 
 131:syscalls.c    **** 
 132:syscalls.c    **** /* "malloc clue function" from newlib-lpc/Keil-Demo/"generic" */
 133:syscalls.c    **** 
 134:syscalls.c    **** /**** Locally used variables. ****/
 135:syscalls.c    **** // mt: "cleaner": extern char* end;
 136:syscalls.c    **** extern char end[];              /*  end is set in the linker command 	*/
 137:syscalls.c    **** 				/* file and is the end of statically 	*/
 138:syscalls.c    **** 				/* allocated data (thus start of heap).	*/
 139:syscalls.c    **** 
 140:syscalls.c    **** static char *heap_ptr;		/* Points to current end of the heap.	*/
 141:syscalls.c    **** 
 142:syscalls.c    **** /************************** _sbrk_r *************************************
 143:syscalls.c    ****  * Support function. Adjusts end of heap to provide more memory to
 144:syscalls.c    ****  * memory allocator. Simple and dumb with no sanity checks.
 145:syscalls.c    **** 
 146:syscalls.c    ****  *  struct _reent *r -- re-entrancy structure, used by newlib to
 147:syscalls.c    ****  *                      support multiple threads of operation.
 148:syscalls.c    ****  *  ptrdiff_t nbytes -- number of bytes to add.
 149:syscalls.c    ****  *                      Returns pointer to start of new heap area.
 150:syscalls.c    ****  *
 151:syscalls.c    ****  *  Note:  This implementation is not thread safe (despite taking a
 152:syscalls.c    ****  *         _reent structure as a parameter).
 153:syscalls.c    ****  *         Since _s_r is not used in the current implementation, 
 154:syscalls.c    ****  *         the following messages must be suppressed.
 155:syscalls.c    ****  */
 156:syscalls.c    **** void * _sbrk_r(
 157:syscalls.c    ****     struct _reent *_s_r, 
 158:syscalls.c    ****     ptrdiff_t nbytes)
 159:syscalls.c    **** {
 270              		.loc 1 159 0
 271              		@ Function supports interworking.
 272              		@ args = 0, pretend = 0, frame = 0
 273              		@ frame_needed = 0, uses_anonymous_args = 0
 274              		@ link register save eliminated.
 275              	.LVL28:
 160:syscalls.c    **** 	char  *base;		/*  errno should be set to  ENOMEM on error  */
 161:syscalls.c    **** 
 162:syscalls.c    **** 	if (!heap_ptr) {	/*  Initialize if first time through.  */
 276              		.loc 1 162 0
 277 00f8 1C209FE5 		ldr	r2, .L39
 278 00fc 003092E5 		ldr	r3, [r2, #0]
 279 0100 000053E3 		cmp	r3, #0
 163:syscalls.c    **** 		heap_ptr = end;
 280              		.loc 1 163 0
 281 0104 14309F05 		ldreq	r3, .L39+4
 282 0108 00308205 		streq	r3, [r2, #0]
 164:syscalls.c    **** 	}
 165:syscalls.c    **** 	base = heap_ptr;	/*  Point to end of heap.  */
 283              		.loc 1 165 0
 284 010c 000092E5 		ldr	r0, [r2, #0]
 285              	.LVL29:
 166:syscalls.c    **** 	heap_ptr += nbytes;	/*  Increase heap.  */
 286              		.loc 1 166 0
 287 0110 013080E0 		add	r3, r0, r1
 288              		.loc 1 159 0
 289              		@ lr needed for prologue
 290              		.loc 1 166 0
 291 0114 003082E5 		str	r3, [r2, #0]
 292              	.LVL30:
 167:syscalls.c    **** 	
 168:syscalls.c    **** 	return base;		/*  Return pointer to start of new heap area.  */
 169:syscalls.c    **** }
 293              		.loc 1 169 0
 294 0118 1EFF2FE1 		bx	lr
 295              	.L40:
 296              		.align	2
 297              	.L39:
 298 011c 00000000 		.word	heap_ptr
 299 0120 00000000 		.word	end
 300              	.LFE299:
 302              		.bss
 303              		.align	2
 304              	heap_ptr:
 305 0000 00000000 		.space	4
 412              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 syscalls.c
     /tmp/cchttNb9.s:12     .text:00000000 my_putc
     /tmp/cchttNb9.s:22     .text:00000000 $a
     /tmp/cchttNb9.s:50     .text:00000024 _read_r
     /tmp/cchttNb9.s:136    .text:0000008c _write_r
     /tmp/cchttNb9.s:184    .text:000000d0 _close_r
     /tmp/cchttNb9.s:204    .text:000000d8 _lseek_r
     /tmp/cchttNb9.s:224    .text:000000e0 _fstat_r
     /tmp/cchttNb9.s:248    .text:000000f0 isatty
     /tmp/cchttNb9.s:268    .text:000000f8 _sbrk_r
     /tmp/cchttNb9.s:298    .text:0000011c $d
     /tmp/cchttNb9.s:304    .bss:00000000 heap_ptr

UNDEFINED SYMBOLS
end
