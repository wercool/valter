   1              		.file	"main.c"
   9              	.Ltext0:
  10              		.align	2
  12              	AT91F_AIC_ConfigureIt:
  13              	.LFB2:
  14              		.file 1 "lib_AT91SAM7S64.h"
   1:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   2:lib_AT91SAM7S64.h **** //*         ATMEL Microcontroller Software Support  -  ROUSSET  -
   3:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   4:lib_AT91SAM7S64.h **** //* DISCLAIMER:  THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR
   5:lib_AT91SAM7S64.h **** //* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
   6:lib_AT91SAM7S64.h **** //* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
   7:lib_AT91SAM7S64.h **** //* DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT, INDIRECT,
   8:lib_AT91SAM7S64.h **** //* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   9:lib_AT91SAM7S64.h **** //* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
  10:lib_AT91SAM7S64.h **** //* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  11:lib_AT91SAM7S64.h **** //* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  12:lib_AT91SAM7S64.h **** //* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
  13:lib_AT91SAM7S64.h **** //* EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  14:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  15:lib_AT91SAM7S64.h **** //* File Name           : lib_AT91SAM7S64.h
  16:lib_AT91SAM7S64.h **** //* Object              : AT91SAM7S64 inlined functions
  17:lib_AT91SAM7S64.h **** //* Generated           : AT91 SW Application Group  08/30/2005 (15:52:59)
  18:lib_AT91SAM7S64.h **** //*
  19:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_dbgu.h/1.1/Thu Aug 25 12:56:22 2005//
  20:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pmc_SAM7S.h/1.4/Tue Aug 30 13:00:43 2005//
  21:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_VREG_6085B.h/1.1/Tue Feb  1 16:20:47 2005//
  22:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rstc_6098A.h/1.1/Wed Oct  6 10:39:20 2004//
  23:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_ssc.h/1.4/Fri Jan 31 12:19:20 2003//
  24:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_wdtc_6080A.h/1.1/Wed Oct  6 10:38:30 2004//
  25:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_usart.h/1.5/Thu Nov 21 16:01:54 2002//
  26:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_spi2.h/1.2/Tue Aug 23 15:37:28 2005//
  27:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pitc_6079A.h/1.2/Tue Nov  9 14:43:56 2004//
  28:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_aic_6075b.h/1.2/Thu Jul  7 07:48:22 2005//
  29:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_twi.h/1.3/Mon Jul 19 14:27:58 2004//
  30:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_adc.h/1.6/Fri Oct 17 09:12:38 2003//
  31:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rttc_6081A.h/1.1/Wed Oct  6 10:39:38 2004//
  32:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_udp.h/1.5/Tue Aug 30 12:13:47 2005//
  33:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_tc_1753b.h/1.1/Fri Jan 31 12:20:02 2003//
  34:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_MC_SAM7S.h/1.1/Thu Mar 25 15:19:14 2004//
  35:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pio.h/1.3/Fri Jan 31 12:18:56 2003//
  36:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_PWM_SAM.h/1.3/Thu Jan 22 10:10:50 2004//
  37:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pdc.h/1.2/Tue Jul  2 13:29:40 2002//
  38:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  39:lib_AT91SAM7S64.h **** 
  40:lib_AT91SAM7S64.h **** #ifndef lib_AT91SAM7S64_H
  41:lib_AT91SAM7S64.h **** #define lib_AT91SAM7S64_H
  42:lib_AT91SAM7S64.h **** 
  43:lib_AT91SAM7S64.h **** /* *****************************************************************************
  44:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR AIC
  45:lib_AT91SAM7S64.h ****    ***************************************************************************** */
  46:lib_AT91SAM7S64.h **** #define AT91C_AIC_BRANCH_OPCODE ((void (*) ()) 0xE51FFF20) // ldr, pc, [pc, #-&F20]
  47:lib_AT91SAM7S64.h **** 
  48:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  49:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ConfigureIt
  50:lib_AT91SAM7S64.h **** //* \brief Interrupt Handler Initialization
  51:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  52:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_AIC_ConfigureIt (
  53:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,  // \arg pointer to the AIC registers
  54:lib_AT91SAM7S64.h **** 	unsigned int irq_id,     // \arg interrupt number to initialize
  55:lib_AT91SAM7S64.h **** 	unsigned int priority,   // \arg priority to give to the interrupt
  56:lib_AT91SAM7S64.h **** 	unsigned int src_type,   // \arg activation and sense of activation
  57:lib_AT91SAM7S64.h **** 	void (*newHandler) () ) // \arg address of the interrupt handler
  58:lib_AT91SAM7S64.h **** {
  15              		.loc 1 58 0
  16              		@ Function supports interworking.
  17              		@ args = 4, pretend = 0, frame = 0
  18              		@ frame_needed = 0, uses_anonymous_args = 0
  19              	.LVL0:
  59:lib_AT91SAM7S64.h **** 	unsigned int oldHandler;
  60:lib_AT91SAM7S64.h ****     unsigned int mask ;
  61:lib_AT91SAM7S64.h **** 
  62:lib_AT91SAM7S64.h ****     oldHandler = pAic->AIC_SVR[irq_id];
  63:lib_AT91SAM7S64.h **** 
  64:lib_AT91SAM7S64.h ****     mask = 0x1 << irq_id ;
  20              		.loc 1 64 0
  21 0000 01C0A0E3 		mov	ip, #1
  22 0004 1CC1A0E1 		mov	ip, ip, asl r1
  23              	.LVL1:
  24              		.loc 1 58 0
  25 0008 10402DE9 		stmfd	sp!, {r4, lr}
  26              	.LCFI0:
  27              		.loc 1 62 0
  28 000c 01E180E0 		add	lr, r0, r1, asl #2
  29 0010 80409EE5 		ldr	r4, [lr, #128]
  30              	.LVL2:
  65:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  66:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
  67:lib_AT91SAM7S64.h ****     //* Save the interrupt handler routine pointer and the interrupt priority
  68:lib_AT91SAM7S64.h ****     pAic->AIC_SVR[irq_id] = (unsigned int) newHandler ;
  69:lib_AT91SAM7S64.h ****     //* Store the Source Mode Register
  70:lib_AT91SAM7S64.h ****     pAic->AIC_SMR[irq_id] = src_type | priority  ;
  31              		.loc 1 70 0
  32 0014 023083E1 		orr	r3, r3, r2
  33              	.LVL3:
  34              		.loc 1 68 0
  35 0018 08209DE5 		ldr	r2, [sp, #8]
  36              	.LVL4:
  37              		.loc 1 66 0
  38 001c 24C180E5 		str	ip, [r0, #292]
  39              		.loc 1 68 0
  40 0020 80208EE5 		str	r2, [lr, #128]
  41              		.loc 1 70 0
  42 0024 013180E7 		str	r3, [r0, r1, asl #2]
  71:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the interrupt controller
  72:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
  43              		.loc 1 72 0
  44 0028 28C180E5 		str	ip, [r0, #296]
  73:lib_AT91SAM7S64.h **** 
  74:lib_AT91SAM7S64.h **** 	return oldHandler;
  75:lib_AT91SAM7S64.h **** }
  45              		.loc 1 75 0
  46 002c 0400A0E1 		mov	r0, r4
  47              	.LVL5:
  48 0030 1040BDE8 		ldmfd	sp!, {r4, lr}
  49 0034 1EFF2FE1 		bx	lr
  50              	.LFE2:
  52              		.align	2
  53              		.global	IRQ0Handler
  55              	IRQ0Handler:
  56              	.LFB290:
  57              		.file 2 "main.c"
   1:main.c        **** #include <stdint.h>
   2:main.c        **** #include <stdio.h>
   3:main.c        **** #include <string.h>
   4:main.c        **** #include <stdlib.h>
   5:main.c        **** 
   6:main.c        **** #include "Board.h"
   7:main.c        **** #include "cdc_enumerate.h"
   8:main.c        **** #include "adc.h"
   9:main.c        **** #include "pwm.h"
  10:main.c        **** #include "aic.h"
  11:main.c        **** #include "async.h"
  12:main.c        **** #include "delay.h"
  13:main.c        **** 
  14:main.c        **** #define FIQ_INTERRUPT_LEVEL 0
  15:main.c        **** 
  16:main.c        **** 
  17:main.c        **** //*----------------------------------------------------------------------------
  18:main.c        **** //* Function Name       : IRQ0Handler
  19:main.c        **** //* Object              : Interrupt Handler called by the IRQ0 interrupt with AT91
  20:main.c        **** //*                       compatibility
  21:main.c        **** //*----------------------------------------------------------------------------
  22:main.c        **** __ramfunc void IRQ0Handler(void)
  23:main.c        **** {
  58              		.loc 2 23 0
  59              		@ Function supports interworking.
  60              		@ args = 0, pretend = 0, frame = 0
  61              		@ frame_needed = 0, uses_anonymous_args = 0
  62              		@ link register save eliminated.
  63              		@ lr needed for prologue
  24:main.c        **** 
  25:main.c        **** }
  64              		.loc 2 25 0
  65 0038 1EFF2FE1 		bx	lr
  66              	.LFE290:
  68              		.align	2
  69              		.global	IRQ1Handler
  71              	IRQ1Handler:
  72              	.LFB291:
  26:main.c        **** 
  27:main.c        **** 
  28:main.c        **** //*----------------------------------------------------------------------------
  29:main.c        **** //* Function Name       : IRQ0Handler
  30:main.c        **** //* Object              : Interrupt Handler called by the IRQ1 interrupt with AT91
  31:main.c        **** //*                       compatibility
  32:main.c        **** //*----------------------------------------------------------------------------
  33:main.c        **** __ramfunc void IRQ1Handler(void)
  34:main.c        **** {
  73              		.loc 2 34 0
  74              		@ Function supports interworking.
  75              		@ args = 0, pretend = 0, frame = 0
  76              		@ frame_needed = 0, uses_anonymous_args = 0
  77              		@ link register save eliminated.
  78              		@ lr needed for prologue
  35:main.c        **** 
  36:main.c        **** }
  79              		.loc 2 36 0
  80 003c 1EFF2FE1 		bx	lr
  81              	.LFE291:
  83              		.align	2
  84              		.global	FIQHandler
  86              	FIQHandler:
  87              	.LFB292:
  37:main.c        **** 
  38:main.c        **** 
  39:main.c        **** //*----------------------------------------------------------------------------
  40:main.c        **** //* Function Name       : FIQHandler
  41:main.c        **** //* Object              : Interrupt Handler called by the FIQ interrupt with AT91
  42:main.c        **** //*                       compatibility
  43:main.c        **** //*----------------------------------------------------------------------------
  44:main.c        **** __ramfunc void FIQHandler(void)
  45:main.c        **** {
  88              		.loc 2 45 0
  89              		@ Function supports interworking.
  90              		@ args = 0, pretend = 0, frame = 0
  91              		@ frame_needed = 0, uses_anonymous_args = 0
  92              		@ link register save eliminated.
  93              		@ lr needed for prologue
  46:main.c        **** 
  47:main.c        **** }
  94              		.loc 2 47 0
  95 0040 1EFF2FE1 		bx	lr
  96              	.LFE292:
  98              		.align	2
  99              		.global	getCDCMEssage
 101              	getCDCMEssage:
 102              	.LFB294:
  48:main.c        **** 
  49:main.c        **** 
  50:main.c        **** /*
  51:main.c        ****  *  CDC Functions
  52:main.c        ****  */
  53:main.c        **** 
  54:main.c        **** struct _AT91S_CDC               pCDC;
  55:main.c        **** //*----------------------------------------------------------------------------
  56:main.c        **** //* function     AT91F_USB_Open
  57:main.c        **** //*              This function Open the USB device
  58:main.c        **** //*----------------------------------------------------------------------------
  59:main.c        **** void AT91FUSBOpen(void)
  60:main.c        **** {
  61:main.c        ****     // Set the PLL USB Divider
  62:main.c        ****     AT91C_BASE_CKGR->CKGR_PLLR |= AT91C_CKGR_USBDIV_1 ;
  63:main.c        **** 
  64:main.c        ****     // Specific Chip USB Initialization
  65:main.c        ****     // Enables the 48MHz USB clock UDPCK and System Peripheral USB Clock
  66:main.c        ****     AT91C_BASE_PMC->PMC_SCER = AT91C_PMC_UDP;
  67:main.c        ****     AT91C_BASE_PMC->PMC_PCER = (1 << AT91C_ID_UDP);
  68:main.c        **** 
  69:main.c        ****     // Enable UDP PullUp (USB_DP_PUP) : enable & Clear of the corresponding PIO
  70:main.c        ****     // Set in PIO mode and Configure in Output
  71:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA16);
  72:main.c        ****     // Clear for set the Pull up resistor
  73:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA16);
  74:main.c        **** 
  75:main.c        ****     // CDC Open by structure initialization
  76:main.c        ****     AT91F_CDC_Open(&pCDC, AT91C_BASE_UDP);
  77:main.c        **** }
  78:main.c        **** 
  79:main.c        **** #define CDC_MSG_SIZE            512
  80:main.c        **** 
  81:main.c        **** char *msg[CDC_MSG_SIZE];
  82:main.c        **** char *cmd[CDC_MSG_SIZE];
  83:main.c        **** /*
  84:main.c        ****  * Structure to keep CDC message
  85:main.c        ****  */
  86:main.c        **** struct cdcMessage
  87:main.c        **** {
  88:main.c        ****     unsigned char data[CDC_MSG_SIZE];
  89:main.c        ****     unsigned int length;
  90:main.c        **** };
  91:main.c        **** 
  92:main.c        **** /*
  93:main.c        ****  *  Fill-in CDC Message Structure
  94:main.c        ****  */
  95:main.c        **** struct cdcMessage getCDCMEssage(void)
  96:main.c        **** {
 103              		.loc 2 96 0
 104              		@ Function supports interworking.
 105              		@ args = 0, pretend = 0, frame = 516
 106              		@ frame_needed = 0, uses_anonymous_args = 0
 107 0044 30402DE9 		stmfd	sp!, {r4, r5, lr}
 108              	.LCFI1:
 109 0048 0020A0E3 		mov	r2, #0
 110              	.LVL6:
 111 004c 81DF4DE2 		sub	sp, sp, #516
 112              	.LCFI2:
 113              		.loc 2 96 0
 114 0050 0050A0E1 		mov	r5, r0
 115              	.L10:
 116              	.LBB2:
  97:main.c        ****     struct cdcMessage cdcMessageObj;
  98:main.c        **** 
  99:main.c        ****     for(int r = 0; r < CDC_MSG_SIZE; r++)
 100:main.c        ****     {
 101:main.c        ****         cdcMessageObj.data[r] = '\0';
 117              		.loc 2 101 0
 118 0054 0030A0E3 		mov	r3, #0
 119 0058 0D30C2E7 		strb	r3, [r2, sp]
 120              		.loc 2 99 0
 121 005c 012082E2 		add	r2, r2, #1
 122 0060 020C52E3 		cmp	r2, #512
 123              	.LBE2:
 124              		.loc 2 96 0
 125 0064 0D40A0E1 		mov	r4, sp
 126              	.LBB3:
 127              		.loc 2 99 0
 128 0068 1300001A 		bne	.L10
 129              	.LBE3:
 102:main.c        ****     }
 103:main.c        **** 
 104:main.c        ****     cdcMessageObj.length = pCDC.Read(&pCDC, (char *)cdcMessageObj.data, CDC_MSG_SIZE);
 130              		.loc 2 104 0
 131 006c 34309FE5 		ldr	r3, .L15
 132 0070 0D10A0E1 		mov	r1, sp
 133 0074 0300A0E1 		mov	r0, r3
 134 0078 14C093E5 		ldr	ip, [r3, #20]
 135 007c 0FE0A0E1 		mov	lr, pc
 136 0080 1CFF2FE1 		bx	ip
 137              	.LVL7:
 105:main.c        **** 
 106:main.c        ****     return cdcMessageObj;
 138              		.loc 2 106 0
 139 0084 0D10A0E1 		mov	r1, sp
 140              		.loc 2 104 0
 141 0088 00028DE5 		str	r0, [sp, #512]
 142              		.loc 2 106 0
 143 008c 812FA0E3 		mov	r2, #516
 144 0090 0500A0E1 		mov	r0, r5
 145 0094 FEFFFFEB 		bl	memcpy
 107:main.c        **** }
 146              		.loc 2 107 0
 147 0098 0500A0E1 		mov	r0, r5
 148 009c 81DF8DE2 		add	sp, sp, #516
 149 00a0 3040BDE8 		ldmfd	sp!, {r4, r5, lr}
 150 00a4 1EFF2FE1 		bx	lr
 151              	.L16:
 152              		.align	2
 153              	.L15:
 154 00a8 00000000 		.word	pCDC
 155              	.LFE294:
 157              		.align	2
 158              		.global	AT91FUSBOpen
 160              	AT91FUSBOpen:
 161              	.LFB293:
 162              		.loc 2 60 0
 163              		@ Function supports interworking.
 164              		@ args = 0, pretend = 0, frame = 0
 165              		@ frame_needed = 0, uses_anonymous_args = 0
 166              		.loc 2 62 0
 167 00ac 032CE0E3 		mvn	r2, #768
 168 00b0 D33012E5 		ldr	r3, [r2, #-211]
 169 00b4 013283E3 		orr	r3, r3, #268435456
 170 00b8 D33002E5 		str	r3, [r2, #-211]
 171              		.loc 2 66 0
 172 00bc 8030A0E3 		mov	r3, #128
 173 00c0 FF3002E5 		str	r3, [r2, #-255]
 174              	.LBB8:
 175              	.LBB9:
  76:lib_AT91SAM7S64.h **** 
  77:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  78:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_EnableIt
  79:lib_AT91SAM7S64.h **** //* \brief Enable corresponding IT number
  80:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  81:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_EnableIt (
  82:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  83:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  84:lib_AT91SAM7S64.h **** {
  85:lib_AT91SAM7S64.h ****     //* Enable the interrupt on the interrupt controller
  86:lib_AT91SAM7S64.h ****     pAic->AIC_IECR = 0x1 << irq_id ;
  87:lib_AT91SAM7S64.h **** }
  88:lib_AT91SAM7S64.h **** 
  89:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  90:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_DisableIt
  91:lib_AT91SAM7S64.h **** //* \brief Disable corresponding IT number
  92:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  93:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_DisableIt (
  94:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  95:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  96:lib_AT91SAM7S64.h **** {
  97:lib_AT91SAM7S64.h ****     unsigned int mask = 0x1 << irq_id;
  98:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  99:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
 100:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 101:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
 102:lib_AT91SAM7S64.h **** }
 103:lib_AT91SAM7S64.h **** 
 104:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 105:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ClearIt
 106:lib_AT91SAM7S64.h **** //* \brief Clear corresponding IT number
 107:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 108:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_ClearIt (
 109:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 110:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number to initialize
 111:lib_AT91SAM7S64.h **** {
 112:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 113:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = (0x1 << irq_id);
 114:lib_AT91SAM7S64.h **** }
 115:lib_AT91SAM7S64.h **** 
 116:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 117:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_AcknowledgeIt
 118:lib_AT91SAM7S64.h **** //* \brief Acknowledge corresponding IT number
 119:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 120:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_AcknowledgeIt (
 121:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic)     // \arg pointer to the AIC registers
 122:lib_AT91SAM7S64.h **** {
 123:lib_AT91SAM7S64.h ****     pAic->AIC_EOICR = pAic->AIC_EOICR;
 124:lib_AT91SAM7S64.h **** }
 125:lib_AT91SAM7S64.h **** 
 126:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 127:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_SetExceptionVector
 128:lib_AT91SAM7S64.h **** //* \brief Configure vector handler
 129:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 130:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_SetExceptionVector (
 131:lib_AT91SAM7S64.h **** 	unsigned int *pVector, // \arg pointer to the AIC registers
 132:lib_AT91SAM7S64.h **** 	void (*Handler) () )   // \arg Interrupt Handler
 133:lib_AT91SAM7S64.h **** {
 134:lib_AT91SAM7S64.h **** 	unsigned int oldVector = *pVector;
 135:lib_AT91SAM7S64.h **** 
 136:lib_AT91SAM7S64.h **** 	if ((unsigned int) Handler == (unsigned int) AT91C_AIC_BRANCH_OPCODE)
 137:lib_AT91SAM7S64.h **** 		*pVector = (unsigned int) AT91C_AIC_BRANCH_OPCODE;
 138:lib_AT91SAM7S64.h **** 	else
 139:lib_AT91SAM7S64.h **** 		*pVector = (((((unsigned int) Handler) - ((unsigned int) pVector) - 0x8) >> 2) & 0x00FFFFFF) | 0x
 140:lib_AT91SAM7S64.h **** 
 141:lib_AT91SAM7S64.h **** 	return oldVector;
 142:lib_AT91SAM7S64.h **** }
 143:lib_AT91SAM7S64.h **** 
 144:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 145:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Trig
 146:lib_AT91SAM7S64.h **** //* \brief Trig an IT
 147:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 148:lib_AT91SAM7S64.h **** __inline void  AT91F_AIC_Trig (
 149:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 150:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number
 151:lib_AT91SAM7S64.h **** {
 152:lib_AT91SAM7S64.h **** 	pAic->AIC_ISCR = (0x1 << irq_id) ;
 153:lib_AT91SAM7S64.h **** }
 154:lib_AT91SAM7S64.h **** 
 155:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 156:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsActive
 157:lib_AT91SAM7S64.h **** //* \brief Test if an IT is active
 158:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 159:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsActive (
 160:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 161:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 162:lib_AT91SAM7S64.h **** {
 163:lib_AT91SAM7S64.h **** 	return (pAic->AIC_ISR & (0x1 << irq_id));
 164:lib_AT91SAM7S64.h **** }
 165:lib_AT91SAM7S64.h **** 
 166:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 167:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsPending
 168:lib_AT91SAM7S64.h **** //* \brief Test if an IT is pending
 169:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 170:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsPending (
 171:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 172:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 173:lib_AT91SAM7S64.h **** {
 174:lib_AT91SAM7S64.h **** 	return (pAic->AIC_IPR & (0x1 << irq_id));
 175:lib_AT91SAM7S64.h **** }
 176:lib_AT91SAM7S64.h **** 
 177:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 178:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Open
 179:lib_AT91SAM7S64.h **** //* \brief Set exception vectors and AIC registers to default values
 180:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 181:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_Open(
 182:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,        // \arg pointer to the AIC registers
 183:lib_AT91SAM7S64.h **** 	void (*IrqHandler) (),  // \arg Default IRQ vector exception
 184:lib_AT91SAM7S64.h **** 	void (*FiqHandler) (),  // \arg Default FIQ vector exception
 185:lib_AT91SAM7S64.h **** 	void (*DefaultHandler)  (), // \arg Default Handler set in ISR
 186:lib_AT91SAM7S64.h **** 	void (*SpuriousHandler) (), // \arg Default Spurious Handler
 187:lib_AT91SAM7S64.h **** 	unsigned int protectMode)   // \arg Debug Control Register
 188:lib_AT91SAM7S64.h **** {
 189:lib_AT91SAM7S64.h **** 	int i;
 190:lib_AT91SAM7S64.h **** 
 191:lib_AT91SAM7S64.h **** 	// Disable all interrupts and set IVR to the default handler
 192:lib_AT91SAM7S64.h **** 	for (i = 0; i < 32; ++i) {
 193:lib_AT91SAM7S64.h **** 		AT91F_AIC_DisableIt(pAic, i);
 194:lib_AT91SAM7S64.h **** 		AT91F_AIC_ConfigureIt(pAic, i, AT91C_AIC_PRIOR_LOWEST, AT91C_AIC_SRCTYPE_HIGH_LEVEL, DefaultHandl
 195:lib_AT91SAM7S64.h **** 	}
 196:lib_AT91SAM7S64.h **** 
 197:lib_AT91SAM7S64.h **** 	// Set the IRQ exception vector
 198:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x18, IrqHandler);
 199:lib_AT91SAM7S64.h **** 	// Set the Fast Interrupt exception vector
 200:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x1C, FiqHandler);
 201:lib_AT91SAM7S64.h **** 
 202:lib_AT91SAM7S64.h **** 	pAic->AIC_SPU = (unsigned int) SpuriousHandler;
 203:lib_AT91SAM7S64.h **** 	pAic->AIC_DCR = protectMode;
 204:lib_AT91SAM7S64.h **** }
 205:lib_AT91SAM7S64.h **** /* *****************************************************************************
 206:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PDC
 207:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 208:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 209:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextRx
 210:lib_AT91SAM7S64.h **** //* \brief Set the next receive transfer descriptor
 211:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 212:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextRx (
 213:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,     // \arg pointer to a PDC controller
 214:lib_AT91SAM7S64.h **** 	char *address,       // \arg address to the next bloc to be received
 215:lib_AT91SAM7S64.h **** 	unsigned int bytes)  // \arg number of bytes to be received
 216:lib_AT91SAM7S64.h **** {
 217:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNPR = (unsigned int) address;
 218:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNCR = bytes;
 219:lib_AT91SAM7S64.h **** }
 220:lib_AT91SAM7S64.h **** 
 221:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 222:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextTx
 223:lib_AT91SAM7S64.h **** //* \brief Set the next transmit transfer descriptor
 224:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 225:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextTx (
 226:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 227:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 228:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 229:lib_AT91SAM7S64.h **** {
 230:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNPR = (unsigned int) address;
 231:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNCR = bytes;
 232:lib_AT91SAM7S64.h **** }
 233:lib_AT91SAM7S64.h **** 
 234:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 235:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetRx
 236:lib_AT91SAM7S64.h **** //* \brief Set the receive transfer descriptor
 237:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 238:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetRx (
 239:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 240:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be received
 241:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be received
 242:lib_AT91SAM7S64.h **** {
 243:lib_AT91SAM7S64.h **** 	pPDC->PDC_RPR = (unsigned int) address;
 244:lib_AT91SAM7S64.h **** 	pPDC->PDC_RCR = bytes;
 245:lib_AT91SAM7S64.h **** }
 246:lib_AT91SAM7S64.h **** 
 247:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 248:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetTx
 249:lib_AT91SAM7S64.h **** //* \brief Set the transmit transfer descriptor
 250:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 251:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetTx (
 252:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 253:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 254:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 255:lib_AT91SAM7S64.h **** {
 256:lib_AT91SAM7S64.h **** 	pPDC->PDC_TPR = (unsigned int) address;
 257:lib_AT91SAM7S64.h **** 	pPDC->PDC_TCR = bytes;
 258:lib_AT91SAM7S64.h **** }
 259:lib_AT91SAM7S64.h **** 
 260:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 261:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableTx
 262:lib_AT91SAM7S64.h **** //* \brief Enable transmit
 263:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 264:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableTx (
 265:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 266:lib_AT91SAM7S64.h **** {
 267:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTEN;
 268:lib_AT91SAM7S64.h **** }
 269:lib_AT91SAM7S64.h **** 
 270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableRx
 272:lib_AT91SAM7S64.h **** //* \brief Enable receive
 273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 274:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableRx (
 275:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 276:lib_AT91SAM7S64.h **** {
 277:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTEN;
 278:lib_AT91SAM7S64.h **** }
 279:lib_AT91SAM7S64.h **** 
 280:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 281:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableTx
 282:lib_AT91SAM7S64.h **** //* \brief Disable transmit
 283:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 284:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableTx (
 285:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 286:lib_AT91SAM7S64.h **** {
 287:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTDIS;
 288:lib_AT91SAM7S64.h **** }
 289:lib_AT91SAM7S64.h **** 
 290:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 291:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableRx
 292:lib_AT91SAM7S64.h **** //* \brief Disable receive
 293:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 294:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableRx (
 295:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 296:lib_AT91SAM7S64.h **** {
 297:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTDIS;
 298:lib_AT91SAM7S64.h **** }
 299:lib_AT91SAM7S64.h **** 
 300:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 301:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsTxEmpty
 302:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been sent
 303:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 304:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsTxEmpty ( // \return return 1 if transfer is complete
 305:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 306:lib_AT91SAM7S64.h **** {
 307:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TCR);
 308:lib_AT91SAM7S64.h **** }
 309:lib_AT91SAM7S64.h **** 
 310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 311:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextTxEmpty
 312:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 314:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextTxEmpty ( // \return return 1 if transfer is complete
 315:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 316:lib_AT91SAM7S64.h **** {
 317:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TNCR);
 318:lib_AT91SAM7S64.h **** }
 319:lib_AT91SAM7S64.h **** 
 320:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 321:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsRxEmpty
 322:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been filled
 323:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 324:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsRxEmpty ( // \return return 1 if transfer is complete
 325:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 326:lib_AT91SAM7S64.h **** {
 327:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RCR);
 328:lib_AT91SAM7S64.h **** }
 329:lib_AT91SAM7S64.h **** 
 330:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 331:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextRxEmpty
 332:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 333:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 334:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextRxEmpty ( // \return return 1 if transfer is complete
 335:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 336:lib_AT91SAM7S64.h **** {
 337:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RNCR);
 338:lib_AT91SAM7S64.h **** }
 339:lib_AT91SAM7S64.h **** 
 340:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 341:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Open
 342:lib_AT91SAM7S64.h **** //* \brief Open PDC: disable TX and RX reset transfer descriptors, re-enable RX and TX
 343:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 344:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Open (
 345:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 346:lib_AT91SAM7S64.h **** {
 347:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 348:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 349:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 350:lib_AT91SAM7S64.h **** 
 351:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 352:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 353:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 354:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 355:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 356:lib_AT91SAM7S64.h **** 
 357:lib_AT91SAM7S64.h ****     //* Enable the RX and TX PDC transfer requests
 358:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableRx(pPDC);
 359:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableTx(pPDC);
 360:lib_AT91SAM7S64.h **** }
 361:lib_AT91SAM7S64.h **** 
 362:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 363:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Close
 364:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 365:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 366:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Close (
 367:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 368:lib_AT91SAM7S64.h **** {
 369:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 370:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 371:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 372:lib_AT91SAM7S64.h **** 
 373:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 374:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 375:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 376:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 377:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 378:lib_AT91SAM7S64.h **** 
 379:lib_AT91SAM7S64.h **** }
 380:lib_AT91SAM7S64.h **** 
 381:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 382:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SendFrame
 383:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 384:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 385:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_SendFrame(
 386:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 387:lib_AT91SAM7S64.h **** 	char *pBuffer,
 388:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 389:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 390:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 391:lib_AT91SAM7S64.h **** {
 392:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsTxEmpty(pPDC)) {
 393:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 394:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetTx(pPDC, pBuffer, szBuffer);
 395:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pNextBuffer, szNextBuffer);
 396:lib_AT91SAM7S64.h **** 		return 2;
 397:lib_AT91SAM7S64.h **** 	}
 398:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextTxEmpty(pPDC)) {
 399:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 400:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pBuffer, szBuffer);
 401:lib_AT91SAM7S64.h **** 		return 1;
 402:lib_AT91SAM7S64.h **** 	}
 403:lib_AT91SAM7S64.h **** 	else {
 404:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 405:lib_AT91SAM7S64.h **** 		return 0;
 406:lib_AT91SAM7S64.h **** 	}
 407:lib_AT91SAM7S64.h **** }
 408:lib_AT91SAM7S64.h **** 
 409:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 410:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_ReceiveFrame
 411:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 412:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 413:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_ReceiveFrame (
 414:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 415:lib_AT91SAM7S64.h **** 	char *pBuffer,
 416:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 417:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 418:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 419:lib_AT91SAM7S64.h **** {
 420:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsRxEmpty(pPDC)) {
 421:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 422:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetRx(pPDC, pBuffer, szBuffer);
 423:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pNextBuffer, szNextBuffer);
 424:lib_AT91SAM7S64.h **** 		return 2;
 425:lib_AT91SAM7S64.h **** 	}
 426:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextRxEmpty(pPDC)) {
 427:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 428:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pBuffer, szBuffer);
 429:lib_AT91SAM7S64.h **** 		return 1;
 430:lib_AT91SAM7S64.h **** 	}
 431:lib_AT91SAM7S64.h **** 	else {
 432:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 433:lib_AT91SAM7S64.h **** 		return 0;
 434:lib_AT91SAM7S64.h **** 	}
 435:lib_AT91SAM7S64.h **** }
 436:lib_AT91SAM7S64.h **** /* *****************************************************************************
 437:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR DBGU
 438:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 439:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 440:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptEnable
 441:lib_AT91SAM7S64.h **** //* \brief Enable DBGU Interrupt
 442:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 443:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptEnable(
 444:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 445:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be enabled
 446:lib_AT91SAM7S64.h **** {
 447:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IER = flag;
 448:lib_AT91SAM7S64.h **** }
 449:lib_AT91SAM7S64.h **** 
 450:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 451:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptDisable
 452:lib_AT91SAM7S64.h **** //* \brief Disable DBGU Interrupt
 453:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 454:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptDisable(
 455:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 456:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be disabled
 457:lib_AT91SAM7S64.h **** {
 458:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IDR = flag;
 459:lib_AT91SAM7S64.h **** }
 460:lib_AT91SAM7S64.h **** 
 461:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 462:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_GetInterruptMaskStatus
 463:lib_AT91SAM7S64.h **** //* \brief Return DBGU Interrupt Mask Status
 464:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 465:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_DBGU_GetInterruptMaskStatus( // \return DBGU Interrupt Mask Status
 466:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu) // \arg  pointer to a DBGU controller
 467:lib_AT91SAM7S64.h **** {
 468:lib_AT91SAM7S64.h ****         return pDbgu->DBGU_IMR;
 469:lib_AT91SAM7S64.h **** }
 470:lib_AT91SAM7S64.h **** 
 471:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 472:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_IsInterruptMasked
 473:lib_AT91SAM7S64.h **** //* \brief Test if DBGU Interrupt is Masked 
 474:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 475:lib_AT91SAM7S64.h **** __inline int AT91F_DBGU_IsInterruptMasked(
 476:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 477:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 478:lib_AT91SAM7S64.h **** {
 479:lib_AT91SAM7S64.h ****         return (AT91F_DBGU_GetInterruptMaskStatus(pDbgu) & flag);
 480:lib_AT91SAM7S64.h **** }
 481:lib_AT91SAM7S64.h **** 
 482:lib_AT91SAM7S64.h **** /* *****************************************************************************
 483:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PIO
 484:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 485:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 486:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPeriph
 487:lib_AT91SAM7S64.h **** //* \brief Enable pins to be drived by peripheral
 488:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 489:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPeriph(
 490:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 491:lib_AT91SAM7S64.h **** 	unsigned int periphAEnable,  // \arg PERIPH A to enable
 492:lib_AT91SAM7S64.h **** 	unsigned int periphBEnable)  // \arg PERIPH B to enable
 493:lib_AT91SAM7S64.h **** 
 494:lib_AT91SAM7S64.h **** {
 495:lib_AT91SAM7S64.h **** 	pPio->PIO_ASR = periphAEnable;
 496:lib_AT91SAM7S64.h **** 	pPio->PIO_BSR = periphBEnable;
 497:lib_AT91SAM7S64.h **** 	pPio->PIO_PDR = (periphAEnable | periphBEnable); // Set in Periph mode
 498:lib_AT91SAM7S64.h **** }
 499:lib_AT91SAM7S64.h **** 
 500:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 501:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOutput
 502:lib_AT91SAM7S64.h **** //* \brief Enable PIO in output mode
 503:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 504:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOutput(
 505:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 506:lib_AT91SAM7S64.h **** 	unsigned int pioEnable)      // \arg PIO to be enabled
 507:lib_AT91SAM7S64.h **** {
 508:lib_AT91SAM7S64.h **** 	pPio->PIO_PER = pioEnable; // Set in PIO mode
 176              		.loc 1 508 0
 177 00c4 01C8A0E3 		mov	ip, #65536
 178              	.LBE9:
 179              	.LBE8:
 180              		.loc 2 60 0
 181 00c8 04E02DE5 		str	lr, [sp, #-4]!
 182              	.LCFI3:
 183              		.loc 2 67 0
 184 00cc 1E3D83E2 		add	r3, r3, #1920
 185              	.LBB10:
 186              	.LBB11:
 187              		.loc 1 508 0
 188 00d0 0BECE0E3 		mvn	lr, #2816
 189              	.LBE11:
 190              	.LBE10:
 191              		.loc 2 67 0
 192 00d4 EF3002E5 		str	r3, [r2, #-239]
 193              		.loc 2 76 0
 194 00d8 18109FE5 		ldr	r1, .L19
 195              	.LBB12:
 196              	.LBB13:
 197              		.loc 1 508 0
 198 00dc FFC00EE5 		str	ip, [lr, #-255]
 199              	.LBE13:
 200              	.LBE12:
 201              		.loc 2 76 0
 202 00e0 14009FE5 		ldr	r0, .L19+4
 203              	.LBB14:
 204              	.LBB15:
 509:lib_AT91SAM7S64.h **** 	pPio->PIO_OER = pioEnable; // Configure in Output
 205              		.loc 1 509 0
 206 00e4 EFC00EE5 		str	ip, [lr, #-239]
 207              	.LBE15:
 208              	.LBE14:
 209              	.LBB16:
 210              	.LBB17:
 510:lib_AT91SAM7S64.h **** }
 511:lib_AT91SAM7S64.h **** 
 512:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 513:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInput
 514:lib_AT91SAM7S64.h **** //* \brief Enable PIO in input mode
 515:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 516:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInput(
 517:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 518:lib_AT91SAM7S64.h **** 	unsigned int inputEnable)      // \arg PIO to be enabled
 519:lib_AT91SAM7S64.h **** {
 520:lib_AT91SAM7S64.h **** 	// Disable output
 521:lib_AT91SAM7S64.h **** 	pPio->PIO_ODR  = inputEnable;
 522:lib_AT91SAM7S64.h **** 	pPio->PIO_PER  = inputEnable;
 523:lib_AT91SAM7S64.h **** }
 524:lib_AT91SAM7S64.h **** 
 525:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 526:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOpendrain
 527:lib_AT91SAM7S64.h **** //* \brief Configure PIO in open drain
 528:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 529:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOpendrain(
 530:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 531:lib_AT91SAM7S64.h **** 	unsigned int multiDrvEnable) // \arg pio to be configured in open drain
 532:lib_AT91SAM7S64.h **** {
 533:lib_AT91SAM7S64.h **** 	// Configure the multi-drive option
 534:lib_AT91SAM7S64.h **** 	pPio->PIO_MDDR = ~multiDrvEnable;
 535:lib_AT91SAM7S64.h **** 	pPio->PIO_MDER = multiDrvEnable;
 536:lib_AT91SAM7S64.h **** }
 537:lib_AT91SAM7S64.h **** 
 538:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 539:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPullup
 540:lib_AT91SAM7S64.h **** //* \brief Enable pullup on PIO
 541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 542:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPullup(
 543:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 544:lib_AT91SAM7S64.h **** 	unsigned int pullupEnable)   // \arg enable pullup on PIO
 545:lib_AT91SAM7S64.h **** {
 546:lib_AT91SAM7S64.h **** 		// Connect or not Pullup
 547:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUDR = ~pullupEnable;
 548:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUER = pullupEnable;
 549:lib_AT91SAM7S64.h **** }
 550:lib_AT91SAM7S64.h **** 
 551:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 552:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgDirectDrive
 553:lib_AT91SAM7S64.h **** //* \brief Enable direct drive on PIO
 554:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 555:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgDirectDrive(
 556:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 557:lib_AT91SAM7S64.h **** 	unsigned int directDrive)    // \arg PIO to be configured with direct drive
 558:lib_AT91SAM7S64.h **** 
 559:lib_AT91SAM7S64.h **** {
 560:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 561:lib_AT91SAM7S64.h **** 	pPio->PIO_OWDR  = ~directDrive;
 562:lib_AT91SAM7S64.h **** 	pPio->PIO_OWER  = directDrive;
 563:lib_AT91SAM7S64.h **** }
 564:lib_AT91SAM7S64.h **** 
 565:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 566:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInputFilter
 567:lib_AT91SAM7S64.h **** //* \brief Enable input filter on input PIO
 568:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 569:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInputFilter(
 570:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 571:lib_AT91SAM7S64.h **** 	unsigned int inputFilter)    // \arg PIO to be configured with input filter
 572:lib_AT91SAM7S64.h **** 
 573:lib_AT91SAM7S64.h **** {
 574:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 575:lib_AT91SAM7S64.h **** 	pPio->PIO_IFDR  = ~inputFilter;
 576:lib_AT91SAM7S64.h **** 	pPio->PIO_IFER  = inputFilter;
 577:lib_AT91SAM7S64.h **** }
 578:lib_AT91SAM7S64.h **** 
 579:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 580:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInput
 581:lib_AT91SAM7S64.h **** //* \brief Return PIO input value
 582:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 583:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInput( // \return PIO input
 584:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 585:lib_AT91SAM7S64.h **** {
 586:lib_AT91SAM7S64.h **** 	return pPio->PIO_PDSR;
 587:lib_AT91SAM7S64.h **** }
 588:lib_AT91SAM7S64.h **** 
 589:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 590:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputSet
 591:lib_AT91SAM7S64.h **** //* \brief Test if PIO is input flag is active
 592:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 593:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputSet(
 594:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 595:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  flag to be tested
 596:lib_AT91SAM7S64.h **** {
 597:lib_AT91SAM7S64.h **** 	return (AT91F_PIO_GetInput(pPio) & flag);
 598:lib_AT91SAM7S64.h **** }
 599:lib_AT91SAM7S64.h **** 
 600:lib_AT91SAM7S64.h **** 
 601:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 602:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_SetOutput
 603:lib_AT91SAM7S64.h **** //* \brief Set to 1 output PIO
 604:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 605:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_SetOutput(
 606:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 607:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be set
 608:lib_AT91SAM7S64.h **** {
 609:lib_AT91SAM7S64.h **** 	pPio->PIO_SODR = flag;
 610:lib_AT91SAM7S64.h **** }
 611:lib_AT91SAM7S64.h **** 
 612:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 613:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ClearOutput
 614:lib_AT91SAM7S64.h **** //* \brief Set to 0 output PIO
 615:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 616:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ClearOutput(
 617:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 618:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be cleared
 619:lib_AT91SAM7S64.h **** {
 620:lib_AT91SAM7S64.h **** 	pPio->PIO_CODR = flag;
 211              		.loc 1 620 0
 212 00e8 CBC00EE5 		str	ip, [lr, #-203]
 213              	.LBE17:
 214              	.LBE16:
 215              		.loc 2 76 0
 216 00ec FEFFFFEB 		bl	AT91F_CDC_Open
 217              		.loc 2 77 0
 218 00f0 04E09DE4 		ldr	lr, [sp], #4
 219 00f4 1EFF2FE1 		bx	lr
 220              	.L20:
 221              		.align	2
 222              	.L19:
 223 00f8 0000FBFF 		.word	-327680
 224 00fc 00000000 		.word	pCDC
 225              	.LFE293:
 227              		.align	2
 229              	InitPIO:
 230              	.LFB296:
 108:main.c        **** 
 109:main.c        **** static void InitPWM(void)
 110:main.c        **** {
 111:main.c        ****     // enable PWM peripherals on PA0, PA1, PA2
 112:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PA0_PWM0, 0);
 113:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PA1_PWM1, 0);
 114:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PA2_PWM2, 0);
 115:main.c        **** 
 116:main.c        ****     AT91F_PWMC_InterruptDisable(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 117:main.c        ****     AT91F_PWMC_InterruptDisable(AT91C_BASE_PWMC, AT91C_PWMC_CHID1);
 118:main.c        ****     AT91F_PWMC_InterruptDisable(AT91C_BASE_PWMC, AT91C_PWMC_CHID2);
 119:main.c        **** 
 120:main.c        ****     AT91F_PMC_EnablePeriphClock( AT91C_BASE_PMC, 1 << AT91C_ID_PIOA);
 121:main.c        **** 
 122:main.c        ****     // enable PWM clock in PMC
 123:main.c        ****     AT91F_PWMC_CfgPMC();
 124:main.c        **** 
 125:main.c        ****     // disable PWM channels 0, 1, 2
 126:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 127:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID1);
 128:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID2);
 129:main.c        **** 
 130:main.c        ****     pwmFreqSet(0, 8000);
 131:main.c        ****     pwmFreqSet(1, 8000);
 132:main.c        ****     pwmFreqSet(2, 8000);
 133:main.c        **** 
 134:main.c        ****     pwmDutySet_u8(0, 1);
 135:main.c        ****     pwmDutySet_u8(1, 1);
 136:main.c        ****     pwmDutySet_u8(2, 1);
 137:main.c        **** 
 138:main.c        ****     AT91F_PWMC_UpdateChannel(AT91C_BASE_PWMC, 0, AT91C_PWMC_CHID0);
 139:main.c        ****     AT91F_PWMC_UpdateChannel(AT91C_BASE_PWMC, 1, AT91C_PWMC_CHID1);
 140:main.c        ****     AT91F_PWMC_UpdateChannel(AT91C_BASE_PWMC, 2, AT91C_PWMC_CHID2);
 141:main.c        **** 
 142:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 143:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID1);
 144:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID2);
 145:main.c        **** 
 146:main.c        ****     // enable PWM channels 0, 1, 2
 147:main.c        ****     //AT91F_PWMC_StartChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 148:main.c        ****     //AT91F_PWMC_StartChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID1);
 149:main.c        ****     //AT91F_PWMC_StartChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID2);
 150:main.c        **** }
 151:main.c        **** 
 152:main.c        **** static void InitPIO(void)
 153:main.c        **** {
 231              		.loc 2 153 0
 232              		@ Function supports interworking.
 233              		@ args = 0, pretend = 0, frame = 0
 234              		@ frame_needed = 0, uses_anonymous_args = 0
 235              	.LBB96:
 236              	.LBB97:
 237              		.loc 1 508 0
 238 0100 0B3CE0E3 		mvn	r3, #2816
 239              	.LBE97:
 240              	.LBE96:
 241              		.loc 2 153 0
 242 0104 F04F2DE9 		stmfd	sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
 243              	.LCFI4:
 244              	.LBB98:
 245              	.LBB99:
 246              		.loc 1 508 0
 247 0108 8020A0E3 		mov	r2, #128
 248              	.LBE99:
 249              	.LBE98:
 250              	.LBB100:
 251              	.LBB101:
 252 010c 0113A0E3 		mov	r1, #67108864
 253              	.LBE101:
 254              	.LBE100:
 255              	.LBB102:
 256              	.LBB103:
 257 0110 0203A0E3 		mov	r0, #134217728
 258              	.LBE103:
 259              	.LBE102:
 260              	.LBB104:
 261              	.LBB105:
 262 0114 01C2A0E3 		mov	ip, #268435456
 263              	.LBE105:
 264              	.LBE104:
 265              	.LBB106:
 266              	.LBB107:
 267 0118 02E2A0E3 		mov	lr, #536870912
 268              	.LBE107:
 269              	.LBE106:
 270              	.LBB108:
 271              	.LBB109:
 272 011c FF2003E5 		str	r2, [r3, #-255]
 273              	.LBE109:
 274              	.LBE108:
 275              	.LBB110:
 276              	.LBB111:
 277 0120 0140A0E3 		mov	r4, #1
 278              	.LBE111:
 279              	.LBE110:
 280              	.LBB112:
 281              	.LBB113:
 282              		.loc 1 509 0
 283 0124 EF2003E5 		str	r2, [r3, #-239]
 284              	.LBE113:
 285              	.LBE112:
 286              	.LBB114:
 287              	.LBB115:
 288              		.loc 1 508 0
 289 0128 0250A0E3 		mov	r5, #2
 290              	.LBE115:
 291              	.LBE114:
 292              	.LBB116:
 293              	.LBB117:
 294 012c FF1003E5 		str	r1, [r3, #-255]
 295              	.LBE117:
 296              	.LBE116:
 297              	.LBB118:
 298              	.LBB119:
 299 0130 0460A0E3 		mov	r6, #4
 300              	.LBE119:
 301              	.LBE118:
 302              	.LBB120:
 303              	.LBB121:
 304              		.loc 1 509 0
 305 0134 EF1003E5 		str	r1, [r3, #-239]
 306              	.LBE121:
 307              	.LBE120:
 308              	.LBB122:
 309              	.LBB123:
 310              		.loc 1 508 0
 311 0138 2070A0E3 		mov	r7, #32
 312              	.LBE123:
 313              	.LBE122:
 314              	.LBB124:
 315              	.LBB125:
 316 013c FF0003E5 		str	r0, [r3, #-255]
 317              	.LBE125:
 318              	.LBE124:
 319              	.LBB126:
 320              	.LBB127:
 321 0140 4080A0E3 		mov	r8, #64
 322              	.LBE127:
 323              	.LBE126:
 324              	.LBB128:
 325              	.LBB129:
 326              		.loc 1 509 0
 327 0144 EF0003E5 		str	r0, [r3, #-239]
 328              	.LBE129:
 329              	.LBE128:
 330              	.LBB130:
 331              	.LBB131:
 332              		.loc 1 521 0
 333 0148 0196A0E3 		mov	r9, #1048576
 334              	.LBE131:
 335              	.LBE130:
 336              	.LBB132:
 337              	.LBB133:
 338              		.loc 1 508 0
 339 014c FFC003E5 		str	ip, [r3, #-255]
 340              	.LBE133:
 341              	.LBE132:
 342              	.LBB134:
 343              	.LBB135:
 344              		.loc 1 521 0
 345 0150 01A1A0E3 		mov	sl, #1073741824
 346              	.LBE135:
 347              	.LBE134:
 348              	.LBB136:
 349              	.LBB137:
 350              		.loc 1 509 0
 351 0154 EFC003E5 		str	ip, [r3, #-239]
 352              	.LBE137:
 353              	.LBE136:
 354              	.LBB138:
 355              	.LBB139:
 356              		.loc 1 508 0
 357 0158 FFE003E5 		str	lr, [r3, #-255]
 358              		.loc 1 509 0
 359 015c EFE003E5 		str	lr, [r3, #-239]
 360              	.LBE139:
 361              	.LBE138:
 362              	.LBB140:
 363              	.LBB141:
 364              		.loc 1 609 0
 365 0160 CF2003E5 		str	r2, [r3, #-207]
 366              	.LBE141:
 367              	.LBE140:
 368              	.LBB142:
 369              	.LBB143:
 370              		.loc 1 508 0
 371 0164 FE2D82E2 		add	r2, r2, #16256
 372              	.LBE143:
 373              	.LBE142:
 374              	.LBB144:
 375              	.LBB145:
 376              		.loc 1 620 0
 377 0168 CB1003E5 		str	r1, [r3, #-203]
 378              	.LBE145:
 379              	.LBE144:
 380              	.LBB146:
 381              	.LBB147:
 382 016c CB0003E5 		str	r0, [r3, #-203]
 383              	.LBE147:
 384              	.LBE146:
 385              	.LBB148:
 386              	.LBB149:
 387 0170 CBC003E5 		str	ip, [r3, #-203]
 388              	.LBE149:
 389              	.LBE148:
 390              	.LBB150:
 391              	.LBB151:
 392 0174 CBE003E5 		str	lr, [r3, #-203]
 393              	.LBE151:
 394              	.LBE150:
 395              	.LBB152:
 396              	.LBB153:
 397              		.loc 1 508 0
 398 0178 FF4003E5 		str	r4, [r3, #-255]
 399              		.loc 1 509 0
 400 017c EF4003E5 		str	r4, [r3, #-239]
 401              	.LBE153:
 402              	.LBE152:
 403              	.LBB154:
 404              	.LBB155:
 405              		.loc 1 508 0
 406 0180 FF5003E5 		str	r5, [r3, #-255]
 407              		.loc 1 509 0
 408 0184 EF5003E5 		str	r5, [r3, #-239]
 409              	.LBE155:
 410              	.LBE154:
 411              	.LBB156:
 412              	.LBB157:
 413              		.loc 1 508 0
 414 0188 FF6003E5 		str	r6, [r3, #-255]
 415              		.loc 1 509 0
 416 018c EF6003E5 		str	r6, [r3, #-239]
 417              	.LBE157:
 418              	.LBE156:
 419              	.LBB158:
 420              	.LBB159:
 421              		.loc 1 620 0
 422 0190 CB4003E5 		str	r4, [r3, #-203]
 423              	.LBE159:
 424              	.LBE158:
 425              	.LBB160:
 426              	.LBB161:
 427 0194 CB5003E5 		str	r5, [r3, #-203]
 428              	.LBE161:
 429              	.LBE160:
 430              	.LBB162:
 431              	.LBB163:
 432 0198 CB6003E5 		str	r6, [r3, #-203]
 433              	.LBE163:
 434              	.LBE162:
 435              	.LBB164:
 436              	.LBB165:
 437              		.loc 1 521 0
 438 019c EB9003E5 		str	r9, [r3, #-235]
 439              		.loc 1 522 0
 440 01a0 FF9003E5 		str	r9, [r3, #-255]
 441              	.LBE165:
 442              	.LBE164:
 443              	.LBB166:
 444              	.LBB167:
 445              		.loc 1 521 0
 446 01a4 EBA003E5 		str	sl, [r3, #-235]
 447              		.loc 1 522 0
 448 01a8 FFA003E5 		str	sl, [r3, #-255]
 449              	.LBE167:
 450              	.LBE166:
 451              	.LBB168:
 452              	.LBB169:
 453              		.loc 1 508 0
 454 01ac FF7003E5 		str	r7, [r3, #-255]
 455              		.loc 1 509 0
 456 01b0 EF7003E5 		str	r7, [r3, #-239]
 457              	.LBE169:
 458              	.LBE168:
 459              	.LBB170:
 460              	.LBB171:
 461              		.loc 1 508 0
 462 01b4 FF8003E5 		str	r8, [r3, #-255]
 463              		.loc 1 509 0
 464 01b8 EF8003E5 		str	r8, [r3, #-239]
 465              	.LBE171:
 466              	.LBE170:
 467              	.LBB172:
 468              	.LBB173:
 469              		.loc 1 620 0
 470 01bc CB7003E5 		str	r7, [r3, #-203]
 471              	.LBE173:
 472              	.LBE172:
 473              	.LBB174:
 474              	.LBB175:
 475 01c0 CB8003E5 		str	r8, [r3, #-203]
 476              	.LBE175:
 477              	.LBE174:
 478              	.LBB176:
 479              	.LBB177:
 480              		.loc 1 508 0
 481 01c4 FF2003E5 		str	r2, [r3, #-255]
 482              		.loc 1 509 0
 483 01c8 EF2003E5 		str	r2, [r3, #-239]
 484              	.LBE177:
 485              	.LBE176:
 486              	.LBB178:
 487              	.LBB179:
 488              		.loc 1 508 0
 489 01cc 022A42E2 		sub	r2, r2, #8192
 490 01d0 FF2003E5 		str	r2, [r3, #-255]
 491              		.loc 1 509 0
 492 01d4 EF2003E5 		str	r2, [r3, #-239]
 493              	.LBE179:
 494              	.LBE178:
 495              	.LBB180:
 496              	.LBB181:
 497              		.loc 1 508 0
 498 01d8 0124A0E3 		mov	r2, #16777216
 499 01dc FF2003E5 		str	r2, [r3, #-255]
 500              		.loc 1 509 0
 501 01e0 EF2003E5 		str	r2, [r3, #-239]
 502              	.LBE181:
 503              	.LBE180:
 504              	.LBB182:
 505              	.LBB183:
 506              		.loc 1 508 0
 507 01e4 022082E0 		add	r2, r2, r2
 508 01e8 FF2003E5 		str	r2, [r3, #-255]
 509              		.loc 1 509 0
 510 01ec EF2003E5 		str	r2, [r3, #-239]
 511              	.LBE183:
 512              	.LBE182:
 513              	.LBB184:
 514              	.LBB185:
 515              		.loc 1 508 0
 516 01f0 012CA0E3 		mov	r2, #256
 517 01f4 FF2003E5 		str	r2, [r3, #-255]
 518              		.loc 1 509 0
 519 01f8 EF2003E5 		str	r2, [r3, #-239]
 520              	.LBE185:
 521              	.LBE184:
 522              	.LBB186:
 523              	.LBB187:
 524              		.loc 1 508 0
 525 01fc 022082E0 		add	r2, r2, r2
 526 0200 FF2003E5 		str	r2, [r3, #-255]
 527              		.loc 1 509 0
 528 0204 EF2003E5 		str	r2, [r3, #-239]
 529              	.LBE187:
 530              	.LBE186:
 531              	.LBB188:
 532              	.LBB189:
 533              		.loc 1 508 0
 534 0208 022C82E2 		add	r2, r2, #512
 535 020c FF2003E5 		str	r2, [r3, #-255]
 536              		.loc 1 509 0
 537 0210 EF2003E5 		str	r2, [r3, #-239]
 538              	.LBE189:
 539              	.LBE188:
 540              	.LBB190:
 541              	.LBB191:
 542              		.loc 1 508 0
 543 0214 032B82E2 		add	r2, r2, #3072
 544 0218 FF2003E5 		str	r2, [r3, #-255]
 545              		.loc 1 509 0
 546 021c EF2003E5 		str	r2, [r3, #-239]
 547              	.LBE191:
 548              	.LBE190:
 549              	.LBB192:
 550              	.LBB193:
 551              		.loc 1 508 0
 552 0220 0221A0E3 		mov	r2, #-2147483648
 553 0224 FF2003E5 		str	r2, [r3, #-255]
 554              	.LBE193:
 555              	.LBE192:
 556              	.LBB194:
 557              	.LBB195:
 558 0228 02BBA0E3 		mov	fp, #2048
 559              	.LBE195:
 560              	.LBE194:
 561              	.LBB196:
 562              	.LBB197:
 563              		.loc 1 509 0
 564 022c EF2003E5 		str	r2, [r3, #-239]
 565              	.LBE197:
 566              	.LBE196:
 567              	.LBB198:
 568              	.LBB199:
 569              		.loc 1 508 0
 570 0230 0128A0E3 		mov	r2, #65536
 571              	.LBE199:
 572              	.LBE198:
 573              	.LBB200:
 574              	.LBB201:
 575 0234 FFB003E5 		str	fp, [r3, #-255]
 576              		.loc 1 509 0
 577 0238 EFB003E5 		str	fp, [r3, #-239]
 578              	.LBE201:
 579              	.LBE200:
 580              	.LBB202:
 581              	.LBB203:
 582              		.loc 1 508 0
 583 023c FF2003E5 		str	r2, [r3, #-255]
 584              		.loc 1 509 0
 585 0240 EF2003E5 		str	r2, [r3, #-239]
 586              	.LBE203:
 587              	.LBE202:
 588              	.LBB204:
 589              	.LBB205:
 590              		.loc 1 508 0
 591 0244 022942E2 		sub	r2, r2, #32768
 592 0248 FF2003E5 		str	r2, [r3, #-255]
 593              		.loc 1 509 0
 594 024c EF2003E5 		str	r2, [r3, #-239]
 595              	.LBE205:
 596              	.LBE204:
 597              	.LBB206:
 598              	.LBB207:
 599              		.loc 1 609 0
 600 0250 072A42E2 		sub	r2, r2, #28672
 601 0254 CF2003E5 		str	r2, [r3, #-207]
 602              	.LBE207:
 603              	.LBE206:
 604              	.LBB208:
 605              	.LBB209:
 606 0258 0221A0E3 		mov	r2, #-2147483648
 607 025c CF2003E5 		str	r2, [r3, #-207]
 608              	.LBE209:
 609              	.LBE208:
 610              	.LBB210:
 611              	.LBB211:
 612 0260 0128A0E3 		mov	r2, #65536
 613              	.LBE211:
 614              	.LBE210:
 615              	.LBB212:
 616              	.LBB213:
 617 0264 CFB003E5 		str	fp, [r3, #-207]
 618              	.LBE213:
 619              	.LBE212:
 620              	.LBB214:
 621              	.LBB215:
 622 0268 CF2003E5 		str	r2, [r3, #-207]
 623              	.LBE215:
 624              	.LBE214:
 625              	.LBB216:
 626              	.LBB217:
 627 026c 022942E2 		sub	r2, r2, #32768
 628 0270 CF2003E5 		str	r2, [r3, #-207]
 629              	.LBE217:
 630              	.LBE216:
 154:main.c        ****     // U2, U3, U4, U8 PIO configuration
 155:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA7);   //U2, U3, U4, U8 EN
 156:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA26);  //U2, U3, U4, U8 A
 157:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA27);  //U2, U3, U4, U8 B
 158:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA28);  //U2, U3, U4, U8 C
 159:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA29);  //U2, U3, U4, U8 D
 160:main.c        **** 
 161:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA7); //U2, U3, U4, U8 EN - HIGH to disable
 162:main.c        **** 
 163:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA26);
 164:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA27);
 165:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA28);
 166:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA29);
 167:main.c        **** 
 168:main.c        ****     // PWM configuration
 169:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA0);  //leftUSSonar  PWM0
 170:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA1);  //rightUSSonar PWM1
 171:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA2);  //usSensors    PWM2
 172:main.c        **** 
 173:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA0);
 174:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA1);
 175:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA2);
 176:main.c        **** 
 177:main.c        ****     // US Sonars configuration
 178:main.c        ****     // US Sonars interrupts
 179:main.c        ****     AT91F_PIO_CfgInput(AT91C_BASE_PIOA, AT91C_PIO_PA20);  // IRQ0
 180:main.c        ****     AT91F_PIO_CfgInput(AT91C_BASE_PIOA, AT91C_PIO_PA30);  // IRQ1
 181:main.c        **** 
 182:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA5); //leftUSSonarTrigger
 183:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA6); //rightUSSonarTrigger
 184:main.c        **** 
 185:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA5);
 186:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA6);
 187:main.c        **** 
 188:main.c        ****     //Input channel 1 configuration
 189:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA14);  //U12 A
 190:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA13);  //U12 B
 191:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA24);  //U12 C
 192:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA25);  //U12 D
 193:main.c        **** 
 194:main.c        ****     // U7 Digital Pot control
 195:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA8);    //U7 INC
 196:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA9);    //U7 U/D
 197:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA10);   //U7 CS
 198:main.c        **** 
 199:main.c        ****     // U9, U10, U11, U13, U14 Shift registers control pins
 200:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA12);   //U9, U10, U11, U13, U14 ST_CP
 201:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA31);   //U9, U10, U11 DS
 202:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA11);   //U9, U10, U11 U7 SH_CP
 203:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA16);   //U13, U14 DS
 204:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA, AT91C_PIO_PA15);   //U13, U14 SH_CP
 205:main.c        **** 
 206:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA12);
 207:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA31);
 208:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA11);
 209:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA16);
 210:main.c        ****     AT91F_PIO_SetOutput(AT91C_BASE_PIOA, AT91C_PIO_PA15);
 211:main.c        **** 
 212:main.c        ****     // disable all pull-ups
 213:main.c        ****     AT91C_BASE_PIOA->PIO_PPUDR = ~0;
 631              		.loc 2 213 0
 632 0274 0020E0E3 		mvn	r2, #0
 633 0278 9F2003E5 		str	r2, [r3, #-159]
 214:main.c        **** }
 634              		.loc 2 214 0
 635 027c F04FBDE8 		ldmfd	sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
 636 0280 1EFF2FE1 		bx	lr
 637              	.LFE296:
 639              		.section	.rodata.str1.4,"aMS",%progbits,1
 640              		.align	2
 641              	.LC0:
 642 0000 4D53473A 		.ascii	"MSG:%s\012\000"
 642      25730A00 
 643              		.align	2
 644              	.LC1:
 645 0008 2300     		.ascii	"#\000"
 646 000a 0000     		.align	2
 647              	.LC2:
 648 000c 44454D4F 		.ascii	"DEMOP\000"
 648      5000
 649 0012 0000     		.align	2
 650              	.LC3:
 651 0014 50415241 		.ascii	"PARALLEL EXECUTION MANIPULATOR DEMO\012\000"
 651      4C4C454C 
 651      20455845 
 651      43555449 
 651      4F4E204D 
 652 0039 000000   		.text
 653              		.align	2
 654              		.global	main
 656              	main:
 657              	.LFB299:
 215:main.c        **** 
 216:main.c        **** static void InitIRQ()
 217:main.c        **** {
 218:main.c        ****     // IRQ0 initialization
 219:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PIO_PA20, 0);
 220:main.c        ****     AT91F_AIC_ConfigureIt(AT91C_BASE_AIC, AT91C_ID_IRQ0, AT91C_AIC_PRIOR_HIGHEST, AT91C_AIC_SRCTYPE
 221:main.c        ****     //AT91F_AIC_EnableIt(AT91C_BASE_AIC, AT91C_ID_IRQ0);
 222:main.c        **** 
 223:main.c        ****     // IRQ1 initialization
 224:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PIO_PA30, 0);
 225:main.c        ****     AT91F_AIC_ConfigureIt(AT91C_BASE_AIC, AT91C_ID_IRQ1, AT91C_AIC_PRIOR_HIGHEST, AT91C_AIC_SRCTYPE
 226:main.c        ****     //AT91F_AIC_EnableIt(AT91C_BASE_AIC, AT91C_ID_IRQ1);
 227:main.c        **** 
 228:main.c        ****     // FIQ initialization
 229:main.c        ****     AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, AT91C_PIO_PA19, 0);
 230:main.c        ****     AT91F_AIC_ConfigureIt(AT91C_BASE_AIC, AT91C_ID_FIQ, FIQ_INTERRUPT_LEVEL, AT91C_AIC_SRCTYPE_POSI
 231:main.c        ****     //AT91F_AIC_EnableIt(AT91C_BASE_AIC, AT91C_ID_FIQ);
 232:main.c        **** }
 233:main.c        **** 
 234:main.c        **** 
 235:main.c        **** //*----------------------------------------------------------------------------
 236:main.c        **** //* Function Name       : DeviceInit
 237:main.c        **** //* Object              : Device peripherals initialization
 238:main.c        **** ///*----------------------------------------------------------------------------
 239:main.c        **** static void DeviceInit(void)
 240:main.c        **** {
 241:main.c        ****     InitPIO();
 242:main.c        **** 
 243:main.c        ****     // Enable User Reset and set its minimal assertion to 960 us
 244:main.c        ****     AT91C_BASE_RSTC->RSTC_RMR = AT91C_RSTC_URSTEN | (0x4 << 8) | (unsigned int)(0xA5 << 24);
 245:main.c        **** 
 246:main.c        ****     // Set-up the PIO
 247:main.c        ****     // First, enable the clock of the PIO and set the LEDs in output
 248:main.c        ****     AT91F_PMC_EnablePeriphClock ( AT91C_BASE_PMC, 1 << AT91C_ID_PIOA );
 249:main.c        **** 
 250:main.c        ****     // Initialize USB device
 251:main.c        ****     AT91FUSBOpen();
 252:main.c        ****     // Wait for the end of enumeration
 253:main.c        ****     while (!pCDC.IsConfigured(&pCDC));
 254:main.c        **** 
 255:main.c        ****     InitPIO();
 256:main.c        ****     InitADC();
 257:main.c        ****     InitPWM();
 258:main.c        ****     InitIRQ();
 259:main.c        **** }
 260:main.c        **** 
 261:main.c        **** 
 262:main.c        **** /*
 263:main.c        ****  * Main Entry Point and Main Loop
 264:main.c        ****  */
 265:main.c        **** int main(void)
 266:main.c        **** {
 658              		.loc 2 266 0
 659              		@ Function supports interworking.
 660              		@ args = 0, pretend = 0, frame = 1032
 661              		@ frame_needed = 0, uses_anonymous_args = 0
 662 0284 F0452DE9 		stmfd	sp!, {r4, r5, r6, r7, r8, sl, lr}
 663              	.LCFI5:
 664 0288 01DB4DE2 		sub	sp, sp, #1024
 665              	.LCFI6:
 666 028c 0CD04DE2 		sub	sp, sp, #12
 667              	.LCFI7:
 668              	.LBB271:
 669              	.LBB272:
 670              		.loc 2 241 0
 671 0290 3E0000EB 		bl	InitPIO
 672              		.loc 2 244 0
 673 0294 3C229FE5 		ldr	r2, .L38
 674 0298 023CE0E3 		mvn	r3, #512
 675 029c F72003E5 		str	r2, [r3, #-247]
 676              	.LBB273:
 677              	.LBB274:
 621:lib_AT91SAM7S64.h **** }
 622:lib_AT91SAM7S64.h **** 
 623:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 624:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ForceOutput
 625:lib_AT91SAM7S64.h **** //* \brief Force output when Direct drive option is enabled
 626:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 627:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ForceOutput(
 628:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 629:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be forced
 630:lib_AT91SAM7S64.h **** {
 631:lib_AT91SAM7S64.h **** 	pPio->PIO_ODSR = flag;
 632:lib_AT91SAM7S64.h **** }
 633:lib_AT91SAM7S64.h **** 
 634:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 635:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Enable
 636:lib_AT91SAM7S64.h **** //* \brief Enable PIO
 637:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 638:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Enable(
 639:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 640:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled 
 641:lib_AT91SAM7S64.h **** {
 642:lib_AT91SAM7S64.h ****         pPio->PIO_PER = flag;
 643:lib_AT91SAM7S64.h **** }
 644:lib_AT91SAM7S64.h **** 
 645:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 646:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Disable
 647:lib_AT91SAM7S64.h **** //* \brief Disable PIO
 648:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 649:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Disable(
 650:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 651:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled 
 652:lib_AT91SAM7S64.h **** {
 653:lib_AT91SAM7S64.h ****         pPio->PIO_PDR = flag;
 654:lib_AT91SAM7S64.h **** }
 655:lib_AT91SAM7S64.h **** 
 656:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 657:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetStatus
 658:lib_AT91SAM7S64.h **** //* \brief Return PIO Status
 659:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 660:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetStatus( // \return PIO Status
 661:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 662:lib_AT91SAM7S64.h **** {
 663:lib_AT91SAM7S64.h ****         return pPio->PIO_PSR;
 664:lib_AT91SAM7S64.h **** }
 665:lib_AT91SAM7S64.h **** 
 666:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 667:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsSet
 668:lib_AT91SAM7S64.h **** //* \brief Test if PIO is Set
 669:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 670:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsSet(
 671:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 672:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 673:lib_AT91SAM7S64.h **** {
 674:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetStatus(pPio) & flag);
 675:lib_AT91SAM7S64.h **** }
 676:lib_AT91SAM7S64.h **** 
 677:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 678:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputEnable
 679:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 680:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 681:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputEnable(
 682:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 683:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be enabled
 684:lib_AT91SAM7S64.h **** {
 685:lib_AT91SAM7S64.h ****         pPio->PIO_OER = flag;
 686:lib_AT91SAM7S64.h **** }
 687:lib_AT91SAM7S64.h **** 
 688:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 689:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputDisable
 690:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 691:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 692:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputDisable(
 693:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 694:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be disabled
 695:lib_AT91SAM7S64.h **** {
 696:lib_AT91SAM7S64.h ****         pPio->PIO_ODR = flag;
 697:lib_AT91SAM7S64.h **** }
 698:lib_AT91SAM7S64.h **** 
 699:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 700:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputStatus
 701:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Status
 702:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 703:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputStatus( // \return PIO Output Status
 704:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 705:lib_AT91SAM7S64.h **** {
 706:lib_AT91SAM7S64.h ****         return pPio->PIO_OSR;
 707:lib_AT91SAM7S64.h **** }
 708:lib_AT91SAM7S64.h **** 
 709:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 710:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOuputSet
 711:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output is Set
 712:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 713:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputSet(
 714:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 715:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 716:lib_AT91SAM7S64.h **** {
 717:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputStatus(pPio) & flag);
 718:lib_AT91SAM7S64.h **** }
 719:lib_AT91SAM7S64.h **** 
 720:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 721:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterEnable
 722:lib_AT91SAM7S64.h **** //* \brief Input Filter Enable PIO
 723:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 724:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterEnable(
 725:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 726:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be enabled
 727:lib_AT91SAM7S64.h **** {
 728:lib_AT91SAM7S64.h ****         pPio->PIO_IFER = flag;
 729:lib_AT91SAM7S64.h **** }
 730:lib_AT91SAM7S64.h **** 
 731:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 732:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterDisable
 733:lib_AT91SAM7S64.h **** //* \brief Input Filter Disable PIO
 734:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 735:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterDisable(
 736:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 737:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be disabled
 738:lib_AT91SAM7S64.h **** {
 739:lib_AT91SAM7S64.h ****         pPio->PIO_IFDR = flag;
 740:lib_AT91SAM7S64.h **** }
 741:lib_AT91SAM7S64.h **** 
 742:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 743:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInputFilterStatus
 744:lib_AT91SAM7S64.h **** //* \brief Return PIO Input Filter Status
 745:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 746:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInputFilterStatus( // \return PIO Input Filter Status
 747:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 748:lib_AT91SAM7S64.h **** {
 749:lib_AT91SAM7S64.h ****         return pPio->PIO_IFSR;
 750:lib_AT91SAM7S64.h **** }
 751:lib_AT91SAM7S64.h **** 
 752:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 753:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputFilterSet
 754:lib_AT91SAM7S64.h **** //* \brief Test if PIO Input filter is Set
 755:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 756:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputFilterSet(
 757:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 758:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 759:lib_AT91SAM7S64.h **** {
 760:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInputFilterStatus(pPio) & flag);
 761:lib_AT91SAM7S64.h **** }
 762:lib_AT91SAM7S64.h **** 
 763:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 764:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputDataStatus
 765:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Data Status 
 766:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 767:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputDataStatus( // \return PIO Output Data Status 
 768:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 769:lib_AT91SAM7S64.h **** {
 770:lib_AT91SAM7S64.h ****         return pPio->PIO_ODSR;
 771:lib_AT91SAM7S64.h **** }
 772:lib_AT91SAM7S64.h **** 
 773:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 774:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptEnable
 775:lib_AT91SAM7S64.h **** //* \brief Enable PIO Interrupt
 776:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 777:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptEnable(
 778:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 779:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be enabled
 780:lib_AT91SAM7S64.h **** {
 781:lib_AT91SAM7S64.h ****         pPio->PIO_IER = flag;
 782:lib_AT91SAM7S64.h **** }
 783:lib_AT91SAM7S64.h **** 
 784:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 785:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptDisable
 786:lib_AT91SAM7S64.h **** //* \brief Disable PIO Interrupt
 787:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 788:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptDisable(
 789:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 790:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be disabled
 791:lib_AT91SAM7S64.h **** {
 792:lib_AT91SAM7S64.h ****         pPio->PIO_IDR = flag;
 793:lib_AT91SAM7S64.h **** }
 794:lib_AT91SAM7S64.h **** 
 795:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 796:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptMaskStatus
 797:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Mask Status
 798:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 799:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptMaskStatus( // \return PIO Interrupt Mask Status
 800:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 801:lib_AT91SAM7S64.h **** {
 802:lib_AT91SAM7S64.h ****         return pPio->PIO_IMR;
 803:lib_AT91SAM7S64.h **** }
 804:lib_AT91SAM7S64.h **** 
 805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 806:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptStatus
 807:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 808:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 809:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptStatus( // \return PIO Interrupt Status
 810:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 811:lib_AT91SAM7S64.h **** {
 812:lib_AT91SAM7S64.h ****         return pPio->PIO_ISR;
 813:lib_AT91SAM7S64.h **** }
 814:lib_AT91SAM7S64.h **** 
 815:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 816:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptMasked
 817:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Masked 
 818:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 819:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptMasked(
 820:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 821:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 822:lib_AT91SAM7S64.h **** {
 823:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptMaskStatus(pPio) & flag);
 824:lib_AT91SAM7S64.h **** }
 825:lib_AT91SAM7S64.h **** 
 826:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 827:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptSet
 828:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Set
 829:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 830:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptSet(
 831:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 832:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 833:lib_AT91SAM7S64.h **** {
 834:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptStatus(pPio) & flag);
 835:lib_AT91SAM7S64.h **** }
 836:lib_AT91SAM7S64.h **** 
 837:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 838:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverEnable
 839:lib_AT91SAM7S64.h **** //* \brief Multi Driver Enable PIO
 840:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 841:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverEnable(
 842:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 843:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled
 844:lib_AT91SAM7S64.h **** {
 845:lib_AT91SAM7S64.h ****         pPio->PIO_MDER = flag;
 846:lib_AT91SAM7S64.h **** }
 847:lib_AT91SAM7S64.h **** 
 848:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 849:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverDisable
 850:lib_AT91SAM7S64.h **** //* \brief Multi Driver Disable PIO
 851:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 852:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverDisable(
 853:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 854:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled
 855:lib_AT91SAM7S64.h **** {
 856:lib_AT91SAM7S64.h ****         pPio->PIO_MDDR = flag;
 857:lib_AT91SAM7S64.h **** }
 858:lib_AT91SAM7S64.h **** 
 859:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 860:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetMultiDriverStatus
 861:lib_AT91SAM7S64.h **** //* \brief Return PIO Multi Driver Status
 862:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 863:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetMultiDriverStatus( // \return PIO Multi Driver Status
 864:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 865:lib_AT91SAM7S64.h **** {
 866:lib_AT91SAM7S64.h ****         return pPio->PIO_MDSR;
 867:lib_AT91SAM7S64.h **** }
 868:lib_AT91SAM7S64.h **** 
 869:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 870:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsMultiDriverSet
 871:lib_AT91SAM7S64.h **** //* \brief Test if PIO MultiDriver is Set
 872:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 873:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsMultiDriverSet(
 874:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 875:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 876:lib_AT91SAM7S64.h **** {
 877:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetMultiDriverStatus(pPio) & flag);
 878:lib_AT91SAM7S64.h **** }
 879:lib_AT91SAM7S64.h **** 
 880:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 881:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_A_RegisterSelection
 882:lib_AT91SAM7S64.h **** //* \brief PIO A Register Selection 
 883:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 884:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_A_RegisterSelection(
 885:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 886:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio A register selection
 887:lib_AT91SAM7S64.h **** {
 888:lib_AT91SAM7S64.h ****         pPio->PIO_ASR = flag;
 889:lib_AT91SAM7S64.h **** }
 890:lib_AT91SAM7S64.h **** 
 891:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 892:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_B_RegisterSelection
 893:lib_AT91SAM7S64.h **** //* \brief PIO B Register Selection 
 894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 895:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_B_RegisterSelection(
 896:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 897:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio B register selection 
 898:lib_AT91SAM7S64.h **** {
 899:lib_AT91SAM7S64.h ****         pPio->PIO_BSR = flag;
 900:lib_AT91SAM7S64.h **** }
 901:lib_AT91SAM7S64.h **** 
 902:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 903:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Get_AB_RegisterStatus
 904:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 905:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 906:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_Get_AB_RegisterStatus( // \return PIO AB Register Status
 907:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 908:lib_AT91SAM7S64.h **** {
 909:lib_AT91SAM7S64.h ****         return pPio->PIO_ABSR;
 910:lib_AT91SAM7S64.h **** }
 911:lib_AT91SAM7S64.h **** 
 912:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 913:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsAB_RegisterSet
 914:lib_AT91SAM7S64.h **** //* \brief Test if PIO AB Register is Set
 915:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 916:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsAB_RegisterSet(
 917:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 918:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 919:lib_AT91SAM7S64.h **** {
 920:lib_AT91SAM7S64.h ****         return (AT91F_PIO_Get_AB_RegisterStatus(pPio) & flag);
 921:lib_AT91SAM7S64.h **** }
 922:lib_AT91SAM7S64.h **** 
 923:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 924:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteEnable
 925:lib_AT91SAM7S64.h **** //* \brief Output Write Enable PIO
 926:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 927:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteEnable(
 928:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 929:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be enabled
 930:lib_AT91SAM7S64.h **** {
 931:lib_AT91SAM7S64.h ****         pPio->PIO_OWER = flag;
 932:lib_AT91SAM7S64.h **** }
 933:lib_AT91SAM7S64.h **** 
 934:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 935:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteDisable
 936:lib_AT91SAM7S64.h **** //* \brief Output Write Disable PIO
 937:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 938:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteDisable(
 939:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 940:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be disabled
 941:lib_AT91SAM7S64.h **** {
 942:lib_AT91SAM7S64.h ****         pPio->PIO_OWDR = flag;
 943:lib_AT91SAM7S64.h **** }
 944:lib_AT91SAM7S64.h **** 
 945:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 946:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputWriteStatus
 947:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Write Status
 948:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 949:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputWriteStatus( // \return PIO Output Write Status
 950:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 951:lib_AT91SAM7S64.h **** {
 952:lib_AT91SAM7S64.h ****         return pPio->PIO_OWSR;
 953:lib_AT91SAM7S64.h **** }
 954:lib_AT91SAM7S64.h **** 
 955:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 956:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputWriteSet
 957:lib_AT91SAM7S64.h **** //* \brief Test if PIO OutputWrite is Set
 958:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 959:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputWriteSet(
 960:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 961:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 962:lib_AT91SAM7S64.h **** {
 963:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputWriteStatus(pPio) & flag);
 964:lib_AT91SAM7S64.h **** }
 965:lib_AT91SAM7S64.h **** 
 966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 967:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetCfgPullup
 968:lib_AT91SAM7S64.h **** //* \brief Return PIO Configuration Pullup
 969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 970:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetCfgPullup( // \return PIO Configuration Pullup 
 971:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 972:lib_AT91SAM7S64.h **** {
 973:lib_AT91SAM7S64.h ****         return pPio->PIO_PPUSR;
 974:lib_AT91SAM7S64.h **** }
 975:lib_AT91SAM7S64.h **** 
 976:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 977:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputDataStatusSet
 978:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output Data Status is Set 
 979:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 980:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputDataStatusSet(
 981:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 982:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 983:lib_AT91SAM7S64.h **** {
 984:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputDataStatus(pPio) & flag);
 985:lib_AT91SAM7S64.h **** }
 986:lib_AT91SAM7S64.h **** 
 987:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 988:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsCfgPullupStatusSet
 989:lib_AT91SAM7S64.h **** //* \brief Test if PIO Configuration Pullup Status is Set
 990:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 991:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsCfgPullupStatusSet(
 992:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 993:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 994:lib_AT91SAM7S64.h **** {
 995:lib_AT91SAM7S64.h ****         return (~AT91F_PIO_GetCfgPullup(pPio) & flag);
 996:lib_AT91SAM7S64.h **** }
 997:lib_AT91SAM7S64.h **** 
 998:lib_AT91SAM7S64.h **** /* *****************************************************************************
 999:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PMC
1000:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1001:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1002:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkEnableReg
1003:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Enable Register of the PMC controller
1004:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1005:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkEnableReg (
1006:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1007:lib_AT91SAM7S64.h **** 	unsigned int mode)
1008:lib_AT91SAM7S64.h **** {
1009:lib_AT91SAM7S64.h **** 	//* Write to the SCER register
1010:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = mode;
1011:lib_AT91SAM7S64.h **** }
1012:lib_AT91SAM7S64.h **** 
1013:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1014:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkDisableReg
1015:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Disable Register of the PMC controller
1016:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1017:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkDisableReg (
1018:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1019:lib_AT91SAM7S64.h **** 	unsigned int mode)
1020:lib_AT91SAM7S64.h **** {
1021:lib_AT91SAM7S64.h **** 	//* Write to the SCDR register
1022:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = mode;
1023:lib_AT91SAM7S64.h **** }
1024:lib_AT91SAM7S64.h **** 
1025:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1026:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetSysClkStatusReg
1027:lib_AT91SAM7S64.h **** //* \brief Return the System Clock Status Register of the PMC controller
1028:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1029:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetSysClkStatusReg (
1030:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC // pointer to a CAN controller
1031:lib_AT91SAM7S64.h **** 	)
1032:lib_AT91SAM7S64.h **** {
1033:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SCSR;
1034:lib_AT91SAM7S64.h **** }
1035:lib_AT91SAM7S64.h **** 
1036:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1037:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePeriphClock
1038:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1039:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1040:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePeriphClock (
1041:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1042:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1043:lib_AT91SAM7S64.h **** {
1044:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCER = periphIds;
 678              		.loc 1 1044 0
 679 02a0 0420A0E3 		mov	r2, #4
 680 02a4 033CE0E3 		mvn	r3, #768
 681 02a8 EF2003E5 		str	r2, [r3, #-239]
 682              	.LBE274:
 683              	.LBE273:
 684              		.loc 2 251 0
 685 02ac FEFFFFEB 		bl	AT91FUSBOpen
 686              	.L24:
 687              	.LBE272:
 688              		.loc 2 253 0
 689 02b0 24329FE5 		ldr	r3, .L38+4
 690 02b4 0300A0E1 		mov	r0, r3
 691 02b8 0CC093E5 		ldr	ip, [r3, #12]
 692 02bc 0FE0A0E1 		mov	lr, pc
 693 02c0 1CFF2FE1 		bx	ip
 694              	.LBB275:
 695 02c4 000050E3 		cmp	r0, #0
 696 02c8 AA00000A 		beq	.L24
 697              	.LBB276:
 698              	.LBB277:
 699              	.LBB278:
 700              	.LBB279:
1045:lib_AT91SAM7S64.h **** }
1046:lib_AT91SAM7S64.h **** 
1047:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1048:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePeriphClock
1049:lib_AT91SAM7S64.h **** //* \brief Disable peripheral clock
1050:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1051:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePeriphClock (
1052:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1053:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1054:lib_AT91SAM7S64.h **** {
1055:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCDR = periphIds;
1056:lib_AT91SAM7S64.h **** }
1057:lib_AT91SAM7S64.h **** 
1058:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1059:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetPeriphClock
1060:lib_AT91SAM7S64.h **** //* \brief Get peripheral clock status
1061:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1062:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetPeriphClock (
1063:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1064:lib_AT91SAM7S64.h **** {
1065:lib_AT91SAM7S64.h **** 	return pPMC->PMC_PCSR;
1066:lib_AT91SAM7S64.h **** }
1067:lib_AT91SAM7S64.h **** 
1068:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1069:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscillatorReg
1070:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1071:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1072:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscillatorReg (
1073:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1074:lib_AT91SAM7S64.h **** 	unsigned int mode)
1075:lib_AT91SAM7S64.h **** {
1076:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR = mode;
1077:lib_AT91SAM7S64.h **** }
1078:lib_AT91SAM7S64.h **** 
1079:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1080:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainOscillatorReg
1081:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1082:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1083:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainOscillatorReg (
1084:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1085:lib_AT91SAM7S64.h **** {
1086:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MOR;
1087:lib_AT91SAM7S64.h **** }
1088:lib_AT91SAM7S64.h **** 
1089:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1090:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_EnableMainOscillator
1091:lib_AT91SAM7S64.h **** //* \brief Enable the main oscillator
1092:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1093:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_EnableMainOscillator(
1094:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1095:lib_AT91SAM7S64.h **** {
1096:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= AT91C_CKGR_MOSCEN;
1097:lib_AT91SAM7S64.h **** }
1098:lib_AT91SAM7S64.h **** 
1099:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1100:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_DisableMainOscillator
1101:lib_AT91SAM7S64.h **** //* \brief Disable the main oscillator
1102:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1103:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_DisableMainOscillator (
1104:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1105:lib_AT91SAM7S64.h **** {
1106:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_MOSCEN;
1107:lib_AT91SAM7S64.h **** }
1108:lib_AT91SAM7S64.h **** 
1109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1110:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscStartUpTime
1111:lib_AT91SAM7S64.h **** //* \brief Cfg MOR Register according to the main osc startup time
1112:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1113:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscStartUpTime (
1114:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1115:lib_AT91SAM7S64.h **** 	unsigned int startup_time,  // \arg main osc startup time in microsecond (us)
1116:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1117:lib_AT91SAM7S64.h **** {
1118:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_OSCOUNT;
1119:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= ((slowClock * startup_time)/(8*1000000)) << 8;
1120:lib_AT91SAM7S64.h **** }
1121:lib_AT91SAM7S64.h **** 
1122:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1123:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClockFreqReg
1124:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1125:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1126:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClockFreqReg (
1127:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1128:lib_AT91SAM7S64.h **** {
1129:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MCFR;
1130:lib_AT91SAM7S64.h **** }
1131:lib_AT91SAM7S64.h **** 
1132:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1133:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClock
1134:lib_AT91SAM7S64.h **** //* \brief Return Main clock in Hz
1135:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1136:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClock (
1137:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1138:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1139:lib_AT91SAM7S64.h **** {
1140:lib_AT91SAM7S64.h **** 	return ((pCKGR->CKGR_MCFR  & AT91C_CKGR_MAINF) * slowClock) >> 4;
1141:lib_AT91SAM7S64.h **** }
1142:lib_AT91SAM7S64.h **** 
1143:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1144:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgMCKReg
1145:lib_AT91SAM7S64.h **** //* \brief Cfg Master Clock Register
1146:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1147:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgMCKReg (
1148:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1149:lib_AT91SAM7S64.h **** 	unsigned int mode)
1150:lib_AT91SAM7S64.h **** {
1151:lib_AT91SAM7S64.h **** 	pPMC->PMC_MCKR = mode;
1152:lib_AT91SAM7S64.h **** }
1153:lib_AT91SAM7S64.h **** 
1154:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1155:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMCKReg
1156:lib_AT91SAM7S64.h **** //* \brief Return Master Clock Register
1157:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1158:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMCKReg(
1159:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1160:lib_AT91SAM7S64.h **** {
1161:lib_AT91SAM7S64.h **** 	return pPMC->PMC_MCKR;
1162:lib_AT91SAM7S64.h **** }
1163:lib_AT91SAM7S64.h **** 
1164:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1165:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMasterClock
1166:lib_AT91SAM7S64.h **** //* \brief Return master clock in Hz which correponds to processor clock for ARM7
1167:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1168:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMasterClock (
1169:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1170:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1171:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1172:lib_AT91SAM7S64.h **** {
1173:lib_AT91SAM7S64.h **** 	unsigned int reg = pPMC->PMC_MCKR;
1174:lib_AT91SAM7S64.h **** 	unsigned int prescaler = (1 << ((reg & AT91C_PMC_PRES) >> 2));
1175:lib_AT91SAM7S64.h **** 	unsigned int pllDivider, pllMultiplier;
1176:lib_AT91SAM7S64.h **** 
1177:lib_AT91SAM7S64.h **** 	switch (reg & AT91C_PMC_CSS) {
1178:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_SLOW_CLK: // Slow clock selected
1179:lib_AT91SAM7S64.h **** 			return slowClock / prescaler;
1180:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_MAIN_CLK: // Main clock is selected
1181:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / prescaler;
1182:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_PLL_CLK: // PLLB clock is selected
1183:lib_AT91SAM7S64.h **** 			reg = pCKGR->CKGR_PLLR;
1184:lib_AT91SAM7S64.h **** 			pllDivider    = (reg  & AT91C_CKGR_DIV);
1185:lib_AT91SAM7S64.h **** 			pllMultiplier = ((reg  & AT91C_CKGR_MUL) >> 16) + 1;
1186:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / pllDivider * pllMultiplier / prescaler;
1187:lib_AT91SAM7S64.h **** 	}
1188:lib_AT91SAM7S64.h **** 	return 0;
1189:lib_AT91SAM7S64.h **** }
1190:lib_AT91SAM7S64.h **** 
1191:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1192:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePCK
1193:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1194:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1195:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePCK (
1196:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1197:lib_AT91SAM7S64.h **** 	unsigned int pck,  // \arg Peripheral clock identifier 0 .. 7
1198:lib_AT91SAM7S64.h **** 	unsigned int mode)
1199:lib_AT91SAM7S64.h **** {
1200:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCKR[pck] = mode;
1201:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = (1 << pck) << 8;
1202:lib_AT91SAM7S64.h **** }
1203:lib_AT91SAM7S64.h **** 
1204:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1205:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePCK
1206:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1207:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1208:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePCK (
1209:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1210:lib_AT91SAM7S64.h **** 	unsigned int pck)  // \arg Peripheral clock identifier 0 .. 7
1211:lib_AT91SAM7S64.h **** {
1212:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = (1 << pck) << 8;
1213:lib_AT91SAM7S64.h **** }
1214:lib_AT91SAM7S64.h **** 
1215:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1216:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnableIt
1217:lib_AT91SAM7S64.h **** //* \brief Enable PMC interrupt
1218:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1219:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnableIt (
1220:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC,     // pointer to a PMC controller
1221:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1222:lib_AT91SAM7S64.h **** {
1223:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1224:lib_AT91SAM7S64.h **** 	pPMC->PMC_IER = flag;
1225:lib_AT91SAM7S64.h **** }
1226:lib_AT91SAM7S64.h **** 
1227:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1228:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisableIt
1229:lib_AT91SAM7S64.h **** //* \brief Disable PMC interrupt
1230:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1231:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisableIt (
1232:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // pointer to a PMC controller
1233:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1234:lib_AT91SAM7S64.h **** {
1235:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1236:lib_AT91SAM7S64.h **** 	pPMC->PMC_IDR = flag;
1237:lib_AT91SAM7S64.h **** }
1238:lib_AT91SAM7S64.h **** 
1239:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1240:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetStatus
1241:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Status
1242:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1243:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetStatus( // \return PMC Interrupt Status
1244:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1245:lib_AT91SAM7S64.h **** {
1246:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SR;
1247:lib_AT91SAM7S64.h **** }
1248:lib_AT91SAM7S64.h **** 
1249:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1250:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetInterruptMaskStatus
1251:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Mask Status
1252:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1253:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetInterruptMaskStatus( // \return PMC Interrupt Mask Status
1254:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1255:lib_AT91SAM7S64.h **** {
1256:lib_AT91SAM7S64.h **** 	return pPMC->PMC_IMR;
1257:lib_AT91SAM7S64.h **** }
1258:lib_AT91SAM7S64.h **** 
1259:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1260:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsInterruptMasked
1261:lib_AT91SAM7S64.h **** //* \brief Test if PMC Interrupt is Masked
1262:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1263:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsInterruptMasked(
1264:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1265:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1266:lib_AT91SAM7S64.h **** {
1267:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetInterruptMaskStatus(pPMC) & flag);
1268:lib_AT91SAM7S64.h **** }
1269:lib_AT91SAM7S64.h **** 
1270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsStatusSet
1272:lib_AT91SAM7S64.h **** //* \brief Test if PMC Status is Set
1273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1274:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsStatusSet(
1275:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1276:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1277:lib_AT91SAM7S64.h **** {
1278:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetStatus(pPMC) & flag);
1279:lib_AT91SAM7S64.h **** }
1280:lib_AT91SAM7S64.h **** 
1281:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1282:lib_AT91SAM7S64.h **** //  \fn    AT91F_CKGR_CfgPLLReg
1283:lib_AT91SAM7S64.h **** //  \brief Cfg the PLL Register
1284:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1285:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgPLLReg (
1286:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1287:lib_AT91SAM7S64.h **** 	unsigned int mode)
1288:lib_AT91SAM7S64.h **** {
1289:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_PLLR = mode;
1290:lib_AT91SAM7S64.h **** }
1291:lib_AT91SAM7S64.h **** 
1292:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1293:lib_AT91SAM7S64.h **** //  \fn    AT91F_CKGR_GetPLLReg
1294:lib_AT91SAM7S64.h **** //  \brief Get the PLL Register
1295:lib_AT91SAM7S64.h **** // ----------------------------------------------------------------------------
1296:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetPLLReg (
1297:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1298:lib_AT91SAM7S64.h **** {
1299:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_PLLR;
1300:lib_AT91SAM7S64.h **** }
1301:lib_AT91SAM7S64.h **** 
1302:lib_AT91SAM7S64.h **** 
1303:lib_AT91SAM7S64.h **** 
1304:lib_AT91SAM7S64.h **** /* *****************************************************************************
1305:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RSTC
1306:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1307:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1308:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSoftReset
1309:lib_AT91SAM7S64.h **** //* \brief Start Software Reset
1310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1311:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSoftReset(
1312:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1313:lib_AT91SAM7S64.h ****         unsigned int reset)
1314:lib_AT91SAM7S64.h **** {
1315:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RCR = (0xA5000000 | reset);
1316:lib_AT91SAM7S64.h **** }
1317:lib_AT91SAM7S64.h **** 
1318:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1319:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSetMode
1320:lib_AT91SAM7S64.h **** //* \brief Set Reset Mode
1321:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1322:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSetMode(
1323:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1324:lib_AT91SAM7S64.h ****         unsigned int mode)
1325:lib_AT91SAM7S64.h **** {
1326:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RMR = (0xA5000000 | mode);
1327:lib_AT91SAM7S64.h **** }
1328:lib_AT91SAM7S64.h **** 
1329:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1330:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetMode
1331:lib_AT91SAM7S64.h **** //* \brief Get Reset Mode
1332:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1333:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetMode(
1334:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1335:lib_AT91SAM7S64.h **** {
1336:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RMR);
1337:lib_AT91SAM7S64.h **** }
1338:lib_AT91SAM7S64.h **** 
1339:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1340:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetStatus
1341:lib_AT91SAM7S64.h **** //* \brief Get Reset Status
1342:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1343:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetStatus(
1344:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1345:lib_AT91SAM7S64.h **** {
1346:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RSR);
1347:lib_AT91SAM7S64.h **** }
1348:lib_AT91SAM7S64.h **** 
1349:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1350:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTIsSoftRstActive
1351:lib_AT91SAM7S64.h **** //* \brief Return !=0 if software reset is still not completed
1352:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1353:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTIsSoftRstActive(
1354:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1355:lib_AT91SAM7S64.h **** {
1356:lib_AT91SAM7S64.h **** 	return ((pRSTC->RSTC_RSR) & AT91C_RSTC_SRCMP);
1357:lib_AT91SAM7S64.h **** }
1358:lib_AT91SAM7S64.h **** /* *****************************************************************************
1359:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RTTC
1360:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1361:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1362:lib_AT91SAM7S64.h **** //* \fn     AT91F_SetRTT_TimeBase()
1363:lib_AT91SAM7S64.h **** //* \brief  Set the RTT prescaler according to the TimeBase in ms
1364:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1365:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetTimeBase(
1366:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1367:lib_AT91SAM7S64.h ****         unsigned int ms)
1368:lib_AT91SAM7S64.h **** {
1369:lib_AT91SAM7S64.h **** 	if (ms > 2000)
1370:lib_AT91SAM7S64.h **** 		return 1;   // AT91C_TIME_OUT_OF_RANGE
1371:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1372:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (((ms << 15) /1000) & 0xFFFF);	
1373:lib_AT91SAM7S64.h **** 	return 0;
1374:lib_AT91SAM7S64.h **** }
1375:lib_AT91SAM7S64.h **** 
1376:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1377:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTSetPrescaler()
1378:lib_AT91SAM7S64.h **** //* \brief  Set the new prescaler value
1379:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1380:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetPrescaler(
1381:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1382:lib_AT91SAM7S64.h ****         unsigned int rtpres)
1383:lib_AT91SAM7S64.h **** {
1384:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1385:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (rtpres & 0xFFFF);	
1386:lib_AT91SAM7S64.h **** 	return (pRTTC->RTTC_RTMR);
1387:lib_AT91SAM7S64.h **** }
1388:lib_AT91SAM7S64.h **** 
1389:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1390:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTRestart()
1391:lib_AT91SAM7S64.h **** //* \brief  Restart the RTT prescaler
1392:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1393:lib_AT91SAM7S64.h **** __inline void AT91F_RTTRestart(
1394:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1395:lib_AT91SAM7S64.h **** {
1396:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTRST;	
1397:lib_AT91SAM7S64.h **** }
1398:lib_AT91SAM7S64.h **** 
1399:lib_AT91SAM7S64.h **** 
1400:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1401:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmINT()
1402:lib_AT91SAM7S64.h **** //* \brief  Enable RTT Alarm Interrupt
1403:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1404:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmINT(
1405:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1406:lib_AT91SAM7S64.h **** {
1407:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_ALMIEN;
1408:lib_AT91SAM7S64.h **** }
1409:lib_AT91SAM7S64.h **** 
1410:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1411:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearAlarmINT()
1412:lib_AT91SAM7S64.h **** //* \brief  Disable RTT Alarm Interrupt
1413:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1414:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearAlarmINT(
1415:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1416:lib_AT91SAM7S64.h **** {
1417:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_ALMIEN;
1418:lib_AT91SAM7S64.h **** }
1419:lib_AT91SAM7S64.h **** 
1420:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1421:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetRttIncINT()
1422:lib_AT91SAM7S64.h **** //* \brief  Enable RTT INC Interrupt
1423:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1424:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetRttIncINT(
1425:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1426:lib_AT91SAM7S64.h **** {
1427:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTINCIEN;
1428:lib_AT91SAM7S64.h **** }
1429:lib_AT91SAM7S64.h **** 
1430:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1431:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearRttIncINT()
1432:lib_AT91SAM7S64.h **** //* \brief  Disable RTT INC Interrupt
1433:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1434:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearRttIncINT(
1435:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1436:lib_AT91SAM7S64.h **** {
1437:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_RTTINCIEN;
1438:lib_AT91SAM7S64.h **** }
1439:lib_AT91SAM7S64.h **** 
1440:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1441:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmValue()
1442:lib_AT91SAM7S64.h **** //* \brief  Set RTT Alarm Value
1443:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1444:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmValue(
1445:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, unsigned int alarm)
1446:lib_AT91SAM7S64.h **** {
1447:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTAR = alarm;
1448:lib_AT91SAM7S64.h **** }
1449:lib_AT91SAM7S64.h **** 
1450:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1451:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_GetAlarmValue()
1452:lib_AT91SAM7S64.h **** //* \brief  Get RTT Alarm Value
1453:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1454:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetAlarmValue(
1455:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1456:lib_AT91SAM7S64.h **** {
1457:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTAR);
1458:lib_AT91SAM7S64.h **** }
1459:lib_AT91SAM7S64.h **** 
1460:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1461:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTGetStatus()
1462:lib_AT91SAM7S64.h **** //* \brief  Read the RTT status
1463:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1464:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetStatus(
1465:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1466:lib_AT91SAM7S64.h **** {
1467:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTSR);
1468:lib_AT91SAM7S64.h **** }
1469:lib_AT91SAM7S64.h **** 
1470:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1471:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ReadValue()
1472:lib_AT91SAM7S64.h **** //* \brief  Read the RTT value
1473:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1474:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTReadValue(
1475:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1476:lib_AT91SAM7S64.h **** {
1477:lib_AT91SAM7S64.h ****         register volatile unsigned int val1,val2;
1478:lib_AT91SAM7S64.h **** 	do
1479:lib_AT91SAM7S64.h **** 	{
1480:lib_AT91SAM7S64.h **** 		val1 = pRTTC->RTTC_RTVR;
1481:lib_AT91SAM7S64.h **** 		val2 = pRTTC->RTTC_RTVR;
1482:lib_AT91SAM7S64.h **** 	}	
1483:lib_AT91SAM7S64.h **** 	while(val1 != val2);
1484:lib_AT91SAM7S64.h **** 	return(val1);
1485:lib_AT91SAM7S64.h **** }
1486:lib_AT91SAM7S64.h **** /* *****************************************************************************
1487:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PITC
1488:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1489:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1490:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITInit
1491:lib_AT91SAM7S64.h **** //* \brief System timer init : period in second, system clock freq in MHz
1492:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1493:lib_AT91SAM7S64.h **** __inline void AT91F_PITInit(
1494:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1495:lib_AT91SAM7S64.h ****         unsigned int period,
1496:lib_AT91SAM7S64.h ****         unsigned int pit_frequency)
1497:lib_AT91SAM7S64.h **** {
1498:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = period? (period * pit_frequency + 8) >> 4 : 0; // +8 to avoid %10 and /10
1499:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITEN;	 
1500:lib_AT91SAM7S64.h **** }
1501:lib_AT91SAM7S64.h **** 
1502:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1503:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITSetPIV
1504:lib_AT91SAM7S64.h **** //* \brief Set the PIT Periodic Interval Value 
1505:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1506:lib_AT91SAM7S64.h **** __inline void AT91F_PITSetPIV(
1507:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1508:lib_AT91SAM7S64.h ****         unsigned int piv)
1509:lib_AT91SAM7S64.h **** {
1510:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = piv | (pPITC->PITC_PIMR & (AT91C_PITC_PITEN | AT91C_PITC_PITIEN));
1511:lib_AT91SAM7S64.h **** }
1512:lib_AT91SAM7S64.h **** 
1513:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1514:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITEnableInt
1515:lib_AT91SAM7S64.h **** //* \brief Enable PIT periodic interrupt
1516:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1517:lib_AT91SAM7S64.h **** __inline void AT91F_PITEnableInt(
1518:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1519:lib_AT91SAM7S64.h **** {
1520:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITIEN;	 
1521:lib_AT91SAM7S64.h **** }
1522:lib_AT91SAM7S64.h **** 
1523:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1524:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITDisableInt
1525:lib_AT91SAM7S64.h **** //* \brief Disable PIT periodic interrupt
1526:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1527:lib_AT91SAM7S64.h **** __inline void AT91F_PITDisableInt(
1528:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1529:lib_AT91SAM7S64.h **** {
1530:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR &= ~AT91C_PITC_PITIEN;	 
1531:lib_AT91SAM7S64.h **** }
1532:lib_AT91SAM7S64.h **** 
1533:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1534:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetMode
1535:lib_AT91SAM7S64.h **** //* \brief Read PIT mode register
1536:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1537:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetMode(
1538:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1539:lib_AT91SAM7S64.h **** {
1540:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIMR);
1541:lib_AT91SAM7S64.h **** }
1542:lib_AT91SAM7S64.h **** 
1543:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1544:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetStatus
1545:lib_AT91SAM7S64.h **** //* \brief Read PIT status register
1546:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1547:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetStatus(
1548:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1549:lib_AT91SAM7S64.h **** {
1550:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PISR);
1551:lib_AT91SAM7S64.h **** }
1552:lib_AT91SAM7S64.h **** 
1553:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1554:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIIR
1555:lib_AT91SAM7S64.h **** //* \brief Read PIT CPIV and PICNT without ressetting the counters
1556:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1557:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIIR(
1558:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1559:lib_AT91SAM7S64.h **** {
1560:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIIR);
1561:lib_AT91SAM7S64.h **** }
1562:lib_AT91SAM7S64.h **** 
1563:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1564:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIVR
1565:lib_AT91SAM7S64.h **** //* \brief Read System timer CPIV and PICNT without ressetting the counters
1566:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1567:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIVR(
1568:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1569:lib_AT91SAM7S64.h **** {
1570:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIVR);
1571:lib_AT91SAM7S64.h **** }
1572:lib_AT91SAM7S64.h **** /* *****************************************************************************
1573:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR WDTC
1574:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1575:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1576:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSetMode
1577:lib_AT91SAM7S64.h **** //* \brief Set Watchdog Mode Register
1578:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1579:lib_AT91SAM7S64.h **** __inline void AT91F_WDTSetMode(
1580:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC,
1581:lib_AT91SAM7S64.h ****         unsigned int Mode)
1582:lib_AT91SAM7S64.h **** {
1583:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDMR = Mode;
1584:lib_AT91SAM7S64.h **** }
1585:lib_AT91SAM7S64.h **** 
1586:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1587:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTRestart
1588:lib_AT91SAM7S64.h **** //* \brief Restart Watchdog
1589:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1590:lib_AT91SAM7S64.h **** __inline void AT91F_WDTRestart(
1591:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1592:lib_AT91SAM7S64.h **** {
1593:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDCR = 0xA5000001;
1594:lib_AT91SAM7S64.h **** }
1595:lib_AT91SAM7S64.h **** 
1596:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1597:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSGettatus
1598:lib_AT91SAM7S64.h **** //* \brief Get Watchdog Status
1599:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1600:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTSGettatus(
1601:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1602:lib_AT91SAM7S64.h **** {
1603:lib_AT91SAM7S64.h **** 	return(pWDTC->WDTC_WDSR & 0x3);
1604:lib_AT91SAM7S64.h **** }
1605:lib_AT91SAM7S64.h **** 
1606:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1607:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTGetPeriod
1608:lib_AT91SAM7S64.h **** //* \brief Translate ms into Watchdog Compatible value
1609:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1610:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTGetPeriod(unsigned int ms)
1611:lib_AT91SAM7S64.h **** {
1612:lib_AT91SAM7S64.h **** 	if ((ms < 4) || (ms > 16000))
1613:lib_AT91SAM7S64.h **** 		return 0;
1614:lib_AT91SAM7S64.h **** 	return((ms << 8) / 1000);
1615:lib_AT91SAM7S64.h **** }
1616:lib_AT91SAM7S64.h **** /* *****************************************************************************
1617:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR VREG
1618:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1619:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1620:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Enable_LowPowerMode
1621:lib_AT91SAM7S64.h **** //* \brief Enable VREG Low Power Mode
1622:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1623:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Enable_LowPowerMode(
1624:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1625:lib_AT91SAM7S64.h **** {
1626:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR |= AT91C_VREG_PSTDBY;	 
1627:lib_AT91SAM7S64.h **** }
1628:lib_AT91SAM7S64.h **** 
1629:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1630:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Disable_LowPowerMode
1631:lib_AT91SAM7S64.h **** //* \brief Disable VREG Low Power Mode
1632:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1633:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Disable_LowPowerMode(
1634:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1635:lib_AT91SAM7S64.h **** {
1636:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR &= ~AT91C_VREG_PSTDBY;	 
1637:lib_AT91SAM7S64.h **** }/* *****************************************************************************
1638:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR MC
1639:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1640:lib_AT91SAM7S64.h **** 
1641:lib_AT91SAM7S64.h **** #define AT91C_MC_CORRECT_KEY  ((unsigned int) 0x5A << 24) // (MC) Correct Protect Key
1642:lib_AT91SAM7S64.h **** 
1643:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1644:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_Remap
1645:lib_AT91SAM7S64.h **** //* \brief Make Remap
1646:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1647:lib_AT91SAM7S64.h **** __inline void AT91F_MC_Remap (void)     //  
1648:lib_AT91SAM7S64.h **** {
1649:lib_AT91SAM7S64.h ****     AT91PS_MC pMC = (AT91PS_MC) AT91C_BASE_MC;
1650:lib_AT91SAM7S64.h ****     
1651:lib_AT91SAM7S64.h ****     pMC->MC_RCR = AT91C_MC_RCB;
1652:lib_AT91SAM7S64.h **** }
1653:lib_AT91SAM7S64.h **** 
1654:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1655:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_CfgModeReg
1656:lib_AT91SAM7S64.h **** //* \brief Configure the EFC Mode Register of the MC controller
1657:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1658:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_CfgModeReg (
1659:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1660:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
1661:lib_AT91SAM7S64.h **** {
1662:lib_AT91SAM7S64.h **** 	// Write to the FMR register
1663:lib_AT91SAM7S64.h **** 	pMC->MC_FMR = mode;
1664:lib_AT91SAM7S64.h **** }
1665:lib_AT91SAM7S64.h **** 
1666:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1667:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetModeReg
1668:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1669:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1670:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetModeReg(
1671:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1672:lib_AT91SAM7S64.h **** {
1673:lib_AT91SAM7S64.h **** 	return pMC->MC_FMR;
1674:lib_AT91SAM7S64.h **** }
1675:lib_AT91SAM7S64.h **** 
1676:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1677:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_ComputeFMCN
1678:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1679:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1680:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_ComputeFMCN(
1681:lib_AT91SAM7S64.h **** 	int master_clock) // master clock in Hz
1682:lib_AT91SAM7S64.h **** {
1683:lib_AT91SAM7S64.h **** 	return (master_clock/1000000 +2);
1684:lib_AT91SAM7S64.h **** }
1685:lib_AT91SAM7S64.h **** 
1686:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1687:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_PerformCmd
1688:lib_AT91SAM7S64.h **** //* \brief Perform EFC Command
1689:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1690:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_PerformCmd (
1691:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1692:lib_AT91SAM7S64.h ****     unsigned int transfer_cmd)
1693:lib_AT91SAM7S64.h **** {
1694:lib_AT91SAM7S64.h **** 	pMC->MC_FCR = transfer_cmd;	
1695:lib_AT91SAM7S64.h **** }
1696:lib_AT91SAM7S64.h **** 
1697:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1698:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetStatus
1699:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Status
1700:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1701:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetStatus(
1702:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1703:lib_AT91SAM7S64.h **** {
1704:lib_AT91SAM7S64.h **** 	return pMC->MC_FSR;
1705:lib_AT91SAM7S64.h **** }
1706:lib_AT91SAM7S64.h **** 
1707:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1708:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptMasked
1709:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Masked 
1710:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1711:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptMasked(
1712:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1713:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1714:lib_AT91SAM7S64.h **** {
1715:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetModeReg(pMC) & flag);
1716:lib_AT91SAM7S64.h **** }
1717:lib_AT91SAM7S64.h **** 
1718:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1719:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptSet
1720:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Set
1721:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1722:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptSet(
1723:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1724:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1725:lib_AT91SAM7S64.h **** {
1726:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetStatus(pMC) & flag);
1727:lib_AT91SAM7S64.h **** }
1728:lib_AT91SAM7S64.h **** 
1729:lib_AT91SAM7S64.h **** /* *****************************************************************************
1730:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SPI
1731:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1732:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1733:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgCs
1734:lib_AT91SAM7S64.h **** //* \brief Configure SPI chip select register
1735:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1736:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgCs (
1737:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1738:lib_AT91SAM7S64.h **** 	int cs,     // SPI cs number (0 to 3)
1739:lib_AT91SAM7S64.h ****  	int val)   //  chip select register
1740:lib_AT91SAM7S64.h **** {
1741:lib_AT91SAM7S64.h **** 	//* Write to the CSR register
1742:lib_AT91SAM7S64.h **** 	*(pSPI->SPI_CSR + cs) = val;
1743:lib_AT91SAM7S64.h **** }
1744:lib_AT91SAM7S64.h **** 
1745:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1746:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_EnableIt
1747:lib_AT91SAM7S64.h **** //* \brief Enable SPI interrupt
1748:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1749:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_EnableIt (
1750:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1751:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1752:lib_AT91SAM7S64.h **** {
1753:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1754:lib_AT91SAM7S64.h **** 	pSPI->SPI_IER = flag;
1755:lib_AT91SAM7S64.h **** }
1756:lib_AT91SAM7S64.h **** 
1757:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1758:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_DisableIt
1759:lib_AT91SAM7S64.h **** //* \brief Disable SPI interrupt
1760:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1761:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_DisableIt (
1762:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1763:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1764:lib_AT91SAM7S64.h **** {
1765:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1766:lib_AT91SAM7S64.h **** 	pSPI->SPI_IDR = flag;
1767:lib_AT91SAM7S64.h **** }
1768:lib_AT91SAM7S64.h **** 
1769:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1770:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Reset
1771:lib_AT91SAM7S64.h **** //* \brief Reset the SPI controller
1772:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1773:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Reset (
1774:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1775:lib_AT91SAM7S64.h **** 	)
1776:lib_AT91SAM7S64.h **** {
1777:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1778:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SWRST;
1779:lib_AT91SAM7S64.h **** }
1780:lib_AT91SAM7S64.h **** 
1781:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1782:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Enable
1783:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1784:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1785:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Enable (
1786:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1787:lib_AT91SAM7S64.h **** 	)
1788:lib_AT91SAM7S64.h **** {
1789:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1790:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIEN;
1791:lib_AT91SAM7S64.h **** }
1792:lib_AT91SAM7S64.h **** 
1793:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1794:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Disable
1795:lib_AT91SAM7S64.h **** //* \brief Disable the SPI controller
1796:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1797:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Disable (
1798:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1799:lib_AT91SAM7S64.h **** 	)
1800:lib_AT91SAM7S64.h **** {
1801:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1802:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1803:lib_AT91SAM7S64.h **** }
1804:lib_AT91SAM7S64.h **** 
1805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1806:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgMode
1807:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1808:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1809:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgMode (
1810:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1811:lib_AT91SAM7S64.h **** 	int mode)        // mode register 
1812:lib_AT91SAM7S64.h **** {
1813:lib_AT91SAM7S64.h **** 	//* Write to the MR register
1814:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR = mode;
1815:lib_AT91SAM7S64.h **** }
1816:lib_AT91SAM7S64.h **** 
1817:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1818:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgPCS
1819:lib_AT91SAM7S64.h **** //* \brief Switch to the correct PCS of SPI Mode Register : Fixed Peripheral Selected
1820:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1821:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgPCS (
1822:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1823:lib_AT91SAM7S64.h **** 	char PCS_Device) // PCS of the Device
1824:lib_AT91SAM7S64.h **** {	
1825:lib_AT91SAM7S64.h ****  	//* Write to the MR register
1826:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR &= 0xFFF0FFFF;
1827:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR |= ( (PCS_Device<<16) & AT91C_SPI_PCS );
1828:lib_AT91SAM7S64.h **** }
1829:lib_AT91SAM7S64.h **** 
1830:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1831:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_ReceiveFrame
1832:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1833:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1834:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_ReceiveFrame (
1835:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1836:lib_AT91SAM7S64.h **** 	char *pBuffer,
1837:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1838:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1839:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1840:lib_AT91SAM7S64.h **** {
1841:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
1842:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1843:lib_AT91SAM7S64.h **** 		pBuffer,
1844:lib_AT91SAM7S64.h **** 		szBuffer,
1845:lib_AT91SAM7S64.h **** 		pNextBuffer,
1846:lib_AT91SAM7S64.h **** 		szNextBuffer);
1847:lib_AT91SAM7S64.h **** }
1848:lib_AT91SAM7S64.h **** 
1849:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1850:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_SendFrame
1851:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1852:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1853:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_SendFrame(
1854:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1855:lib_AT91SAM7S64.h **** 	char *pBuffer,
1856:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1857:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1858:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1859:lib_AT91SAM7S64.h **** {
1860:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
1861:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1862:lib_AT91SAM7S64.h **** 		pBuffer,
1863:lib_AT91SAM7S64.h **** 		szBuffer,
1864:lib_AT91SAM7S64.h **** 		pNextBuffer,
1865:lib_AT91SAM7S64.h **** 		szNextBuffer);
1866:lib_AT91SAM7S64.h **** }
1867:lib_AT91SAM7S64.h **** 
1868:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1869:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Close
1870:lib_AT91SAM7S64.h **** //* \brief Close SPI: disable IT disable transfert, close PDC
1871:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1872:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Close (
1873:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI)     // \arg pointer to a SPI controller
1874:lib_AT91SAM7S64.h **** {
1875:lib_AT91SAM7S64.h ****     //* Reset all the Chip Select register
1876:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[0] = 0 ;
1877:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[1] = 0 ;
1878:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[2] = 0 ;
1879:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[3] = 0 ;
1880:lib_AT91SAM7S64.h **** 
1881:lib_AT91SAM7S64.h ****     //* Reset the SPI mode
1882:lib_AT91SAM7S64.h ****     pSPI->SPI_MR = 0  ;
1883:lib_AT91SAM7S64.h **** 
1884:lib_AT91SAM7S64.h ****     //* Disable all interrupts
1885:lib_AT91SAM7S64.h ****     pSPI->SPI_IDR = 0xFFFFFFFF ;
1886:lib_AT91SAM7S64.h **** 
1887:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
1888:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pSPI->SPI_RPR));
1889:lib_AT91SAM7S64.h **** 
1890:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
1891:lib_AT91SAM7S64.h ****     pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1892:lib_AT91SAM7S64.h **** }
1893:lib_AT91SAM7S64.h **** 
1894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1895:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_PutChar
1896:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
1897:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1898:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_PutChar (
1899:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1900:lib_AT91SAM7S64.h **** 	unsigned int character,
1901:lib_AT91SAM7S64.h ****              unsigned int cs_number )
1902:lib_AT91SAM7S64.h **** {
1903:lib_AT91SAM7S64.h ****     unsigned int value_for_cs;
1904:lib_AT91SAM7S64.h ****     value_for_cs = (~(1 << cs_number)) & 0xF;  //Place a zero among a 4 ONEs number
1905:lib_AT91SAM7S64.h ****     pSPI->SPI_TDR = (character & 0xFFFF) | (value_for_cs << 16);
1906:lib_AT91SAM7S64.h **** }
1907:lib_AT91SAM7S64.h **** 
1908:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1909:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetChar
1910:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
1911:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1912:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_GetChar (
1913:lib_AT91SAM7S64.h **** 	const AT91PS_SPI pSPI)
1914:lib_AT91SAM7S64.h **** {
1915:lib_AT91SAM7S64.h ****     return((pSPI->SPI_RDR) & 0xFFFF);
1916:lib_AT91SAM7S64.h **** }
1917:lib_AT91SAM7S64.h **** 
1918:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1919:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetInterruptMaskStatus
1920:lib_AT91SAM7S64.h **** //* \brief Return SPI Interrupt Mask Status
1921:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1922:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_GetInterruptMaskStatus( // \return SPI Interrupt Mask Status
1923:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi) // \arg  pointer to a SPI controller
1924:lib_AT91SAM7S64.h **** {
1925:lib_AT91SAM7S64.h ****         return pSpi->SPI_IMR;
1926:lib_AT91SAM7S64.h **** }
1927:lib_AT91SAM7S64.h **** 
1928:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1929:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_IsInterruptMasked
1930:lib_AT91SAM7S64.h **** //* \brief Test if SPI Interrupt is Masked 
1931:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1932:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_IsInterruptMasked(
1933:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi,   // \arg  pointer to a SPI controller
1934:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1935:lib_AT91SAM7S64.h **** {
1936:lib_AT91SAM7S64.h ****         return (AT91F_SPI_GetInterruptMaskStatus(pSpi) & flag);
1937:lib_AT91SAM7S64.h **** }
1938:lib_AT91SAM7S64.h **** 
1939:lib_AT91SAM7S64.h **** /* *****************************************************************************
1940:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR ADC
1941:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1942:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1943:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableIt
1944:lib_AT91SAM7S64.h **** //* \brief Enable ADC interrupt
1945:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1946:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableIt (
1947:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC,     // pointer to a ADC controller
1948:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1949:lib_AT91SAM7S64.h **** {
1950:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1951:lib_AT91SAM7S64.h **** 	pADC->ADC_IER = flag;
1952:lib_AT91SAM7S64.h **** }
1953:lib_AT91SAM7S64.h **** 
1954:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1955:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableIt
1956:lib_AT91SAM7S64.h **** //* \brief Disable ADC interrupt
1957:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1958:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableIt (
1959:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
1960:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1961:lib_AT91SAM7S64.h **** {
1962:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1963:lib_AT91SAM7S64.h **** 	pADC->ADC_IDR = flag;
1964:lib_AT91SAM7S64.h **** }
1965:lib_AT91SAM7S64.h **** 
1966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1967:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetStatus
1968:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Status
1969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1970:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetStatus( // \return ADC Interrupt Status
1971:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1972:lib_AT91SAM7S64.h **** {
1973:lib_AT91SAM7S64.h **** 	return pADC->ADC_SR;
1974:lib_AT91SAM7S64.h **** }
1975:lib_AT91SAM7S64.h **** 
1976:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1977:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetInterruptMaskStatus
1978:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Mask Status
1979:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1980:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetInterruptMaskStatus( // \return ADC Interrupt Mask Status
1981:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1982:lib_AT91SAM7S64.h **** {
1983:lib_AT91SAM7S64.h **** 	return pADC->ADC_IMR;
1984:lib_AT91SAM7S64.h **** }
1985:lib_AT91SAM7S64.h **** 
1986:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1987:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsInterruptMasked
1988:lib_AT91SAM7S64.h **** //* \brief Test if ADC Interrupt is Masked 
1989:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1990:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsInterruptMasked(
1991:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
1992:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1993:lib_AT91SAM7S64.h **** {
1994:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetInterruptMaskStatus(pADC) & flag);
1995:lib_AT91SAM7S64.h **** }
1996:lib_AT91SAM7S64.h **** 
1997:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1998:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsStatusSet
1999:lib_AT91SAM7S64.h **** //* \brief Test if ADC Status is Set
2000:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2001:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsStatusSet(
2002:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
2003:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2004:lib_AT91SAM7S64.h **** {
2005:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetStatus(pADC) & flag);
2006:lib_AT91SAM7S64.h **** }
2007:lib_AT91SAM7S64.h **** 
2008:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2009:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgModeReg
2010:lib_AT91SAM7S64.h **** //* \brief Configure the Mode Register of the ADC controller
2011:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2012:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgModeReg (
2013:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2014:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
2015:lib_AT91SAM7S64.h **** {
2016:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2017:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = mode;
2018:lib_AT91SAM7S64.h **** }
2019:lib_AT91SAM7S64.h **** 
2020:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2021:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetModeReg
2022:lib_AT91SAM7S64.h **** //* \brief Return the Mode Register of the ADC controller value
2023:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2024:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetModeReg (
2025:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2026:lib_AT91SAM7S64.h **** 	)
2027:lib_AT91SAM7S64.h **** {
2028:lib_AT91SAM7S64.h **** 	return pADC->ADC_MR;	
2029:lib_AT91SAM7S64.h **** }
2030:lib_AT91SAM7S64.h **** 
2031:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2032:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgTimings
2033:lib_AT91SAM7S64.h **** //* \brief Configure the different necessary timings of the ADC controller
2034:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2035:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgTimings (
2036:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2037:lib_AT91SAM7S64.h **** 	unsigned int mck_clock, // in MHz 
2038:lib_AT91SAM7S64.h **** 	unsigned int adc_clock, // in MHz 
2039:lib_AT91SAM7S64.h **** 	unsigned int startup_time, // in us 
2040:lib_AT91SAM7S64.h **** 	unsigned int sample_and_hold_time)	// in ns  
2041:lib_AT91SAM7S64.h **** {
2042:lib_AT91SAM7S64.h **** 	unsigned int prescal,startup,shtim;
2043:lib_AT91SAM7S64.h **** 	
2044:lib_AT91SAM7S64.h **** 	prescal = mck_clock/(2*adc_clock) - 1;
2045:lib_AT91SAM7S64.h **** 	startup = adc_clock*startup_time/8 - 1;
2046:lib_AT91SAM7S64.h **** 	shtim = adc_clock*sample_and_hold_time/1000 - 1;
2047:lib_AT91SAM7S64.h **** 	
2048:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2049:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = ( (prescal<<8) & AT91C_ADC_PRESCAL) | ( (startup<<16) & AT91C_ADC_STARTUP) | ( (sht
2050:lib_AT91SAM7S64.h **** }
2051:lib_AT91SAM7S64.h **** 
2052:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2053:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableChannel
2054:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2055:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2056:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableChannel (
2057:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2058:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2059:lib_AT91SAM7S64.h **** {
2060:lib_AT91SAM7S64.h **** 	//* Write to the CHER register
2061:lib_AT91SAM7S64.h **** 	pADC->ADC_CHER = channel;
2062:lib_AT91SAM7S64.h **** }
2063:lib_AT91SAM7S64.h **** 
2064:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2065:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableChannel
2066:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2067:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2068:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableChannel (
2069:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2070:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2071:lib_AT91SAM7S64.h **** {
2072:lib_AT91SAM7S64.h **** 	//* Write to the CHDR register
2073:lib_AT91SAM7S64.h **** 	pADC->ADC_CHDR = channel;
2074:lib_AT91SAM7S64.h **** }
2075:lib_AT91SAM7S64.h **** 
2076:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2077:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetChannelStatus
2078:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2079:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2080:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetChannelStatus (
2081:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2082:lib_AT91SAM7S64.h **** 	)
2083:lib_AT91SAM7S64.h **** {
2084:lib_AT91SAM7S64.h **** 	return pADC->ADC_CHSR;	
2085:lib_AT91SAM7S64.h **** }
2086:lib_AT91SAM7S64.h **** 
2087:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2088:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_StartConversion
2089:lib_AT91SAM7S64.h **** //* \brief Software request for a analog to digital conversion 
2090:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2091:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_StartConversion (
2092:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2093:lib_AT91SAM7S64.h **** 	)
2094:lib_AT91SAM7S64.h **** {
2095:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_START;	
2096:lib_AT91SAM7S64.h **** }
2097:lib_AT91SAM7S64.h **** 
2098:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2099:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_SoftReset
2100:lib_AT91SAM7S64.h **** //* \brief Software reset
2101:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2102:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_SoftReset (
2103:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2104:lib_AT91SAM7S64.h **** 	)
2105:lib_AT91SAM7S64.h **** {
2106:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_SWRST;	
2107:lib_AT91SAM7S64.h **** }
2108:lib_AT91SAM7S64.h **** 
2109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2110:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetLastConvertedData
2111:lib_AT91SAM7S64.h **** //* \brief Return the Last Converted Data
2112:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2113:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetLastConvertedData (
2114:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2115:lib_AT91SAM7S64.h **** 	)
2116:lib_AT91SAM7S64.h **** {
2117:lib_AT91SAM7S64.h **** 	return pADC->ADC_LCDR;	
2118:lib_AT91SAM7S64.h **** }
2119:lib_AT91SAM7S64.h **** 
2120:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2121:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH0
2122:lib_AT91SAM7S64.h **** //* \brief Return the Channel 0 Converted Data
2123:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2124:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH0 (
2125:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2126:lib_AT91SAM7S64.h **** 	)
2127:lib_AT91SAM7S64.h **** {
2128:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR0;	
2129:lib_AT91SAM7S64.h **** }
2130:lib_AT91SAM7S64.h **** 
2131:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2132:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH1
2133:lib_AT91SAM7S64.h **** //* \brief Return the Channel 1 Converted Data
2134:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2135:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH1 (
2136:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2137:lib_AT91SAM7S64.h **** 	)
2138:lib_AT91SAM7S64.h **** {
2139:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR1;	
2140:lib_AT91SAM7S64.h **** }
2141:lib_AT91SAM7S64.h **** 
2142:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2143:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH2
2144:lib_AT91SAM7S64.h **** //* \brief Return the Channel 2 Converted Data
2145:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2146:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH2 (
2147:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2148:lib_AT91SAM7S64.h **** 	)
2149:lib_AT91SAM7S64.h **** {
2150:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR2;	
2151:lib_AT91SAM7S64.h **** }
2152:lib_AT91SAM7S64.h **** 
2153:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2154:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH3
2155:lib_AT91SAM7S64.h **** //* \brief Return the Channel 3 Converted Data
2156:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2157:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH3 (
2158:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2159:lib_AT91SAM7S64.h **** 	)
2160:lib_AT91SAM7S64.h **** {
2161:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR3;	
2162:lib_AT91SAM7S64.h **** }
2163:lib_AT91SAM7S64.h **** 
2164:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2165:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH4
2166:lib_AT91SAM7S64.h **** //* \brief Return the Channel 4 Converted Data
2167:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2168:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH4 (
2169:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2170:lib_AT91SAM7S64.h **** 	)
2171:lib_AT91SAM7S64.h **** {
2172:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR4;	
2173:lib_AT91SAM7S64.h **** }
2174:lib_AT91SAM7S64.h **** 
2175:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2176:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH5
2177:lib_AT91SAM7S64.h **** //* \brief Return the Channel 5 Converted Data
2178:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2179:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH5 (
2180:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2181:lib_AT91SAM7S64.h **** 	)
2182:lib_AT91SAM7S64.h **** {
2183:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR5;	
2184:lib_AT91SAM7S64.h **** }
2185:lib_AT91SAM7S64.h **** 
2186:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2187:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH6
2188:lib_AT91SAM7S64.h **** //* \brief Return the Channel 6 Converted Data
2189:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2190:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH6 (
2191:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2192:lib_AT91SAM7S64.h **** 	)
2193:lib_AT91SAM7S64.h **** {
2194:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR6;	
2195:lib_AT91SAM7S64.h **** }
2196:lib_AT91SAM7S64.h **** 
2197:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2198:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH7
2199:lib_AT91SAM7S64.h **** //* \brief Return the Channel 7 Converted Data
2200:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2201:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH7 (
2202:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2203:lib_AT91SAM7S64.h **** 	)
2204:lib_AT91SAM7S64.h **** {
2205:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR7;	
2206:lib_AT91SAM7S64.h **** }
2207:lib_AT91SAM7S64.h **** 
2208:lib_AT91SAM7S64.h **** /* *****************************************************************************
2209:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SSC
2210:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2211:lib_AT91SAM7S64.h **** //* Define the standard I2S mode configuration
2212:lib_AT91SAM7S64.h **** 
2213:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Clock Mode Register
2214:lib_AT91SAM7S64.h **** //* Parameters :  nb_bit_by_slot : 8, 16 or 32 bits
2215:lib_AT91SAM7S64.h **** //* 			  nb_slot_by_frame : number of channels
2216:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_MASTER_TX_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2217:lib_AT91SAM7S64.h **** 									   AT91C_SSC_CKS_DIV   +\
2218:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKO_CONTINOUS      +\
2219:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKG_NONE    +\
2220:lib_AT91SAM7S64.h ****                                        AT91C_SSC_START_FALL_RF +\
2221:lib_AT91SAM7S64.h ****                            			   AT91C_SSC_STTOUT  +\
2222:lib_AT91SAM7S64.h ****                             		   ((1<<16) & AT91C_SSC_STTDLY) +\
2223:lib_AT91SAM7S64.h ****                             		   ((((nb_bit_by_slot*nb_slot_by_frame)/2)-1) <<24))
2224:lib_AT91SAM7S64.h **** 
2225:lib_AT91SAM7S64.h **** 
2226:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Frame Mode Register
2227:lib_AT91SAM7S64.h **** //* Parameters : nb_bit_by_slot : 8, 16 or 32 bits
2228:lib_AT91SAM7S64.h **** //* 			 nb_slot_by_frame : number of channels
2229:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_TX_FRAME_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2230:lib_AT91SAM7S64.h **** 									(nb_bit_by_slot-1)  +\
2231:lib_AT91SAM7S64.h ****                             		AT91C_SSC_MSBF   +\
2232:lib_AT91SAM7S64.h ****                             		(((nb_slot_by_frame-1)<<8) & AT91C_SSC_DATNB)  +\
2233:lib_AT91SAM7S64.h ****                             		(((nb_bit_by_slot-1)<<16) & AT91C_SSC_FSLEN) +\
2234:lib_AT91SAM7S64.h ****                             		AT91C_SSC_FSOS_NEGATIVE)
2235:lib_AT91SAM7S64.h **** 
2236:lib_AT91SAM7S64.h **** 
2237:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2238:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SetBaudrate
2239:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2240:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2241:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_SetBaudrate (
2242:lib_AT91SAM7S64.h ****         AT91PS_SSC pSSC,        // \arg pointer to a SSC controller
2243:lib_AT91SAM7S64.h ****         unsigned int mainClock, // \arg peripheral clock
2244:lib_AT91SAM7S64.h ****         unsigned int speed)     // \arg SSC baudrate
2245:lib_AT91SAM7S64.h **** {
2246:lib_AT91SAM7S64.h ****         unsigned int baud_value;
2247:lib_AT91SAM7S64.h ****         //* Define the baud rate divisor register
2248:lib_AT91SAM7S64.h ****         if (speed == 0)
2249:lib_AT91SAM7S64.h ****            baud_value = 0;
2250:lib_AT91SAM7S64.h ****         else
2251:lib_AT91SAM7S64.h ****         {
2252:lib_AT91SAM7S64.h ****            baud_value = (unsigned int) (mainClock * 10)/(2*speed);
2253:lib_AT91SAM7S64.h ****            if ((baud_value % 10) >= 5)
2254:lib_AT91SAM7S64.h ****                   baud_value = (baud_value / 10) + 1;
2255:lib_AT91SAM7S64.h ****            else
2256:lib_AT91SAM7S64.h ****                   baud_value /= 10;
2257:lib_AT91SAM7S64.h ****         }
2258:lib_AT91SAM7S64.h **** 
2259:lib_AT91SAM7S64.h ****         pSSC->SSC_CMR = baud_value;
2260:lib_AT91SAM7S64.h **** }
2261:lib_AT91SAM7S64.h **** 
2262:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2263:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_Configure
2264:lib_AT91SAM7S64.h **** //* \brief Configure SSC
2265:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2266:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_Configure (
2267:lib_AT91SAM7S64.h ****              AT91PS_SSC pSSC,          // \arg pointer to a SSC controller
2268:lib_AT91SAM7S64.h ****              unsigned int syst_clock,  // \arg System Clock Frequency
2269:lib_AT91SAM7S64.h ****              unsigned int baud_rate,   // \arg Expected Baud Rate Frequency
2270:lib_AT91SAM7S64.h ****              unsigned int clock_rx,    // \arg Receiver Clock Parameters
2271:lib_AT91SAM7S64.h ****              unsigned int mode_rx,     // \arg mode Register to be programmed
2272:lib_AT91SAM7S64.h ****              unsigned int clock_tx,    // \arg Transmitter Clock Parameters
2273:lib_AT91SAM7S64.h ****              unsigned int mode_tx)     // \arg mode Register to be programmed
2274:lib_AT91SAM7S64.h **** {
2275:lib_AT91SAM7S64.h ****     //* Disable interrupts
2276:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = (unsigned int) -1;
2277:lib_AT91SAM7S64.h **** 
2278:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2279:lib_AT91SAM7S64.h **** 	pSSC->SSC_CR = AT91C_SSC_SWRST | AT91C_SSC_RXDIS | AT91C_SSC_TXDIS ;
2280:lib_AT91SAM7S64.h **** 
2281:lib_AT91SAM7S64.h ****     //* Define the Clock Mode Register
2282:lib_AT91SAM7S64.h **** 	AT91F_SSC_SetBaudrate(pSSC, syst_clock, baud_rate);
2283:lib_AT91SAM7S64.h **** 
2284:lib_AT91SAM7S64.h ****      //* Write the Receive Clock Mode Register
2285:lib_AT91SAM7S64.h **** 	pSSC->SSC_RCMR =  clock_rx;
2286:lib_AT91SAM7S64.h **** 
2287:lib_AT91SAM7S64.h ****      //* Write the Transmit Clock Mode Register
2288:lib_AT91SAM7S64.h **** 	pSSC->SSC_TCMR =  clock_tx;
2289:lib_AT91SAM7S64.h **** 
2290:lib_AT91SAM7S64.h ****      //* Write the Receive Frame Mode Register
2291:lib_AT91SAM7S64.h **** 	pSSC->SSC_RFMR =  mode_rx;
2292:lib_AT91SAM7S64.h **** 
2293:lib_AT91SAM7S64.h ****      //* Write the Transmit Frame Mode Register
2294:lib_AT91SAM7S64.h **** 	pSSC->SSC_TFMR =  mode_tx;
2295:lib_AT91SAM7S64.h **** 
2296:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2297:lib_AT91SAM7S64.h **** 	AT91F_PDC_Open((AT91PS_PDC) &(pSSC->SSC_RPR));
2298:lib_AT91SAM7S64.h **** 
2299:lib_AT91SAM7S64.h **** 
2300:lib_AT91SAM7S64.h **** }
2301:lib_AT91SAM7S64.h **** 
2302:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2303:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableRx
2304:lib_AT91SAM7S64.h **** //* \brief Enable receiving datas
2305:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2306:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableRx (
2307:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2308:lib_AT91SAM7S64.h **** {
2309:lib_AT91SAM7S64.h ****     //* Enable receiver
2310:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXEN;
2311:lib_AT91SAM7S64.h **** }
2312:lib_AT91SAM7S64.h **** 
2313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2314:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableRx
2315:lib_AT91SAM7S64.h **** //* \brief Disable receiving datas
2316:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2317:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableRx (
2318:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2319:lib_AT91SAM7S64.h **** {
2320:lib_AT91SAM7S64.h ****     //* Disable receiver
2321:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXDIS;
2322:lib_AT91SAM7S64.h **** }
2323:lib_AT91SAM7S64.h **** 
2324:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2325:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableTx
2326:lib_AT91SAM7S64.h **** //* \brief Enable sending datas
2327:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2328:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableTx (
2329:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2330:lib_AT91SAM7S64.h **** {
2331:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2332:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXEN;
2333:lib_AT91SAM7S64.h **** }
2334:lib_AT91SAM7S64.h **** 
2335:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2336:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableTx
2337:lib_AT91SAM7S64.h **** //* \brief Disable sending datas
2338:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2339:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableTx (
2340:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2341:lib_AT91SAM7S64.h **** {
2342:lib_AT91SAM7S64.h ****     //* Disable  transmitter
2343:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXDIS;
2344:lib_AT91SAM7S64.h **** }
2345:lib_AT91SAM7S64.h **** 
2346:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2347:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableIt
2348:lib_AT91SAM7S64.h **** //* \brief Enable SSC IT
2349:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2350:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableIt (
2351:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2352:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2353:lib_AT91SAM7S64.h **** {
2354:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2355:lib_AT91SAM7S64.h **** 	pSSC->SSC_IER = flag;
2356:lib_AT91SAM7S64.h **** }
2357:lib_AT91SAM7S64.h **** 
2358:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2359:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableIt
2360:lib_AT91SAM7S64.h **** //* \brief Disable SSC IT
2361:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2362:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableIt (
2363:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2364:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2365:lib_AT91SAM7S64.h **** {
2366:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
2367:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = flag;
2368:lib_AT91SAM7S64.h **** }
2369:lib_AT91SAM7S64.h **** 
2370:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2371:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_ReceiveFrame
2372:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2373:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2374:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_ReceiveFrame (
2375:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2376:lib_AT91SAM7S64.h **** 	char *pBuffer,
2377:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2378:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2379:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2380:lib_AT91SAM7S64.h **** {
2381:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
2382:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2383:lib_AT91SAM7S64.h **** 		pBuffer,
2384:lib_AT91SAM7S64.h **** 		szBuffer,
2385:lib_AT91SAM7S64.h **** 		pNextBuffer,
2386:lib_AT91SAM7S64.h **** 		szNextBuffer);
2387:lib_AT91SAM7S64.h **** }
2388:lib_AT91SAM7S64.h **** 
2389:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2390:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SendFrame
2391:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2392:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2393:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_SendFrame(
2394:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2395:lib_AT91SAM7S64.h **** 	char *pBuffer,
2396:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2397:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2398:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2399:lib_AT91SAM7S64.h **** {
2400:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
2401:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2402:lib_AT91SAM7S64.h **** 		pBuffer,
2403:lib_AT91SAM7S64.h **** 		szBuffer,
2404:lib_AT91SAM7S64.h **** 		pNextBuffer,
2405:lib_AT91SAM7S64.h **** 		szNextBuffer);
2406:lib_AT91SAM7S64.h **** }
2407:lib_AT91SAM7S64.h **** 
2408:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2409:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_GetInterruptMaskStatus
2410:lib_AT91SAM7S64.h **** //* \brief Return SSC Interrupt Mask Status
2411:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2412:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_GetInterruptMaskStatus( // \return SSC Interrupt Mask Status
2413:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc) // \arg  pointer to a SSC controller
2414:lib_AT91SAM7S64.h **** {
2415:lib_AT91SAM7S64.h ****         return pSsc->SSC_IMR;
2416:lib_AT91SAM7S64.h **** }
2417:lib_AT91SAM7S64.h **** 
2418:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2419:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_IsInterruptMasked
2420:lib_AT91SAM7S64.h **** //* \brief Test if SSC Interrupt is Masked 
2421:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2422:lib_AT91SAM7S64.h **** __inline int AT91F_SSC_IsInterruptMasked(
2423:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc,   // \arg  pointer to a SSC controller
2424:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2425:lib_AT91SAM7S64.h **** {
2426:lib_AT91SAM7S64.h ****         return (AT91F_SSC_GetInterruptMaskStatus(pSsc) & flag);
2427:lib_AT91SAM7S64.h **** }
2428:lib_AT91SAM7S64.h **** 
2429:lib_AT91SAM7S64.h **** /* *****************************************************************************
2430:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR USART
2431:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2432:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2433:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2434:lib_AT91SAM7S64.h **** //* \brief Calculate the baudrate
2435:lib_AT91SAM7S64.h **** //* Standard Asynchronous Mode : 8 bits , 1 stop , no parity
2436:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_MODE ( AT91C_US_USMODE_NORMAL + \
2437:lib_AT91SAM7S64.h ****                         AT91C_US_NBSTOP_1_BIT + \
2438:lib_AT91SAM7S64.h ****                         AT91C_US_PAR_NONE + \
2439:lib_AT91SAM7S64.h ****                         AT91C_US_CHRL_8_BITS + \
2440:lib_AT91SAM7S64.h ****                         AT91C_US_CLKS_CLOCK )
2441:lib_AT91SAM7S64.h **** 
2442:lib_AT91SAM7S64.h **** //* Standard External Asynchronous Mode : 8 bits , 1 stop , no parity
2443:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_SCK_MODE ( AT91C_US_USMODE_NORMAL + \
2444:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2445:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2446:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2447:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_EXT )
2448:lib_AT91SAM7S64.h **** 
2449:lib_AT91SAM7S64.h **** //* Standard Synchronous Mode : 8 bits , 1 stop , no parity
2450:lib_AT91SAM7S64.h **** #define AT91C_US_SYNC_MODE ( AT91C_US_SYNC + \
2451:lib_AT91SAM7S64.h ****                        AT91C_US_USMODE_NORMAL + \
2452:lib_AT91SAM7S64.h ****                        AT91C_US_NBSTOP_1_BIT + \
2453:lib_AT91SAM7S64.h ****                        AT91C_US_PAR_NONE + \
2454:lib_AT91SAM7S64.h ****                        AT91C_US_CHRL_8_BITS + \
2455:lib_AT91SAM7S64.h ****                        AT91C_US_CLKS_CLOCK )
2456:lib_AT91SAM7S64.h **** 
2457:lib_AT91SAM7S64.h **** //* SCK used Label
2458:lib_AT91SAM7S64.h **** #define AT91C_US_SCK_USED (AT91C_US_CKLO | AT91C_US_CLKS_EXT)
2459:lib_AT91SAM7S64.h **** 
2460:lib_AT91SAM7S64.h **** //* Standard ISO T=0 Mode : 8 bits , 1 stop , parity
2461:lib_AT91SAM7S64.h **** #define AT91C_US_ISO_READER_MODE ( AT91C_US_USMODE_ISO7816_0 + \
2462:lib_AT91SAM7S64.h **** 					   		 AT91C_US_CLKS_CLOCK +\
2463:lib_AT91SAM7S64.h ****                        		 AT91C_US_NBSTOP_1_BIT + \
2464:lib_AT91SAM7S64.h ****                        		 AT91C_US_PAR_EVEN + \
2465:lib_AT91SAM7S64.h ****                        		 AT91C_US_CHRL_8_BITS + \
2466:lib_AT91SAM7S64.h ****                        		 AT91C_US_CKLO +\
2467:lib_AT91SAM7S64.h ****                        		 AT91C_US_OVER)
2468:lib_AT91SAM7S64.h **** 
2469:lib_AT91SAM7S64.h **** //* Standard IRDA mode
2470:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_IRDA_MODE (  AT91C_US_USMODE_IRDA + \
2471:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2472:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2473:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2474:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_CLOCK )
2475:lib_AT91SAM7S64.h **** 
2476:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2477:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2478:lib_AT91SAM7S64.h **** //* \brief Caluculate baud_value according to the main clock and the baud rate
2479:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2480:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Baudrate (
2481:lib_AT91SAM7S64.h **** 	const unsigned int main_clock, // \arg peripheral clock
2482:lib_AT91SAM7S64.h **** 	const unsigned int baud_rate)  // \arg UART baudrate
2483:lib_AT91SAM7S64.h **** {
2484:lib_AT91SAM7S64.h **** 	unsigned int baud_value = ((main_clock*10)/(baud_rate * 16));
2485:lib_AT91SAM7S64.h **** 	if ((baud_value % 10) >= 5)
2486:lib_AT91SAM7S64.h **** 		baud_value = (baud_value / 10) + 1;
2487:lib_AT91SAM7S64.h **** 	else
2488:lib_AT91SAM7S64.h **** 		baud_value /= 10;
2489:lib_AT91SAM7S64.h **** 	return baud_value;
2490:lib_AT91SAM7S64.h **** }
2491:lib_AT91SAM7S64.h **** 
2492:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2493:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetBaudrate
2494:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2495:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2496:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetBaudrate (
2497:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2498:lib_AT91SAM7S64.h **** 	unsigned int mainClock, // \arg peripheral clock
2499:lib_AT91SAM7S64.h **** 	unsigned int speed)     // \arg UART baudrate
2500:lib_AT91SAM7S64.h **** {
2501:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2502:lib_AT91SAM7S64.h **** 	pUSART->US_BRGR = AT91F_US_Baudrate(mainClock, speed);
2503:lib_AT91SAM7S64.h **** }
2504:lib_AT91SAM7S64.h **** 
2505:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2506:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetTimeguard
2507:lib_AT91SAM7S64.h **** //* \brief Set USART timeguard
2508:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2509:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetTimeguard (
2510:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2511:lib_AT91SAM7S64.h **** 	unsigned int timeguard) // \arg timeguard value
2512:lib_AT91SAM7S64.h **** {
2513:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2514:lib_AT91SAM7S64.h **** 	pUSART->US_TTGR = timeguard ;
2515:lib_AT91SAM7S64.h **** }
2516:lib_AT91SAM7S64.h **** 
2517:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2518:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableIt
2519:lib_AT91SAM7S64.h **** //* \brief Enable USART IT
2520:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2521:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableIt (
2522:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2523:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2524:lib_AT91SAM7S64.h **** {
2525:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2526:lib_AT91SAM7S64.h **** 	pUSART->US_IER = flag;
2527:lib_AT91SAM7S64.h **** }
2528:lib_AT91SAM7S64.h **** 
2529:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2530:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableIt
2531:lib_AT91SAM7S64.h **** //* \brief Disable USART IT
2532:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2533:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableIt (
2534:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2535:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2536:lib_AT91SAM7S64.h **** {
2537:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2538:lib_AT91SAM7S64.h **** 	pUSART->US_IDR = flag;
2539:lib_AT91SAM7S64.h **** }
2540:lib_AT91SAM7S64.h **** 
2541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2542:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Configure
2543:lib_AT91SAM7S64.h **** //* \brief Configure USART
2544:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2545:lib_AT91SAM7S64.h **** __inline void AT91F_US_Configure (
2546:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,     // \arg pointer to a USART controller
2547:lib_AT91SAM7S64.h **** 	unsigned int mainClock,  // \arg peripheral clock
2548:lib_AT91SAM7S64.h **** 	unsigned int mode ,      // \arg mode Register to be programmed
2549:lib_AT91SAM7S64.h **** 	unsigned int baudRate ,  // \arg baudrate to be programmed
2550:lib_AT91SAM7S64.h **** 	unsigned int timeguard ) // \arg timeguard to be programmed
2551:lib_AT91SAM7S64.h **** {
2552:lib_AT91SAM7S64.h ****     //* Disable interrupts
2553:lib_AT91SAM7S64.h ****     pUSART->US_IDR = (unsigned int) -1;
2554:lib_AT91SAM7S64.h **** 
2555:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2556:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RSTRX | AT91C_US_RSTTX | AT91C_US_RXDIS | AT91C_US_TXDIS ;
2557:lib_AT91SAM7S64.h **** 
2558:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2559:lib_AT91SAM7S64.h **** 	AT91F_US_SetBaudrate(pUSART, mainClock, baudRate);
2560:lib_AT91SAM7S64.h **** 
2561:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2562:lib_AT91SAM7S64.h **** 	AT91F_US_SetTimeguard(pUSART, timeguard);
2563:lib_AT91SAM7S64.h **** 
2564:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2565:lib_AT91SAM7S64.h ****     AT91F_PDC_Open((AT91PS_PDC) &(pUSART->US_RPR));
2566:lib_AT91SAM7S64.h **** 
2567:lib_AT91SAM7S64.h ****     //* Define the USART mode
2568:lib_AT91SAM7S64.h ****     pUSART->US_MR = mode  ;
2569:lib_AT91SAM7S64.h **** 
2570:lib_AT91SAM7S64.h **** }
2571:lib_AT91SAM7S64.h **** 
2572:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2573:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableRx
2574:lib_AT91SAM7S64.h **** //* \brief Enable receiving characters
2575:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2576:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableRx (
2577:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2578:lib_AT91SAM7S64.h **** {
2579:lib_AT91SAM7S64.h ****     //* Enable receiver
2580:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2581:lib_AT91SAM7S64.h **** }
2582:lib_AT91SAM7S64.h **** 
2583:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2584:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableTx
2585:lib_AT91SAM7S64.h **** //* \brief Enable sending characters
2586:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2587:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableTx (
2588:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2589:lib_AT91SAM7S64.h **** {
2590:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2591:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2592:lib_AT91SAM7S64.h **** }
2593:lib_AT91SAM7S64.h **** 
2594:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2595:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetRx
2596:lib_AT91SAM7S64.h **** //* \brief Reset Receiver and re-enable it
2597:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2598:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetRx (
2599:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2600:lib_AT91SAM7S64.h **** {
2601:lib_AT91SAM7S64.h **** 	//* Reset receiver
2602:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTRX;
2603:lib_AT91SAM7S64.h ****     //* Re-Enable receiver
2604:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2605:lib_AT91SAM7S64.h **** }
2606:lib_AT91SAM7S64.h **** 
2607:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2608:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetTx
2609:lib_AT91SAM7S64.h **** //* \brief Reset Transmitter and re-enable it
2610:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2611:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetTx (
2612:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2613:lib_AT91SAM7S64.h **** {
2614:lib_AT91SAM7S64.h **** 	//* Reset transmitter
2615:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTTX;
2616:lib_AT91SAM7S64.h ****     //* Enable transmitter
2617:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2618:lib_AT91SAM7S64.h **** }
2619:lib_AT91SAM7S64.h **** 
2620:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2621:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableRx
2622:lib_AT91SAM7S64.h **** //* \brief Disable Receiver
2623:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2624:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableRx (
2625:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2626:lib_AT91SAM7S64.h **** {
2627:lib_AT91SAM7S64.h ****     //* Disable receiver
2628:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXDIS;
2629:lib_AT91SAM7S64.h **** }
2630:lib_AT91SAM7S64.h **** 
2631:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2632:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableTx
2633:lib_AT91SAM7S64.h **** //* \brief Disable Transmitter
2634:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2635:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableTx (
2636:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2637:lib_AT91SAM7S64.h **** {
2638:lib_AT91SAM7S64.h ****     //* Disable transmitter
2639:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS;
2640:lib_AT91SAM7S64.h **** }
2641:lib_AT91SAM7S64.h **** 
2642:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2643:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Close
2644:lib_AT91SAM7S64.h **** //* \brief Close USART: disable IT disable receiver and transmitter, close PDC
2645:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2646:lib_AT91SAM7S64.h **** __inline void AT91F_US_Close (
2647:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2648:lib_AT91SAM7S64.h **** {
2649:lib_AT91SAM7S64.h ****     //* Reset the baud rate divisor register
2650:lib_AT91SAM7S64.h ****     pUSART->US_BRGR = 0 ;
2651:lib_AT91SAM7S64.h **** 
2652:lib_AT91SAM7S64.h ****     //* Reset the USART mode
2653:lib_AT91SAM7S64.h ****     pUSART->US_MR = 0  ;
2654:lib_AT91SAM7S64.h **** 
2655:lib_AT91SAM7S64.h ****     //* Reset the Timeguard Register
2656:lib_AT91SAM7S64.h ****     pUSART->US_TTGR = 0;
2657:lib_AT91SAM7S64.h **** 
2658:lib_AT91SAM7S64.h ****     //* Disable all interrupts
2659:lib_AT91SAM7S64.h ****     pUSART->US_IDR = 0xFFFFFFFF ;
2660:lib_AT91SAM7S64.h **** 
2661:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
2662:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pUSART->US_RPR));
2663:lib_AT91SAM7S64.h **** 
2664:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
2665:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS | AT91C_US_RXDIS | AT91C_US_RSTTX | AT91C_US_RSTRX ;
2666:lib_AT91SAM7S64.h **** }
2667:lib_AT91SAM7S64.h **** 
2668:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2669:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_TxReady
2670:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be written in US_THR
2671:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2672:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_TxReady (
2673:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2674:lib_AT91SAM7S64.h **** {
2675:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_TXRDY);
2676:lib_AT91SAM7S64.h **** }
2677:lib_AT91SAM7S64.h **** 
2678:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2679:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_RxReady
2680:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be read in US_RHR
2681:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2682:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_RxReady (
2683:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2684:lib_AT91SAM7S64.h **** {
2685:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_RXRDY);
2686:lib_AT91SAM7S64.h **** }
2687:lib_AT91SAM7S64.h **** 
2688:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2689:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Error
2690:lib_AT91SAM7S64.h **** //* \brief Return the error flag
2691:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2692:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Error (
2693:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2694:lib_AT91SAM7S64.h **** {
2695:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR &
2696:lib_AT91SAM7S64.h ****     	(AT91C_US_OVRE |  // Overrun error
2697:lib_AT91SAM7S64.h ****     	 AT91C_US_FRAME | // Framing error
2698:lib_AT91SAM7S64.h ****     	 AT91C_US_PARE));  // Parity error
2699:lib_AT91SAM7S64.h **** }
2700:lib_AT91SAM7S64.h **** 
2701:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2702:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_PutChar
2703:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
2704:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2705:lib_AT91SAM7S64.h **** __inline void AT91F_US_PutChar (
2706:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2707:lib_AT91SAM7S64.h **** 	int character )
2708:lib_AT91SAM7S64.h **** {
2709:lib_AT91SAM7S64.h ****     pUSART->US_THR = (character & 0x1FF);
2710:lib_AT91SAM7S64.h **** }
2711:lib_AT91SAM7S64.h **** 
2712:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2713:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_GetChar
2714:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
2715:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2716:lib_AT91SAM7S64.h **** __inline int AT91F_US_GetChar (
2717:lib_AT91SAM7S64.h **** 	const AT91PS_USART pUSART)
2718:lib_AT91SAM7S64.h **** {
2719:lib_AT91SAM7S64.h ****     return((pUSART->US_RHR) & 0x1FF);
2720:lib_AT91SAM7S64.h **** }
2721:lib_AT91SAM7S64.h **** 
2722:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2723:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SendFrame
2724:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2725:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2726:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_SendFrame(
2727:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2728:lib_AT91SAM7S64.h **** 	char *pBuffer,
2729:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2730:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2731:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2732:lib_AT91SAM7S64.h **** {
2733:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
2734:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pUSART->US_RPR),
2735:lib_AT91SAM7S64.h **** 		pBuffer,
2736:lib_AT91SAM7S64.h **** 		szBuffer,
2737:lib_AT91SAM7S64.h **** 		pNextBuffer,
2738:lib_AT91SAM7S64.h **** 		szNextBuffer);
2739:lib_AT91SAM7S64.h **** }
2740:lib_AT91SAM7S64.h **** 
2741:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2742:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ReceiveFrame
2743:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2744:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2745:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_ReceiveFrame (
2746:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2747:lib_AT91SAM7S64.h **** 	char *pBuffer,
2748:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2749:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2750:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2751:lib_AT91SAM7S64.h **** {
2752:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
2753:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pUSART->US_RPR),
2754:lib_AT91SAM7S64.h **** 		pBuffer,
2755:lib_AT91SAM7S64.h **** 		szBuffer,
2756:lib_AT91SAM7S64.h **** 		pNextBuffer,
2757:lib_AT91SAM7S64.h **** 		szNextBuffer);
2758:lib_AT91SAM7S64.h **** }
2759:lib_AT91SAM7S64.h **** 
2760:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2761:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetIrdaFilter
2762:lib_AT91SAM7S64.h **** //* \brief Set the value of IrDa filter tregister
2763:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2764:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetIrdaFilter (
2765:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2766:lib_AT91SAM7S64.h **** 	unsigned char value
2767:lib_AT91SAM7S64.h **** )
2768:lib_AT91SAM7S64.h **** {
2769:lib_AT91SAM7S64.h **** 	pUSART->US_IF = value;
2770:lib_AT91SAM7S64.h **** }
2771:lib_AT91SAM7S64.h **** 
2772:lib_AT91SAM7S64.h **** /* *****************************************************************************
2773:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR TWI
2774:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2775:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2776:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_EnableIt
2777:lib_AT91SAM7S64.h **** //* \brief Enable TWI IT
2778:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2779:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_EnableIt (
2780:lib_AT91SAM7S64.h **** 	AT91PS_TWI pTWI, // \arg pointer to a TWI controller
2781:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2782:lib_AT91SAM7S64.h **** {
2783:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2784:lib_AT91SAM7S64.h **** 	pTWI->TWI_IER = flag;
2785:lib_AT91SAM7S64.h **** }
2786:lib_AT91SAM7S64.h **** 
2787:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2788:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_DisableIt
2789:lib_AT91SAM7S64.h **** //* \brief Disable TWI IT
2790:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2791:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_DisableIt (
2792:lib_AT91SAM7S64.h **** 	AT91PS_TWI pTWI, // \arg pointer to a TWI controller
2793:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2794:lib_AT91SAM7S64.h **** {
2795:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
2796:lib_AT91SAM7S64.h **** 	pTWI->TWI_IDR = flag;
2797:lib_AT91SAM7S64.h **** }
2798:lib_AT91SAM7S64.h **** 
2799:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2800:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_Configure
2801:lib_AT91SAM7S64.h **** //* \brief Configure TWI in master mode
2802:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2803:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_Configure ( AT91PS_TWI pTWI )          // \arg pointer to a TWI controller
2804:lib_AT91SAM7S64.h **** {
2805:lib_AT91SAM7S64.h ****     //* Disable interrupts
2806:lib_AT91SAM7S64.h **** 	pTWI->TWI_IDR = (unsigned int) -1;
2807:lib_AT91SAM7S64.h **** 
2808:lib_AT91SAM7S64.h ****     //* Reset peripheral
2809:lib_AT91SAM7S64.h **** 	pTWI->TWI_CR = AT91C_TWI_SWRST;
2810:lib_AT91SAM7S64.h **** 
2811:lib_AT91SAM7S64.h **** 	//* Set Master mode
2812:lib_AT91SAM7S64.h **** 	pTWI->TWI_CR = AT91C_TWI_MSEN;
2813:lib_AT91SAM7S64.h **** 
2814:lib_AT91SAM7S64.h **** }
2815:lib_AT91SAM7S64.h **** 
2816:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2817:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_GetInterruptMaskStatus
2818:lib_AT91SAM7S64.h **** //* \brief Return TWI Interrupt Mask Status
2819:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2820:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_TWI_GetInterruptMaskStatus( // \return TWI Interrupt Mask Status
2821:lib_AT91SAM7S64.h ****         AT91PS_TWI pTwi) // \arg  pointer to a TWI controller
2822:lib_AT91SAM7S64.h **** {
2823:lib_AT91SAM7S64.h ****         return pTwi->TWI_IMR;
2824:lib_AT91SAM7S64.h **** }
2825:lib_AT91SAM7S64.h **** 
2826:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2827:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_IsInterruptMasked
2828:lib_AT91SAM7S64.h **** //* \brief Test if TWI Interrupt is Masked 
2829:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2830:lib_AT91SAM7S64.h **** __inline int AT91F_TWI_IsInterruptMasked(
2831:lib_AT91SAM7S64.h ****         AT91PS_TWI pTwi,   // \arg  pointer to a TWI controller
2832:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2833:lib_AT91SAM7S64.h **** {
2834:lib_AT91SAM7S64.h ****         return (AT91F_TWI_GetInterruptMaskStatus(pTwi) & flag);
2835:lib_AT91SAM7S64.h **** }
2836:lib_AT91SAM7S64.h **** 
2837:lib_AT91SAM7S64.h **** /* *****************************************************************************
2838:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR TC
2839:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2840:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2841:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_InterruptEnable
2842:lib_AT91SAM7S64.h **** //* \brief Enable TC Interrupt
2843:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2844:lib_AT91SAM7S64.h **** __inline void AT91F_TC_InterruptEnable(
2845:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2846:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  TC interrupt to be enabled
2847:lib_AT91SAM7S64.h **** {
2848:lib_AT91SAM7S64.h ****         pTc->TC_IER = flag;
2849:lib_AT91SAM7S64.h **** }
2850:lib_AT91SAM7S64.h **** 
2851:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2852:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_InterruptDisable
2853:lib_AT91SAM7S64.h **** //* \brief Disable TC Interrupt
2854:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2855:lib_AT91SAM7S64.h **** __inline void AT91F_TC_InterruptDisable(
2856:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2857:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  TC interrupt to be disabled
2858:lib_AT91SAM7S64.h **** {
2859:lib_AT91SAM7S64.h ****         pTc->TC_IDR = flag;
2860:lib_AT91SAM7S64.h **** }
2861:lib_AT91SAM7S64.h **** 
2862:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2863:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_GetInterruptMaskStatus
2864:lib_AT91SAM7S64.h **** //* \brief Return TC Interrupt Mask Status
2865:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2866:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_TC_GetInterruptMaskStatus( // \return TC Interrupt Mask Status
2867:lib_AT91SAM7S64.h ****         AT91PS_TC pTc) // \arg  pointer to a TC controller
2868:lib_AT91SAM7S64.h **** {
2869:lib_AT91SAM7S64.h ****         return pTc->TC_IMR;
2870:lib_AT91SAM7S64.h **** }
2871:lib_AT91SAM7S64.h **** 
2872:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2873:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_IsInterruptMasked
2874:lib_AT91SAM7S64.h **** //* \brief Test if TC Interrupt is Masked 
2875:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2876:lib_AT91SAM7S64.h **** __inline int AT91F_TC_IsInterruptMasked(
2877:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2878:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2879:lib_AT91SAM7S64.h **** {
2880:lib_AT91SAM7S64.h ****         return (AT91F_TC_GetInterruptMaskStatus(pTc) & flag);
2881:lib_AT91SAM7S64.h **** }
2882:lib_AT91SAM7S64.h **** 
2883:lib_AT91SAM7S64.h **** /* *****************************************************************************
2884:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PWMC
2885:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2886:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2887:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_GetStatus
2888:lib_AT91SAM7S64.h **** //* \brief Return PWM Interrupt Status
2889:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2890:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_GetStatus( // \return PWM Interrupt Status
2891:lib_AT91SAM7S64.h **** 	AT91PS_PWMC pPWM) // pointer to a PWM controller
2892:lib_AT91SAM7S64.h **** {
2893:lib_AT91SAM7S64.h **** 	return pPWM->PWMC_SR;
2894:lib_AT91SAM7S64.h **** }
2895:lib_AT91SAM7S64.h **** 
2896:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2897:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_InterruptEnable
2898:lib_AT91SAM7S64.h **** //* \brief Enable PWM Interrupt
2899:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2900:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_InterruptEnable(
2901:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm,   // \arg  pointer to a PWM controller
2902:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  PWM interrupt to be enabled
2903:lib_AT91SAM7S64.h **** {
2904:lib_AT91SAM7S64.h ****         pPwm->PWMC_IER = flag;
2905:lib_AT91SAM7S64.h **** }
2906:lib_AT91SAM7S64.h **** 
2907:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2908:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_InterruptDisable
2909:lib_AT91SAM7S64.h **** //* \brief Disable PWM Interrupt
2910:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2911:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_InterruptDisable(
2912:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm,   // \arg  pointer to a PWM controller
2913:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  PWM interrupt to be disabled
2914:lib_AT91SAM7S64.h **** {
2915:lib_AT91SAM7S64.h ****         pPwm->PWMC_IDR = flag;
 701              		.loc 1 2915 0
 702 02cc 0C629FE5 		ldr	r6, .L38+8
 703              	.LBE279:
 704              	.LBE278:
 705              	.LBB280:
 706              	.LBB281:
 707              		.loc 1 495 0
 708 02d0 0B4CE0E3 		mvn	r4, #2816
 709 02d4 0150A0E3 		mov	r5, #1
 710              		.loc 1 496 0
 711 02d8 00A0A0E3 		mov	sl, #0
 712              	.LBE281:
 713              	.LBE280:
 714              	.LBB282:
 715              	.LBB283:
 716              		.loc 1 495 0
 717 02dc 0270A0E3 		mov	r7, #2
 718              	.LBE283:
 719              	.LBE282:
 720              	.LBB284:
 721              	.LBB285:
 722 02e0 0480A0E3 		mov	r8, #4
 723              	.LBE285:
 724              	.LBE284:
 725              	.LBE277:
 726              	.LBE276:
 727              		.loc 2 255 0
 728 02e4 3E0000EB 		bl	InitPIO
 729              		.loc 2 256 0
 730 02e8 FEFFFFEB 		bl	InitADC
 731              	.LBB286:
 732              	.LBB287:
 733              	.LBB288:
 734              	.LBB289:
 735              		.loc 1 1044 0
 736 02ec 032CE0E3 		mvn	r2, #768
 737              	.LBE289:
 738              	.LBE288:
 739              	.LBB290:
 740              	.LBB291:
 741              	.LBB292:
 742              	.LBB293:
 743 02f0 013BA0E3 		mov	r3, #1024
 744              	.LBE293:
 745              	.LBE292:
 746              	.LBE291:
 747              	.LBE290:
 748              	.LBB294:
 749              	.LBB295:
 750              		.loc 1 495 0
 751 02f4 8F5004E5 		str	r5, [r4, #-143]
 752              	.LBE295:
 753              	.LBE294:
 754              		.loc 2 130 0
 755 02f8 7D1DA0E3 		mov	r1, #8000
 756              	.LBB296:
 757              	.LBB297:
 758              		.loc 1 496 0
 759 02fc 8BA004E5 		str	sl, [r4, #-139]
 760              	.LBE297:
 761              	.LBE296:
 762              		.loc 2 130 0
 763 0300 0A00A0E1 		mov	r0, sl
 764              	.LBB298:
 765              	.LBB299:
 766              		.loc 1 497 0
 767 0304 FB5004E5 		str	r5, [r4, #-251]
 768              	.LBE299:
 769              	.LBE298:
 770              	.LBB300:
 771              	.LBB301:
 772              		.loc 1 495 0
 773 0308 8F7004E5 		str	r7, [r4, #-143]
 774              		.loc 1 496 0
 775 030c 8BA004E5 		str	sl, [r4, #-139]
 776              		.loc 1 497 0
 777 0310 FB7004E5 		str	r7, [r4, #-251]
 778              	.LBE301:
 779              	.LBE300:
 780              	.LBB302:
 781              	.LBB303:
 782              		.loc 1 495 0
 783 0314 8F8004E5 		str	r8, [r4, #-143]
 784              		.loc 1 496 0
 785 0318 8BA004E5 		str	sl, [r4, #-139]
 786              		.loc 1 497 0
 787 031c FB8004E5 		str	r8, [r4, #-251]
 788              	.LBE303:
 789              	.LBE302:
 790              	.LBB304:
 791              	.LBB305:
 792              		.loc 1 2915 0
 793 0320 EB5006E5 		str	r5, [r6, #-235]
 794              	.LBE305:
 795              	.LBE304:
 796              	.LBB306:
 797              	.LBB307:
 798 0324 EB7006E5 		str	r7, [r6, #-235]
 799              	.LBE307:
 800              	.LBE306:
 801              	.LBB308:
 802              	.LBB309:
 803 0328 EB8006E5 		str	r8, [r6, #-235]
 804              	.LBE309:
 805              	.LBE308:
 806              	.LBB310:
 807              	.LBB311:
 808              		.loc 1 1044 0
 809 032c EF8002E5 		str	r8, [r2, #-239]
 810              	.LBE311:
 811              	.LBE310:
 812              	.LBB312:
 813              	.LBB313:
 814              	.LBB314:
 815              	.LBB315:
 816 0330 EF3002E5 		str	r3, [r2, #-239]
 817              	.LBE315:
 818              	.LBE314:
 819              	.LBE313:
 820              	.LBE312:
 821              	.LBB316:
 822              	.LBB317:
2916:lib_AT91SAM7S64.h **** }
2917:lib_AT91SAM7S64.h **** 
2918:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2919:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_GetInterruptMaskStatus
2920:lib_AT91SAM7S64.h **** //* \brief Return PWM Interrupt Mask Status
2921:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2922:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_GetInterruptMaskStatus( // \return PWM Interrupt Mask Status
2923:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm) // \arg  pointer to a PWM controller
2924:lib_AT91SAM7S64.h **** {
2925:lib_AT91SAM7S64.h ****         return pPwm->PWMC_IMR;
2926:lib_AT91SAM7S64.h **** }
2927:lib_AT91SAM7S64.h **** 
2928:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2929:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_IsInterruptMasked
2930:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Masked
2931:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2932:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_IsInterruptMasked(
2933:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2934:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2935:lib_AT91SAM7S64.h **** {
2936:lib_AT91SAM7S64.h **** 	return (AT91F_PWMC_GetInterruptMaskStatus(pPWM) & flag);
2937:lib_AT91SAM7S64.h **** }
2938:lib_AT91SAM7S64.h **** 
2939:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2940:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_IsStatusSet
2941:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Set
2942:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2943:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_IsStatusSet(
2944:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2945:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2946:lib_AT91SAM7S64.h **** {
2947:lib_AT91SAM7S64.h **** 	return (AT91F_PWMC_GetStatus(pPWM) & flag);
2948:lib_AT91SAM7S64.h **** }
2949:lib_AT91SAM7S64.h **** 
2950:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2951:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_CfgChannel
2952:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Set
2953:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2954:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_CfgChannel(
2955:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2956:lib_AT91SAM7S64.h ****         unsigned int channelId, // \arg PWM channel ID
2957:lib_AT91SAM7S64.h ****         unsigned int mode, // \arg  PWM mode
2958:lib_AT91SAM7S64.h ****         unsigned int period, // \arg PWM period
2959:lib_AT91SAM7S64.h ****         unsigned int duty) // \arg PWM duty cycle
2960:lib_AT91SAM7S64.h **** {
2961:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CMR = mode;
2962:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CDTYR = duty;
2963:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CPRDR = period;
2964:lib_AT91SAM7S64.h **** }
2965:lib_AT91SAM7S64.h **** 
2966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2967:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_StartChannel
2968:lib_AT91SAM7S64.h **** //* \brief Enable channel
2969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2970:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_StartChannel(
2971:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2972:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  Channels IDs to be enabled
2973:lib_AT91SAM7S64.h **** {
2974:lib_AT91SAM7S64.h **** 	pPWM->PWMC_ENA = flag;
2975:lib_AT91SAM7S64.h **** }
2976:lib_AT91SAM7S64.h **** 
2977:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2978:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_StopChannel
2979:lib_AT91SAM7S64.h **** //* \brief Disable channel
2980:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2981:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_StopChannel(
2982:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2983:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  Channels IDs to be enabled
2984:lib_AT91SAM7S64.h **** {
2985:lib_AT91SAM7S64.h **** 	pPWM->PWMC_DIS = flag;
 823              		.loc 1 2985 0
 824 0334 F75006E5 		str	r5, [r6, #-247]
 825              	.LBE317:
 826              	.LBE316:
 827              	.LBB318:
 828              	.LBB319:
 829 0338 F77006E5 		str	r7, [r6, #-247]
 830              	.LBE319:
 831              	.LBE318:
 832              	.LBB320:
 833              	.LBB321:
 834 033c F78006E5 		str	r8, [r6, #-247]
 835              	.LBE321:
 836              	.LBE320:
 837              		.loc 2 130 0
 838 0340 FEFFFFEB 		bl	pwmFreqSet
 839              		.loc 2 131 0
 840 0344 7D1DA0E3 		mov	r1, #8000
 841 0348 0500A0E1 		mov	r0, r5
 842 034c FEFFFFEB 		bl	pwmFreqSet
 843              		.loc 2 132 0
 844 0350 7D1DA0E3 		mov	r1, #8000
 845 0354 0700A0E1 		mov	r0, r7
 846 0358 FEFFFFEB 		bl	pwmFreqSet
 847              		.loc 2 134 0
 848 035c 0A00A0E1 		mov	r0, sl
 849 0360 0510A0E1 		mov	r1, r5
 850 0364 FEFFFFEB 		bl	pwmDutySet_u8
 851              		.loc 2 135 0
 852 0368 0500A0E1 		mov	r0, r5
 853 036c 0510A0E1 		mov	r1, r5
 854 0370 FEFFFFEB 		bl	pwmDutySet_u8
 855              		.loc 2 136 0
 856 0374 0700A0E1 		mov	r0, r7
 857 0378 0510A0E1 		mov	r1, r5
 858 037c FEFFFFEB 		bl	pwmDutySet_u8
 859              	.LBE287:
 860              	.LBE286:
 861              	.LBB322:
 862              	.LBB323:
 863              	.LBB324:
 864              	.LBB325:
 865              		.loc 1 495 0
 866 0380 01C6A0E3 		mov	ip, #1048576
 867              	.LBE325:
 868              	.LBE324:
 869              	.LBE323:
 870              	.LBE322:
 871              	.LBB326:
 872              	.LBB327:
 873              	.LBB328:
 874              	.LBB329:
2986:lib_AT91SAM7S64.h **** }
2987:lib_AT91SAM7S64.h **** 
2988:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2989:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_UpdateChannel
2990:lib_AT91SAM7S64.h **** //* \brief Update Period or Duty Cycle
2991:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2992:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_UpdateChannel(
2993:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2994:lib_AT91SAM7S64.h ****         unsigned int channelId, // \arg PWM channel ID
2995:lib_AT91SAM7S64.h ****         unsigned int update) // \arg  Channels IDs to be enabled
2996:lib_AT91SAM7S64.h **** {
2997:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CUPDR = update;
 875              		.loc 1 2997 0
 876 0384 115186E5 		str	r5, [r6, #273]
 877              	.LBE329:
 878              	.LBE328:
 879              	.LBB330:
 880              	.LBB331:
 881 0388 317186E5 		str	r7, [r6, #305]
 882              	.LBE331:
 883              	.LBE330:
 884              	.LBB332:
 885              	.LBB333:
 886 038c 518186E5 		str	r8, [r6, #337]
 887              	.LBE333:
 888              	.LBE332:
 889              	.LBB334:
 890              	.LBB335:
 891              		.loc 1 2985 0
 892 0390 F75006E5 		str	r5, [r6, #-247]
 893              	.LBE335:
 894              	.LBE334:
 895              	.LBB336:
 896              	.LBB337:
 897 0394 F77006E5 		str	r7, [r6, #-247]
 898              	.LBE337:
 899              	.LBE336:
 900              	.LBB338:
 901              	.LBB339:
 902 0398 F78006E5 		str	r8, [r6, #-247]
 903              	.LBE339:
 904              	.LBE338:
 905              	.LBE327:
 906              	.LBE326:
 907              	.LBB340:
 908              	.LBB341:
 909              	.LBB342:
 910              	.LBB343:
 911              		.loc 1 495 0
 912 039c 8FC004E5 		str	ip, [r4, #-143]
 913              		.loc 1 496 0
 914 03a0 8BA004E5 		str	sl, [r4, #-139]
 915              		.loc 1 497 0
 916 03a4 FBC004E5 		str	ip, [r4, #-251]
 917              	.LBE343:
 918              	.LBE342:
 919              		.loc 2 220 0
 920 03a8 34C19FE5 		ldr	ip, .L38+12
 921 03ac 1E10A0E3 		mov	r1, #30
 922 03b0 0720A0E3 		mov	r2, #7
 923 03b4 2030A0E3 		mov	r3, #32
 924 03b8 28019FE5 		ldr	r0, .L38+16
 925 03bc 00C08DE5 		str	ip, [sp, #0]
 926 03c0 FEFFFFEB 		bl	AT91F_AIC_ConfigureIt
 927              	.LBB344:
 928              	.LBB345:
 929              		.loc 1 495 0
 930 03c4 01C1A0E3 		mov	ip, #1073741824
 931 03c8 8FC004E5 		str	ip, [r4, #-143]
 932              		.loc 1 496 0
 933 03cc 8BA004E5 		str	sl, [r4, #-139]
 934              		.loc 1 497 0
 935 03d0 FBC004E5 		str	ip, [r4, #-251]
 936              	.LBE345:
 937              	.LBE344:
 938              		.loc 2 225 0
 939 03d4 10C19FE5 		ldr	ip, .L38+20
 940 03d8 1F10A0E3 		mov	r1, #31
 941 03dc 0720A0E3 		mov	r2, #7
 942 03e0 2030A0E3 		mov	r3, #32
 943 03e4 FC009FE5 		ldr	r0, .L38+16
 944 03e8 00C08DE5 		str	ip, [sp, #0]
 945 03ec FEFFFFEB 		bl	AT91F_AIC_ConfigureIt
 946              	.LBB346:
 947              	.LBB347:
 948              		.loc 1 495 0
 949 03f0 02C7A0E3 		mov	ip, #524288
 950 03f4 8FC004E5 		str	ip, [r4, #-143]
 951              		.loc 1 496 0
 952 03f8 8BA004E5 		str	sl, [r4, #-139]
 953              		.loc 1 497 0
 954 03fc FBC004E5 		str	ip, [r4, #-251]
 955              	.LBE347:
 956              	.LBE346:
 957              		.loc 2 230 0
 958 0400 E8C09FE5 		ldr	ip, .L38+24
 959 0404 0A10A0E1 		mov	r1, sl
 960 0408 D8009FE5 		ldr	r0, .L38+16
 961 040c 0A20A0E1 		mov	r2, sl
 962 0410 6030A0E3 		mov	r3, #96
 963 0414 00C08DE5 		str	ip, [sp, #0]
 964 0418 FEFFFFEB 		bl	AT91F_AIC_ConfigureIt
 965              	.L37:
 966              	.LBE341:
 967              	.LBE340:
 968              	.LBE275:
 969              	.LBE271:
 267:main.c        ****     struct cdcMessage cdcMessageObj;
 268:main.c        **** 
 269:main.c        ****     DeviceInit();
 270:main.c        **** 
 271:main.c        ****     while (1)
 272:main.c        ****     {
 273:main.c        ****         cdcMessageObj = getCDCMEssage();
 970              		.loc 2 273 0
 971 041c 0C408DE2 		add	r4, sp, #12
 972 0420 084044E2 		sub	r4, r4, #8
 973 0424 825F8DE2 		add	r5, sp, #520
 974 0428 0400A0E1 		mov	r0, r4
 975 042c FEFFFFEB 		bl	getCDCMEssage
 976 0430 0410A0E1 		mov	r1, r4
 977 0434 812FA0E3 		mov	r2, #516
 978 0438 0500A0E1 		mov	r0, r5
 979 043c FEFFFFEB 		bl	memcpy
 274:main.c        ****         if (cdcMessageObj.length > 0)
 980              		.loc 2 274 0
 981 0440 08349DE5 		ldr	r3, [sp, #1032]
 982 0444 000053E3 		cmp	r3, #0
 983              	.LBB348:
 275:main.c        ****         {
 276:main.c        ****             sprintf((char *)msg,"MSG:%s\n", cdcMessageObj.data);
 277:main.c        ****             pCDC.Write(&pCDC, (char *)msg, strlen((char *)msg));
 984              		.loc 2 277 0
 985 0448 8C609FE5 		ldr	r6, .L38+4
 986              		.loc 2 276 0
 987 044c 0520A0E1 		mov	r2, r5
 988 0450 9C109FE5 		ldr	r1, .L38+28
 989 0454 9C009FE5 		ldr	r0, .L38+32
 990              	.LBE348:
 991              		.loc 2 274 0
 992 0458 0501000A 		beq	.L37
 993              	.LBB349:
 994              		.loc 2 276 0
 995 045c FEFFFFEB 		bl	sprintf
 996              		.loc 2 277 0
 997 0460 90009FE5 		ldr	r0, .L38+32
 998 0464 FEFFFFEB 		bl	strlen
 999 0468 88109FE5 		ldr	r1, .L38+32
 1000 046c 0020A0E1 		mov	r2, r0
 1001 0470 0600A0E1 		mov	r0, r6
 1002 0474 10C096E5 		ldr	ip, [r6, #16]
 1003 0478 0FE0A0E1 		mov	lr, pc
 1004 047c 1CFF2FE1 		bx	ip
 278:main.c        **** 
 279:main.c        ****             char *cmdParts;
 280:main.c        ****             cmdParts = strtok((char*) cdcMessageObj.data, "#" );
 1005              		.loc 2 280 0
 1006 0480 74109FE5 		ldr	r1, .L38+36
 1007 0484 0500A0E1 		mov	r0, r5
 1008 0488 FEFFFFEB 		bl	strtok
 281:main.c        **** 
 282:main.c        ****             if (strcmp((char*) cmdParts, "DEMOP") == 0)
 1009              		.loc 2 282 0
 1010 048c 6C109FE5 		ldr	r1, .L38+40
 1011 0490 FEFFFFEB 		bl	strcmp
 1012 0494 000050E3 		cmp	r0, #0
 283:main.c        ****             {
 284:main.c        ****                 AT91F_PIO_ClearOutput(AT91C_BASE_PIOA, AT91C_PIO_PA7);
 285:main.c        ****                 sprintf((char *)msg,"PARALLEL EXECUTION MANIPULATOR DEMO\n");
 1013              		.loc 2 285 0
 1014 0498 64109FE5 		ldr	r1, .L38+44
 1015 049c 54009FE5 		ldr	r0, .L38+32
 1016              		.loc 2 282 0
 1017 04a0 0501001A 		bne	.L37
 1018              	.LBB350:
 1019              	.LBB351:
 1020              		.loc 1 620 0
 1021 04a4 8030A0E3 		mov	r3, #128
 1022 04a8 0B2CE0E3 		mvn	r2, #2816
 1023 04ac CB3002E5 		str	r3, [r2, #-203]
 1024              	.LBE351:
 1025              	.LBE350:
 1026              		.loc 2 285 0
 1027 04b0 FEFFFFEB 		bl	strcpy
 286:main.c        ****                 pCDC.Write(&pCDC, (char *)msg, strlen((char *)msg));
 1028              		.loc 2 286 0
 1029 04b4 3C009FE5 		ldr	r0, .L38+32
 1030 04b8 FEFFFFEB 		bl	strlen
 1031 04bc 34109FE5 		ldr	r1, .L38+32
 1032 04c0 0020A0E1 		mov	r2, r0
 1033 04c4 0600A0E1 		mov	r0, r6
 1034 04c8 10C096E5 		ldr	ip, [r6, #16]
 1035 04cc 0FE0A0E1 		mov	lr, pc
 1036 04d0 1CFF2FE1 		bx	ip
 1037 04d4 050100EA 		b	.L37
 1038              	.L39:
 1039              		.align	2
 1040              	.L38:
 1041 04d8 010400A5 		.word	-1526725631
 1042 04dc 00000000 		.word	pCDC
 1043 04e0 FFC0FCFF 		.word	-212737
 1044 04e4 00000000 		.word	IRQ0Handler
 1045 04e8 00F0FFFF 		.word	-4096
 1046 04ec 00000000 		.word	IRQ1Handler
 1047 04f0 00000000 		.word	FIQHandler
 1048 04f4 00000000 		.word	.LC0
 1049 04f8 00000000 		.word	msg
 1050 04fc 08000000 		.word	.LC1
 1051 0500 0C000000 		.word	.LC2
 1052 0504 14000000 		.word	.LC3
 1053              	.LBE349:
 1054              	.LFE299:
 1056              		.comm	pCDC,24,4
 1057              		.comm	msg,2048,4
 1058              		.comm	cmd,2048,4
 1217              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 main.c
     /tmp/ccXjzIW0.s:12     .text:00000000 AT91F_AIC_ConfigureIt
     /tmp/ccXjzIW0.s:21     .text:00000000 $a
     /tmp/ccXjzIW0.s:55     .text:00000038 IRQ0Handler
     /tmp/ccXjzIW0.s:71     .text:0000003c IRQ1Handler
     /tmp/ccXjzIW0.s:86     .text:00000040 FIQHandler
     /tmp/ccXjzIW0.s:101    .text:00000044 getCDCMEssage
     /tmp/ccXjzIW0.s:154    .text:000000a8 $d
                            *COM*:00000018 pCDC
     /tmp/ccXjzIW0.s:160    .text:000000ac AT91FUSBOpen
     /tmp/ccXjzIW0.s:167    .text:000000ac $a
     /tmp/ccXjzIW0.s:223    .text:000000f8 $d
     /tmp/ccXjzIW0.s:229    .text:00000100 InitPIO
     /tmp/ccXjzIW0.s:238    .text:00000100 $a
     /tmp/ccXjzIW0.s:656    .text:00000284 main
     /tmp/ccXjzIW0.s:1041   .text:000004d8 $d
                            *COM*:00000800 msg
                            *COM*:00000800 cmd

UNDEFINED SYMBOLS
memcpy
AT91F_CDC_Open
InitADC
pwmFreqSet
pwmDutySet_u8
sprintf
strlen
strtok
strcmp
strcpy
