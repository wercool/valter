   1              		.file	"main.c"
   9              	.Ltext0:
  10              		.align	2
  11              		.global	flashInit
  13              	flashInit:
  14              	.LFB285:
  15              		.file 1 "main.c"
   1:main.c        **** //*----------------------------------------------------------------------------
   2:main.c        **** //*         ATMEL Microcontroller Software Support  -  ROUSSET  -
   3:main.c        **** //*----------------------------------------------------------------------------
   4:main.c        **** //* The software is delivered "AS IS" without warranty or condition of any
   5:main.c        **** //* kind, either express, implied or statutory. This includes without
   6:main.c        **** //* limitation any warranty or condition with respect to merchantability or
   7:main.c        **** //* fitness for any particular purpose, or against the infringements of
   8:main.c        **** //* intellectual property rights of others.
   9:main.c        **** //*----------------------------------------------------------------------------
  10:main.c        **** //* File Name           : main.c
  11:main.c        **** //* Object              : main application written in C
  12:main.c        **** //* Creation            : JPP   16/Jun/2004
  13:main.c        **** //*----------------------------------------------------------------------------
  14:main.c        **** 
  15:main.c        **** // Include Standard files
  16:main.c        **** #include "stdio.h"
  17:main.c        **** #include "string.h"
  18:main.c        **** 
  19:main.c        **** #include "fastfunc.h"
  20:main.c        **** #include "Board.h"
  21:main.c        **** #include "cdc_enumerate.h"
  22:main.c        **** #include "adc.h"
  23:main.c        **** 
  24:main.c        **** /* Global variables */
  25:main.c        **** #define SPEED       (MCKKHz/10)
  26:main.c        **** unsigned int LedSpeed = SPEED *50;
  27:main.c        **** #define MSG_SIZE        1000
  28:main.c        **** extern void Usart_init ( void );
  29:main.c        **** extern void AT91F_US_Put( char *buffer); // \arg pointer to a string ending by \0
  30:main.c        **** extern void Trace_Toggel_LED( unsigned int led);
  31:main.c        **** unsigned char res[MSG_SIZE];
  32:main.c        **** unsigned char pos[MSG_SIZE];
  33:main.c        **** unsigned char cmd[MSG_SIZE];
  34:main.c        **** unsigned char msg[MSG_SIZE];
  35:main.c        **** 
  36:main.c        **** unsigned char settings[128];
  37:main.c        **** 
  38:main.c        **** int maxPos = 900;
  39:main.c        **** int minPos = 300;
  40:main.c        **** int curPos = 600;
  41:main.c        **** 
  42:main.c        **** int maxForce = 100000;
  43:main.c        **** int minForce = 66000;
  44:main.c        **** int curForce = 66000;
  45:main.c        **** 
  46:main.c        **** int pressure;
  47:main.c        **** int position;
  48:main.c        **** int direction;
  49:main.c        **** unsigned char reading = 0;
  50:main.c        **** unsigned char dataReading = 0;
  51:main.c        **** 
  52:main.c        **** 
  53:main.c        **** //AAT Settings
  54:main.c        **** unsigned char aatDiag = 0;
  55:main.c        **** unsigned char aatDiagStep = 0;
  56:main.c        **** int minDiagForce = 90000;
  57:main.c        **** int lockDiagForce = 100000;
  58:main.c        **** int lockDiagPressure = 0;
  59:main.c        **** int diagForce = 80000;
  60:main.c        **** 
  61:main.c        **** 
  62:main.c        **** // We will store our data in the last page of Flash.
  63:main.c        **** #define OUR_FLASH_ADDR (AT91C_IFLASH + AT91C_IFLASH_SIZE - AT91C_IFLASH_PAGE_SIZE)
  64:main.c        **** #define AT91C_MC_WRITE_KEY  ((unsigned)0x5A << 24) // Value to enable flash commands.
  65:main.c        **** 
  66:main.c        **** // ***************************************************************
  67:main.c        **** // ** flashInit - Sets up the flash writing peripheral. Call this
  68:main.c        **** // **             before you do any flash writes.
  69:main.c        **** // **
  70:main.c        **** void flashInit()
  71:main.c        **** {
  16              		.loc 1 71 0
  17              		@ args = 0, pretend = 0, frame = 4
  18              		@ frame_needed = 0, uses_anonymous_args = 0
  19              		@ link register save eliminated.
  20 0000 04D04DE2 		sub	sp, sp, #4
  21              	.LCFI0:
  72:main.c        **** // Get base location of memory controller peripheral.
  73:main.c        ****     volatile AT91PS_MC mc = AT91C_BASE_MC;
  22              		.loc 1 73 0
  23 0004 FF30E0E3 		mvn	r3, #255
  24 0008 00308DE5 		str	r3, [sp, #0]
  25              	.LVL0:
  74:main.c        **** 
  75:main.c        **** // Enable the auto-erase feature and set up flash write timing.
  76:main.c        ****     mc->MC_FMR = AT91C_MC_FWS_1FWS | (1 + (((MCK * 15) / 10000000)) << 16);
  26              		.loc 1 76 0
  27 000c 00209DE5 		ldr	r2, [sp, #0]
  28 0010 08309FE5 		ldr	r3, .L3
  29              		.loc 1 71 0
  30              		@ lr needed for prologue
  31              		.loc 1 76 0
  32 0014 603082E5 		str	r3, [r2, #96]
  77:main.c        **** }
  33              		.loc 1 77 0
  34 0018 04D08DE2 		add	sp, sp, #4
  35 001c 1EFF2FE1 		bx	lr
  36              	.L4:
  37              		.align	2
  38              	.L3:
  39 0020 00014800 		.word	4718848
  40              	.LFE285:
  42              		.align	2
  43              		.global	Delay
  45              	Delay:
  46              	.LFB292:
  78:main.c        **** 
  79:main.c        **** 
  80:main.c        **** struct _AT91S_CDC   pCDC;
  81:main.c        **** 
  82:main.c        **** void Init_PWM(void)
  83:main.c        **** {
  84:main.c        ****   AT91F_PWMC_InterruptDisable(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
  85:main.c        ****   AT91F_PMC_EnablePeriphClock( AT91C_BASE_PMC, 1 << AT91C_ID_PIOA );
  86:main.c        ****   AT91F_PWMC_CH0_CfgPIO();
  87:main.c        ****   AT91F_PWMC_CfgPMC();    
  88:main.c        ****   AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
  89:main.c        ****   AT91F_PWMC_CfgChannel(AT91C_BASE_PWMC, 0, 1 | AT91C_PWMC_CPOL, 100000, 66000);
  90:main.c        ****   AT91F_PWMC_UpdateChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0, 0);
  91:main.c        ****   AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
  92:main.c        ****   AT91F_PIO_CfgPeriph(AT91C_BASE_PIOA, 0, AT91C_PA23_PWM0);
  93:main.c        ****   AT91F_PWMC_StartChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
  94:main.c        **** }
  95:main.c        **** 
  96:main.c        **** //*----------------------------------------------------------------------------
  97:main.c        **** //* \fn    AT91F_USB_Open
  98:main.c        **** //* \brief This function Open the USB device
  99:main.c        **** //*----------------------------------------------------------------------------
 100:main.c        **** void AT91F_USB_Open(void)
 101:main.c        **** {
 102:main.c        ****     // Set the PLL USB Divider
 103:main.c        ****     AT91C_BASE_CKGR->CKGR_PLLR |= AT91C_CKGR_USBDIV_1 ;
 104:main.c        **** 
 105:main.c        ****     // Specific Chip USB Initialisation
 106:main.c        ****     // Enables the 48MHz USB clock UDPCK and System Peripheral USB Clock
 107:main.c        ****     AT91C_BASE_PMC->PMC_SCER = AT91C_PMC_UDP;
 108:main.c        ****     AT91C_BASE_PMC->PMC_PCER = (1 << AT91C_ID_UDP);
 109:main.c        **** 
 110:main.c        ****     // Enable UDP PullUp (USB_DP_PUP) : enable & Clear of the corresponding PIO
 111:main.c        ****     // Set in PIO mode and Configure in Output
 112:main.c        ****     AT91F_PIO_CfgOutput(AT91C_BASE_PIOA,AT91C_PIO_PA16);
 113:main.c        ****     // Clear for set the Pul up resistor
 114:main.c        ****     AT91F_PIO_ClearOutput(AT91C_BASE_PIOA,AT91C_PIO_PA16);
 115:main.c        **** 
 116:main.c        ****     // CDC Open by structure initialization
 117:main.c        ****     AT91F_CDC_Open(&pCDC, AT91C_BASE_UDP);
 118:main.c        **** }
 119:main.c        **** 
 120:main.c        **** //*--------------------------------------------------------------------------------------
 121:main.c        **** //* Function Name       : change_speed
 122:main.c        **** //* Object              : Adjust "LedSpeed" value depending on SW1 and SW2 are pressed or not
 123:main.c        **** //* Input Parameters    : none
 124:main.c        **** //* Output Parameters   : Update of LedSpeed value.
 125:main.c        **** //*--------------------------------------------------------------------------------------
 126:main.c        **** static void change_speed ( void )
 127:main.c        **** {//* Begin
 128:main.c        ****     if ( (AT91F_PIO_GetInput(AT91C_BASE_PIOA) & SW1_MASK) == 0 )
 129:main.c        ****     {
 130:main.c        ****         if ( LedSpeed > SPEED ) LedSpeed -=SPEED ;
 131:main.c        ****     }
 132:main.c        ****     if ( (AT91F_PIO_GetInput(AT91C_BASE_PIOA) & SW2_MASK) == 0 )
 133:main.c        ****     {
 134:main.c        ****         if ( LedSpeed < MCK ) LedSpeed +=SPEED ;
 135:main.c        ****     }
 136:main.c        **** }//* End
 137:main.c        **** 
 138:main.c        **** void clearLEDs()
 139:main.c        **** {
 140:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 141:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 142:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 143:main.c        **** }
 144:main.c        **** 
 145:main.c        **** void blinkingGreen(int delay)
 146:main.c        **** {
 147:main.c        ****     /*LED3 - GREEN*/
 148:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED3);
 149:main.c        ****     Delay(delay);
 150:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 151:main.c        ****     Delay(delay);
 152:main.c        **** }
 153:main.c        **** 
 154:main.c        **** void startBlinking(int delay)
 155:main.c        **** {
 156:main.c        ****     /* START BLINKING LED */
 157:main.c        ****     /*LED1 - RED*/
 158:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED1);
 159:main.c        ****     Delay(delay);
 160:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 161:main.c        ****     Delay(delay);
 162:main.c        ****     /*LED2 - YELLOW*/
 163:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED2);
 164:main.c        ****     Delay(delay);
 165:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 166:main.c        ****     Delay(delay);
 167:main.c        ****     /*LED3 - GREEN*/
 168:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED3);
 169:main.c        ****     Delay(delay);
 170:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 171:main.c        ****     Delay(delay);
 172:main.c        **** }
 173:main.c        **** 
 174:main.c        **** void Delay(delayVal)
 175:main.c        **** {
  47              		.loc 1 175 0
  48              		@ args = 0, pretend = 0, frame = 4
  49              		@ frame_needed = 0, uses_anonymous_args = 0
  50              		@ link register save eliminated.
  51              	.LVL1:
  52 0024 04D04DE2 		sub	sp, sp, #4
  53              	.LCFI1:
 176:main.c        ****   volatile unsigned int waiting_time ;
 177:main.c        ****   for(waiting_time = 0; waiting_time < delayVal; waiting_time++) ;
  54              		.loc 1 177 0
  55 0028 0030A0E3 		mov	r3, #0
  56              		.loc 1 175 0
  57              		@ lr needed for prologue
  58 002c 0C0000EA 		b	.L10
  59              	.LVL2:
  60              	.L7:
  61              		.loc 1 177 0
  62 0030 00309DE5 		ldr	r3, [sp, #0]
  63 0034 013083E2 		add	r3, r3, #1
  64              	.L10:
  65 0038 00308DE5 		str	r3, [sp, #0]
  66 003c 00309DE5 		ldr	r3, [sp, #0]
  67 0040 000053E1 		cmp	r3, r0
  68 0044 0A00003A 		bcc	.L7
 178:main.c        **** }
  69              		.loc 1 178 0
  70 0048 04D08DE2 		add	sp, sp, #4
  71 004c 1EFF2FE1 		bx	lr
  72              	.LFE292:
  74              		.align	2
  75              		.global	printTrace
  77              	printTrace:
  78              	.LFB298:
 179:main.c        **** 
 180:main.c        **** void setForce(int force)
 181:main.c        **** {
 182:main.c        ****     AT91F_PWMC_StopChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 183:main.c        ****     AT91F_PWMC_CfgChannel(AT91C_BASE_PWMC, 0, 1 | AT91C_PWMC_CPOL, 100000, force);
 184:main.c        ****     AT91F_PWMC_UpdateChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0, 0);
 185:main.c        ****     AT91F_PWMC_StartChannel(AT91C_BASE_PWMC, AT91C_PWMC_CHID0);
 186:main.c        **** }
 187:main.c        **** 
 188:main.c        **** void liftUp(int force)
 189:main.c        **** {
 190:main.c        ****     setForce(force);
 191:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, DIRC);
 192:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, DIRD);
 193:main.c        ****     direction = -1;
 194:main.c        **** }
 195:main.c        **** 
 196:main.c        **** void lowerDown(int force)
 197:main.c        **** {
 198:main.c        ****     setForce(force);
 199:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, DIRD);
 200:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, DIRC);
 201:main.c        ****     direction = 1;
 202:main.c        **** }
 203:main.c        **** 
 204:main.c        **** void releasePosition()
 205:main.c        **** {
 206:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, DIRD);
 207:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, DIRC);
 208:main.c        **** }
 209:main.c        **** 
 210:main.c        **** void setPosition(int force)
 211:main.c        **** {
 212:main.c        ****     setForce(force);
 213:main.c        ****     if (abs(curPos - position) > 5)
 214:main.c        ****     {
 215:main.c        ****         if (curPos > position)
 216:main.c        ****         {
 217:main.c        ****             lowerDown(force);
 218:main.c        ****         }
 219:main.c        ****         if (curPos < position)
 220:main.c        ****         {
 221:main.c        ****             liftUp(force);
 222:main.c        ****         }
 223:main.c        ****     }
 224:main.c        ****     else
 225:main.c        ****     {
 226:main.c        ****         releasePosition();
 227:main.c        ****     }
 228:main.c        **** }
 229:main.c        **** 
 230:main.c        **** void printTrace(char * trace)
 231:main.c        **** {
  79              		.loc 1 231 0
  80              		@ args = 0, pretend = 0, frame = 0
  81              		@ frame_needed = 0, uses_anonymous_args = 0
  82              	.LVL3:
  83 0050 30402DE9 		stmfd	sp!, {r4, r5, lr}
  84              	.LCFI2:
 232:main.c        ****     if (dataReading == 0)
  85              		.loc 1 232 0
  86 0054 2C309FE5 		ldr	r3, .L15
  87 0058 0030D3E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
  88 005c 000053E3 		cmp	r3, #0
 233:main.c        ****     {
 234:main.c        ****         pCDC.Write(&pCDC, trace, strlen(trace));
  89              		.loc 1 234 0
  90 0060 24509FE5 		ldr	r5, .L15+4
  91              		.loc 1 231 0
  92 0064 0040A0E1 		mov	r4, r0
  93              		.loc 1 232 0
  94 0068 3080BD18 		ldmnefd	sp!, {r4, r5, pc}
  95              	.LVL4:
  96              		.loc 1 234 0
  97 006c FEFFFFEB 		bl	strlen
  98 0070 0410A0E1 		mov	r1, r4
  99 0074 0020A0E1 		mov	r2, r0
 100 0078 0500A0E1 		mov	r0, r5
 101 007c 0FE0A0E1 		mov	lr, pc
 102 0080 10F095E5 		ldr	pc, [r5, #16]
 103 0084 3080BDE8 		ldmfd	sp!, {r4, r5, pc}
 104              	.L16:
 105              		.align	2
 106              	.L15:
 107 0088 00000000 		.word	dataReading
 108 008c 00000000 		.word	pCDC
 109              	.LFE298:
 111              		.align	2
 112              		.global	clearLEDs
 114              	clearLEDs:
 115              	.LFB289:
 116              		.loc 1 139 0
 117              		@ args = 0, pretend = 0, frame = 0
 118              		@ frame_needed = 0, uses_anonymous_args = 0
 119              		@ link register save eliminated.
 120              	.LBB8:
 121              	.LBB9:
 122              		.file 2 "lib_AT91SAM7S64.h"
   1:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   2:lib_AT91SAM7S64.h **** //*         ATMEL Microcontroller Software Support  -  ROUSSET  -
   3:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
   4:lib_AT91SAM7S64.h **** //* DISCLAIMER:  THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR
   5:lib_AT91SAM7S64.h **** //* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
   6:lib_AT91SAM7S64.h **** //* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
   7:lib_AT91SAM7S64.h **** //* DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT, INDIRECT,
   8:lib_AT91SAM7S64.h **** //* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   9:lib_AT91SAM7S64.h **** //* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
  10:lib_AT91SAM7S64.h **** //* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  11:lib_AT91SAM7S64.h **** //* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  12:lib_AT91SAM7S64.h **** //* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
  13:lib_AT91SAM7S64.h **** //* EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  14:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  15:lib_AT91SAM7S64.h **** //* File Name           : lib_AT91SAM7S64.h
  16:lib_AT91SAM7S64.h **** //* Object              : AT91SAM7S64 inlined functions
  17:lib_AT91SAM7S64.h **** //* Generated           : AT91 SW Application Group  03/08/2005 (15:46:05)
  18:lib_AT91SAM7S64.h **** //*
  19:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_dbgu.h/1.1/Fri Jan 31 12:18:40 2003//
  20:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pmc_SAM7S.h/1.1/Tue Feb  1 08:32:10 2005//
  21:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_VREG_6085B.h/1.1/Tue Feb  1 16:20:47 2005//
  22:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rstc_6098A.h/1.1/Wed Oct  6 10:39:20 2004//
  23:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_ssc.h/1.4/Fri Jan 31 12:19:20 2003//
  24:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_wdtc_6080A.h/1.1/Wed Oct  6 10:38:30 2004//
  25:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_usart.h/1.5/Thu Nov 21 16:01:54 2002//
  26:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_spi2.h/1.1/Mon Aug 25 14:23:52 2003//
  27:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pitc_6079A.h/1.2/Tue Nov  9 14:43:56 2004//
  28:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_aic.h/1.3/Fri Jul 12 08:46:12 2002//
  29:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_twi.h/1.3/Mon Jul 19 14:27:58 2004//
  30:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_adc.h/1.6/Fri Oct 17 09:12:38 2003//
  31:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_rttc_6081A.h/1.1/Wed Oct  6 10:39:38 2004//
  32:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_udp.h/1.4/Wed Feb 16 08:39:34 2005//
  33:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_tc_1753b.h/1.1/Fri Jan 31 12:20:02 2003//
  34:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_MC_SAM7S.h/1.1/Thu Mar 25 15:19:14 2004//
  35:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pio.h/1.3/Fri Jan 31 12:18:56 2003//
  36:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_PWM_SAM.h/1.3/Thu Jan 22 10:10:50 2004//
  37:lib_AT91SAM7S64.h **** //* CVS Reference       : /lib_pdc.h/1.2/Tue Jul  2 13:29:40 2002//
  38:lib_AT91SAM7S64.h **** //* ----------------------------------------------------------------------------
  39:lib_AT91SAM7S64.h **** 
  40:lib_AT91SAM7S64.h **** #ifndef lib_AT91SAM7S64_H
  41:lib_AT91SAM7S64.h **** #define lib_AT91SAM7S64_H
  42:lib_AT91SAM7S64.h **** 
  43:lib_AT91SAM7S64.h **** /* *****************************************************************************
  44:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR AIC
  45:lib_AT91SAM7S64.h ****    ***************************************************************************** */
  46:lib_AT91SAM7S64.h **** #define AT91C_AIC_BRANCH_OPCODE ((void (*) ()) 0xE51FFF20) // ldr, pc, [pc, #-&F20]
  47:lib_AT91SAM7S64.h **** 
  48:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  49:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ConfigureIt
  50:lib_AT91SAM7S64.h **** //* \brief Interrupt Handler Initialization
  51:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  52:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_AIC_ConfigureIt (
  53:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,  // \arg pointer to the AIC registers
  54:lib_AT91SAM7S64.h **** 	unsigned int irq_id,     // \arg interrupt number to initialize
  55:lib_AT91SAM7S64.h **** 	unsigned int priority,   // \arg priority to give to the interrupt
  56:lib_AT91SAM7S64.h **** 	unsigned int src_type,   // \arg activation and sense of activation
  57:lib_AT91SAM7S64.h **** 	void (*newHandler) (void) ) // \arg address of the interrupt handler
  58:lib_AT91SAM7S64.h **** {
  59:lib_AT91SAM7S64.h **** 	unsigned int oldHandler;
  60:lib_AT91SAM7S64.h ****     unsigned int mask ;
  61:lib_AT91SAM7S64.h **** 
  62:lib_AT91SAM7S64.h ****     oldHandler = pAic->AIC_SVR[irq_id];
  63:lib_AT91SAM7S64.h **** 
  64:lib_AT91SAM7S64.h ****     mask = 0x1 << irq_id ;
  65:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  66:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
  67:lib_AT91SAM7S64.h ****     //* Save the interrupt handler routine pointer and the interrupt priority
  68:lib_AT91SAM7S64.h ****     pAic->AIC_SVR[irq_id] = (unsigned int) newHandler ;
  69:lib_AT91SAM7S64.h ****     //* Store the Source Mode Register
  70:lib_AT91SAM7S64.h ****     pAic->AIC_SMR[irq_id] = src_type | priority  ;
  71:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the interrupt controller
  72:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
  73:lib_AT91SAM7S64.h **** 
  74:lib_AT91SAM7S64.h **** 	return oldHandler;
  75:lib_AT91SAM7S64.h **** }
  76:lib_AT91SAM7S64.h **** 
  77:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  78:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_EnableIt
  79:lib_AT91SAM7S64.h **** //* \brief Enable corresponding IT number
  80:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  81:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_EnableIt (
  82:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  83:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  84:lib_AT91SAM7S64.h **** {
  85:lib_AT91SAM7S64.h ****     //* Enable the interrupt on the interrupt controller
  86:lib_AT91SAM7S64.h ****     pAic->AIC_IECR = 0x1 << irq_id ;
  87:lib_AT91SAM7S64.h **** }
  88:lib_AT91SAM7S64.h **** 
  89:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  90:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_DisableIt
  91:lib_AT91SAM7S64.h **** //* \brief Disable corresponding IT number
  92:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
  93:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_DisableIt (
  94:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,      // \arg pointer to the AIC registers
  95:lib_AT91SAM7S64.h **** 	unsigned int irq_id ) // \arg interrupt number to initialize
  96:lib_AT91SAM7S64.h **** {
  97:lib_AT91SAM7S64.h ****     unsigned int mask = 0x1 << irq_id;
  98:lib_AT91SAM7S64.h ****     //* Disable the interrupt on the interrupt controller
  99:lib_AT91SAM7S64.h ****     pAic->AIC_IDCR = mask ;
 100:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 101:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = mask ;
 102:lib_AT91SAM7S64.h **** }
 103:lib_AT91SAM7S64.h **** 
 104:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 105:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_ClearIt
 106:lib_AT91SAM7S64.h **** //* \brief Clear corresponding IT number
 107:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 108:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_ClearIt (
 109:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 110:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number to initialize
 111:lib_AT91SAM7S64.h **** {
 112:lib_AT91SAM7S64.h ****     //* Clear the interrupt on the Interrupt Controller ( if one is pending )
 113:lib_AT91SAM7S64.h ****     pAic->AIC_ICCR = (0x1 << irq_id);
 114:lib_AT91SAM7S64.h **** }
 115:lib_AT91SAM7S64.h **** 
 116:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 117:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_AcknowledgeIt
 118:lib_AT91SAM7S64.h **** //* \brief Acknowledge corresponding IT number
 119:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 120:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_AcknowledgeIt (
 121:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic)     // \arg pointer to the AIC registers
 122:lib_AT91SAM7S64.h **** {
 123:lib_AT91SAM7S64.h ****     pAic->AIC_EOICR = pAic->AIC_EOICR;
 124:lib_AT91SAM7S64.h **** }
 125:lib_AT91SAM7S64.h **** 
 126:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 127:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_SetExceptionVector
 128:lib_AT91SAM7S64.h **** //* \brief Configure vector handler
 129:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 130:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_SetExceptionVector (
 131:lib_AT91SAM7S64.h **** 	unsigned int *pVector, // \arg pointer to the AIC registers
 132:lib_AT91SAM7S64.h **** 	void (*Handler) () )   // \arg Interrupt Handler
 133:lib_AT91SAM7S64.h **** {
 134:lib_AT91SAM7S64.h **** 	unsigned int oldVector = *pVector;
 135:lib_AT91SAM7S64.h **** 
 136:lib_AT91SAM7S64.h **** 	if ((unsigned int) Handler == (unsigned int) AT91C_AIC_BRANCH_OPCODE)
 137:lib_AT91SAM7S64.h **** 		*pVector = (unsigned int) AT91C_AIC_BRANCH_OPCODE;
 138:lib_AT91SAM7S64.h **** 	else
 139:lib_AT91SAM7S64.h **** 		*pVector = (((((unsigned int) Handler) - ((unsigned int) pVector) - 0x8) >> 2) & 0x00FFFFFF) | 0x
 140:lib_AT91SAM7S64.h **** 
 141:lib_AT91SAM7S64.h **** 	return oldVector;
 142:lib_AT91SAM7S64.h **** }
 143:lib_AT91SAM7S64.h **** 
 144:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 145:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Trig
 146:lib_AT91SAM7S64.h **** //* \brief Trig an IT
 147:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 148:lib_AT91SAM7S64.h **** __inline void  AT91F_AIC_Trig (
 149:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 150:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg interrupt number
 151:lib_AT91SAM7S64.h **** {
 152:lib_AT91SAM7S64.h **** 	pAic->AIC_ISCR = (0x1 << irq_id) ;
 153:lib_AT91SAM7S64.h **** }
 154:lib_AT91SAM7S64.h **** 
 155:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 156:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsActive
 157:lib_AT91SAM7S64.h **** //* \brief Test if an IT is active
 158:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 159:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsActive (
 160:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 161:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 162:lib_AT91SAM7S64.h **** {
 163:lib_AT91SAM7S64.h **** 	return (pAic->AIC_ISR & (0x1 << irq_id));
 164:lib_AT91SAM7S64.h **** }
 165:lib_AT91SAM7S64.h **** 
 166:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 167:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_IsPending
 168:lib_AT91SAM7S64.h **** //* \brief Test if an IT is pending
 169:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 170:lib_AT91SAM7S64.h **** __inline unsigned int  AT91F_AIC_IsPending (
 171:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,     // \arg pointer to the AIC registers
 172:lib_AT91SAM7S64.h **** 	unsigned int irq_id) // \arg Interrupt Number
 173:lib_AT91SAM7S64.h **** {
 174:lib_AT91SAM7S64.h **** 	return (pAic->AIC_IPR & (0x1 << irq_id));
 175:lib_AT91SAM7S64.h **** }
 176:lib_AT91SAM7S64.h **** 
 177:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 178:lib_AT91SAM7S64.h **** //* \fn    AT91F_AIC_Open
 179:lib_AT91SAM7S64.h **** //* \brief Set exception vectors and AIC registers to default values
 180:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 181:lib_AT91SAM7S64.h **** __inline void AT91F_AIC_Open(
 182:lib_AT91SAM7S64.h **** 	AT91PS_AIC pAic,        // \arg pointer to the AIC registers
 183:lib_AT91SAM7S64.h **** 	void (*IrqHandler) (),  // \arg Default IRQ vector exception
 184:lib_AT91SAM7S64.h **** 	void (*FiqHandler) (),  // \arg Default FIQ vector exception
 185:lib_AT91SAM7S64.h **** 	void (*DefaultHandler)  (), // \arg Default Handler set in ISR
 186:lib_AT91SAM7S64.h **** 	void (*SpuriousHandler) (), // \arg Default Spurious Handler
 187:lib_AT91SAM7S64.h **** 	unsigned int protectMode)   // \arg Debug Control Register
 188:lib_AT91SAM7S64.h **** {
 189:lib_AT91SAM7S64.h **** 	int i;
 190:lib_AT91SAM7S64.h **** 
 191:lib_AT91SAM7S64.h **** 	// Disable all interrupts and set IVR to the default handler
 192:lib_AT91SAM7S64.h **** 	for (i = 0; i < 32; ++i) {
 193:lib_AT91SAM7S64.h **** 		AT91F_AIC_DisableIt(pAic, i);
 194:lib_AT91SAM7S64.h **** 		AT91F_AIC_ConfigureIt(pAic, i, AT91C_AIC_PRIOR_LOWEST, AT91C_AIC_SRCTYPE_INT_LEVEL_SENSITIVE, Def
 195:lib_AT91SAM7S64.h **** 	}
 196:lib_AT91SAM7S64.h **** 
 197:lib_AT91SAM7S64.h **** 	// Set the IRQ exception vector
 198:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x18, IrqHandler);
 199:lib_AT91SAM7S64.h **** 	// Set the Fast Interrupt exception vector
 200:lib_AT91SAM7S64.h **** 	AT91F_AIC_SetExceptionVector((unsigned int *) 0x1C, FiqHandler);
 201:lib_AT91SAM7S64.h **** 
 202:lib_AT91SAM7S64.h **** 	pAic->AIC_SPU = (unsigned int) SpuriousHandler;
 203:lib_AT91SAM7S64.h **** 	pAic->AIC_DCR = protectMode;
 204:lib_AT91SAM7S64.h **** }
 205:lib_AT91SAM7S64.h **** /* *****************************************************************************
 206:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PDC
 207:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 208:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 209:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextRx
 210:lib_AT91SAM7S64.h **** //* \brief Set the next receive transfer descriptor
 211:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 212:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextRx (
 213:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,     // \arg pointer to a PDC controller
 214:lib_AT91SAM7S64.h **** 	char *address,       // \arg address to the next bloc to be received
 215:lib_AT91SAM7S64.h **** 	unsigned int bytes)  // \arg number of bytes to be received
 216:lib_AT91SAM7S64.h **** {
 217:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNPR = (unsigned int) address;
 218:lib_AT91SAM7S64.h **** 	pPDC->PDC_RNCR = bytes;
 219:lib_AT91SAM7S64.h **** }
 220:lib_AT91SAM7S64.h **** 
 221:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 222:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetNextTx
 223:lib_AT91SAM7S64.h **** //* \brief Set the next transmit transfer descriptor
 224:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 225:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetNextTx (
 226:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 227:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 228:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 229:lib_AT91SAM7S64.h **** {
 230:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNPR = (unsigned int) address;
 231:lib_AT91SAM7S64.h **** 	pPDC->PDC_TNCR = bytes;
 232:lib_AT91SAM7S64.h **** }
 233:lib_AT91SAM7S64.h **** 
 234:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 235:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetRx
 236:lib_AT91SAM7S64.h **** //* \brief Set the receive transfer descriptor
 237:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 238:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetRx (
 239:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 240:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be received
 241:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be received
 242:lib_AT91SAM7S64.h **** {
 243:lib_AT91SAM7S64.h **** 	pPDC->PDC_RPR = (unsigned int) address;
 244:lib_AT91SAM7S64.h **** 	pPDC->PDC_RCR = bytes;
 245:lib_AT91SAM7S64.h **** }
 246:lib_AT91SAM7S64.h **** 
 247:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 248:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SetTx
 249:lib_AT91SAM7S64.h **** //* \brief Set the transmit transfer descriptor
 250:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 251:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_SetTx (
 252:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,       // \arg pointer to a PDC controller
 253:lib_AT91SAM7S64.h **** 	char *address,         // \arg address to the next bloc to be transmitted
 254:lib_AT91SAM7S64.h **** 	unsigned int bytes)    // \arg number of bytes to be transmitted
 255:lib_AT91SAM7S64.h **** {
 256:lib_AT91SAM7S64.h **** 	pPDC->PDC_TPR = (unsigned int) address;
 257:lib_AT91SAM7S64.h **** 	pPDC->PDC_TCR = bytes;
 258:lib_AT91SAM7S64.h **** }
 259:lib_AT91SAM7S64.h **** 
 260:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 261:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableTx
 262:lib_AT91SAM7S64.h **** //* \brief Enable transmit
 263:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 264:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableTx (
 265:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 266:lib_AT91SAM7S64.h **** {
 267:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTEN;
 268:lib_AT91SAM7S64.h **** }
 269:lib_AT91SAM7S64.h **** 
 270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_EnableRx
 272:lib_AT91SAM7S64.h **** //* \brief Enable receive
 273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 274:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_EnableRx (
 275:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 276:lib_AT91SAM7S64.h **** {
 277:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTEN;
 278:lib_AT91SAM7S64.h **** }
 279:lib_AT91SAM7S64.h **** 
 280:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 281:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableTx
 282:lib_AT91SAM7S64.h **** //* \brief Disable transmit
 283:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 284:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableTx (
 285:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 286:lib_AT91SAM7S64.h **** {
 287:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_TXTDIS;
 288:lib_AT91SAM7S64.h **** }
 289:lib_AT91SAM7S64.h **** 
 290:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 291:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_DisableRx
 292:lib_AT91SAM7S64.h **** //* \brief Disable receive
 293:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 294:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_DisableRx (
 295:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 296:lib_AT91SAM7S64.h **** {
 297:lib_AT91SAM7S64.h **** 	pPDC->PDC_PTCR = AT91C_PDC_RXTDIS;
 298:lib_AT91SAM7S64.h **** }
 299:lib_AT91SAM7S64.h **** 
 300:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 301:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsTxEmpty
 302:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been sent
 303:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 304:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsTxEmpty ( // \return return 1 if transfer is complete
 305:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 306:lib_AT91SAM7S64.h **** {
 307:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TCR);
 308:lib_AT91SAM7S64.h **** }
 309:lib_AT91SAM7S64.h **** 
 310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 311:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextTxEmpty
 312:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 314:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextTxEmpty ( // \return return 1 if transfer is complete
 315:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 316:lib_AT91SAM7S64.h **** {
 317:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_TNCR);
 318:lib_AT91SAM7S64.h **** }
 319:lib_AT91SAM7S64.h **** 
 320:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 321:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsRxEmpty
 322:lib_AT91SAM7S64.h **** //* \brief Test if the current transfer descriptor has been filled
 323:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 324:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsRxEmpty ( // \return return 1 if transfer is complete
 325:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 326:lib_AT91SAM7S64.h **** {
 327:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RCR);
 328:lib_AT91SAM7S64.h **** }
 329:lib_AT91SAM7S64.h **** 
 330:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 331:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_IsNextRxEmpty
 332:lib_AT91SAM7S64.h **** //* \brief Test if the next transfer descriptor has been moved to the current td
 333:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 334:lib_AT91SAM7S64.h **** __inline int AT91F_PDC_IsNextRxEmpty ( // \return return 1 if transfer is complete
 335:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC )       // \arg pointer to a PDC controller
 336:lib_AT91SAM7S64.h **** {
 337:lib_AT91SAM7S64.h **** 	return !(pPDC->PDC_RNCR);
 338:lib_AT91SAM7S64.h **** }
 339:lib_AT91SAM7S64.h **** 
 340:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 341:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Open
 342:lib_AT91SAM7S64.h **** //* \brief Open PDC: disable TX and RX reset transfer descriptors, re-enable RX and TX
 343:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 344:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Open (
 345:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 346:lib_AT91SAM7S64.h **** {
 347:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 348:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 349:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 350:lib_AT91SAM7S64.h **** 
 351:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 352:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 353:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 354:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 355:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 356:lib_AT91SAM7S64.h **** 
 357:lib_AT91SAM7S64.h ****     //* Enable the RX and TX PDC transfer requests
 358:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableRx(pPDC);
 359:lib_AT91SAM7S64.h **** 	AT91F_PDC_EnableTx(pPDC);
 360:lib_AT91SAM7S64.h **** }
 361:lib_AT91SAM7S64.h **** 
 362:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 363:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_Close
 364:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 365:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 366:lib_AT91SAM7S64.h **** __inline void AT91F_PDC_Close (
 367:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC)       // \arg pointer to a PDC controller
 368:lib_AT91SAM7S64.h **** {
 369:lib_AT91SAM7S64.h ****     //* Disable the RX and TX PDC transfer requests
 370:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableRx(pPDC);
 371:lib_AT91SAM7S64.h **** 	AT91F_PDC_DisableTx(pPDC);
 372:lib_AT91SAM7S64.h **** 
 373:lib_AT91SAM7S64.h **** 	//* Reset all Counter register Next buffer first
 374:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextTx(pPDC, (char *) 0, 0);
 375:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetNextRx(pPDC, (char *) 0, 0);
 376:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetTx(pPDC, (char *) 0, 0);
 377:lib_AT91SAM7S64.h **** 	AT91F_PDC_SetRx(pPDC, (char *) 0, 0);
 378:lib_AT91SAM7S64.h **** 
 379:lib_AT91SAM7S64.h **** }
 380:lib_AT91SAM7S64.h **** 
 381:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 382:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_SendFrame
 383:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 384:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 385:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_SendFrame(
 386:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 387:lib_AT91SAM7S64.h **** 	char *pBuffer,
 388:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 389:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 390:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 391:lib_AT91SAM7S64.h **** {
 392:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsTxEmpty(pPDC)) {
 393:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 394:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetTx(pPDC, pBuffer, szBuffer);
 395:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pNextBuffer, szNextBuffer);
 396:lib_AT91SAM7S64.h **** 		return 2;
 397:lib_AT91SAM7S64.h **** 	}
 398:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextTxEmpty(pPDC)) {
 399:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 400:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextTx(pPDC, pBuffer, szBuffer);
 401:lib_AT91SAM7S64.h **** 		return 1;
 402:lib_AT91SAM7S64.h **** 	}
 403:lib_AT91SAM7S64.h **** 	else {
 404:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 405:lib_AT91SAM7S64.h **** 		return 0;
 406:lib_AT91SAM7S64.h **** 	}
 407:lib_AT91SAM7S64.h **** }
 408:lib_AT91SAM7S64.h **** 
 409:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 410:lib_AT91SAM7S64.h **** //* \fn    AT91F_PDC_ReceiveFrame
 411:lib_AT91SAM7S64.h **** //* \brief Close PDC: disable TX and RX reset transfer descriptors
 412:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 413:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PDC_ReceiveFrame (
 414:lib_AT91SAM7S64.h **** 	AT91PS_PDC pPDC,
 415:lib_AT91SAM7S64.h **** 	char *pBuffer,
 416:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
 417:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
 418:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
 419:lib_AT91SAM7S64.h **** {
 420:lib_AT91SAM7S64.h **** 	if (AT91F_PDC_IsRxEmpty(pPDC)) {
 421:lib_AT91SAM7S64.h **** 		//* Buffer and next buffer can be initialized
 422:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetRx(pPDC, pBuffer, szBuffer);
 423:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pNextBuffer, szNextBuffer);
 424:lib_AT91SAM7S64.h **** 		return 2;
 425:lib_AT91SAM7S64.h **** 	}
 426:lib_AT91SAM7S64.h **** 	else if (AT91F_PDC_IsNextRxEmpty(pPDC)) {
 427:lib_AT91SAM7S64.h **** 		//* Only one buffer can be initialized
 428:lib_AT91SAM7S64.h **** 		AT91F_PDC_SetNextRx(pPDC, pBuffer, szBuffer);
 429:lib_AT91SAM7S64.h **** 		return 1;
 430:lib_AT91SAM7S64.h **** 	}
 431:lib_AT91SAM7S64.h **** 	else {
 432:lib_AT91SAM7S64.h **** 		//* All buffer are in use...
 433:lib_AT91SAM7S64.h **** 		return 0;
 434:lib_AT91SAM7S64.h **** 	}
 435:lib_AT91SAM7S64.h **** }
 436:lib_AT91SAM7S64.h **** /* *****************************************************************************
 437:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR DBGU
 438:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 439:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 440:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptEnable
 441:lib_AT91SAM7S64.h **** //* \brief Enable DBGU Interrupt
 442:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 443:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptEnable(
 444:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 445:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be enabled
 446:lib_AT91SAM7S64.h **** {
 447:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IER = flag;
 448:lib_AT91SAM7S64.h **** }
 449:lib_AT91SAM7S64.h **** 
 450:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 451:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_InterruptDisable
 452:lib_AT91SAM7S64.h **** //* \brief Disable DBGU Interrupt
 453:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 454:lib_AT91SAM7S64.h **** __inline void AT91F_DBGU_InterruptDisable(
 455:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 456:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  dbgu interrupt to be disabled
 457:lib_AT91SAM7S64.h **** {
 458:lib_AT91SAM7S64.h ****         pDbgu->DBGU_IDR = flag;
 459:lib_AT91SAM7S64.h **** }
 460:lib_AT91SAM7S64.h **** 
 461:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 462:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_GetInterruptMaskStatus
 463:lib_AT91SAM7S64.h **** //* \brief Return DBGU Interrupt Mask Status
 464:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 465:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_DBGU_GetInterruptMaskStatus( // \return DBGU Interrupt Mask Status
 466:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu) // \arg  pointer to a DBGU controller
 467:lib_AT91SAM7S64.h **** {
 468:lib_AT91SAM7S64.h ****         return pDbgu->DBGU_IMR;
 469:lib_AT91SAM7S64.h **** }
 470:lib_AT91SAM7S64.h **** 
 471:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 472:lib_AT91SAM7S64.h **** //* \fn    AT91F_DBGU_IsInterruptMasked
 473:lib_AT91SAM7S64.h **** //* \brief Test if DBGU Interrupt is Masked 
 474:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 475:lib_AT91SAM7S64.h **** __inline int AT91F_DBGU_IsInterruptMasked(
 476:lib_AT91SAM7S64.h ****         AT91PS_DBGU pDbgu,   // \arg  pointer to a DBGU controller
 477:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 478:lib_AT91SAM7S64.h **** {
 479:lib_AT91SAM7S64.h ****         return (AT91F_DBGU_GetInterruptMaskStatus(pDbgu) & flag);
 480:lib_AT91SAM7S64.h **** }
 481:lib_AT91SAM7S64.h **** 
 482:lib_AT91SAM7S64.h **** /* *****************************************************************************
 483:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PIO
 484:lib_AT91SAM7S64.h ****    ***************************************************************************** */
 485:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 486:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPeriph
 487:lib_AT91SAM7S64.h **** //* \brief Enable pins to be drived by peripheral
 488:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 489:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPeriph(
 490:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 491:lib_AT91SAM7S64.h **** 	unsigned int periphAEnable,  // \arg PERIPH A to enable
 492:lib_AT91SAM7S64.h **** 	unsigned int periphBEnable)  // \arg PERIPH B to enable
 493:lib_AT91SAM7S64.h **** 
 494:lib_AT91SAM7S64.h **** {
 495:lib_AT91SAM7S64.h **** 	pPio->PIO_ASR = periphAEnable;
 496:lib_AT91SAM7S64.h **** 	pPio->PIO_BSR = periphBEnable;
 497:lib_AT91SAM7S64.h **** 	pPio->PIO_PDR = (periphAEnable | periphBEnable); // Set in Periph mode
 498:lib_AT91SAM7S64.h **** }
 499:lib_AT91SAM7S64.h **** 
 500:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 501:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOutput
 502:lib_AT91SAM7S64.h **** //* \brief Enable PIO in output mode
 503:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 504:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOutput(
 505:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 506:lib_AT91SAM7S64.h **** 	unsigned int pioEnable)      // \arg PIO to be enabled
 507:lib_AT91SAM7S64.h **** {
 508:lib_AT91SAM7S64.h **** 	pPio->PIO_PER = pioEnable; // Set in PIO mode
 509:lib_AT91SAM7S64.h **** 	pPio->PIO_OER = pioEnable; // Configure in Output
 510:lib_AT91SAM7S64.h **** }
 511:lib_AT91SAM7S64.h **** 
 512:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 513:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInput
 514:lib_AT91SAM7S64.h **** //* \brief Enable PIO in input mode
 515:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 516:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInput(
 517:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 518:lib_AT91SAM7S64.h **** 	unsigned int inputEnable)      // \arg PIO to be enabled
 519:lib_AT91SAM7S64.h **** {
 520:lib_AT91SAM7S64.h **** 	// Disable output
 521:lib_AT91SAM7S64.h **** 	pPio->PIO_ODR  = inputEnable;
 522:lib_AT91SAM7S64.h **** 	pPio->PIO_PER  = inputEnable;
 523:lib_AT91SAM7S64.h **** }
 524:lib_AT91SAM7S64.h **** 
 525:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 526:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgOpendrain
 527:lib_AT91SAM7S64.h **** //* \brief Configure PIO in open drain
 528:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 529:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgOpendrain(
 530:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 531:lib_AT91SAM7S64.h **** 	unsigned int multiDrvEnable) // \arg pio to be configured in open drain
 532:lib_AT91SAM7S64.h **** {
 533:lib_AT91SAM7S64.h **** 	// Configure the multi-drive option
 534:lib_AT91SAM7S64.h **** 	pPio->PIO_MDDR = ~multiDrvEnable;
 535:lib_AT91SAM7S64.h **** 	pPio->PIO_MDER = multiDrvEnable;
 536:lib_AT91SAM7S64.h **** }
 537:lib_AT91SAM7S64.h **** 
 538:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 539:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgPullup
 540:lib_AT91SAM7S64.h **** //* \brief Enable pullup on PIO
 541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 542:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgPullup(
 543:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 544:lib_AT91SAM7S64.h **** 	unsigned int pullupEnable)   // \arg enable pullup on PIO
 545:lib_AT91SAM7S64.h **** {
 546:lib_AT91SAM7S64.h **** 		// Connect or not Pullup
 547:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUDR = ~pullupEnable;
 548:lib_AT91SAM7S64.h **** 	pPio->PIO_PPUER = pullupEnable;
 549:lib_AT91SAM7S64.h **** }
 550:lib_AT91SAM7S64.h **** 
 551:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 552:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgDirectDrive
 553:lib_AT91SAM7S64.h **** //* \brief Enable direct drive on PIO
 554:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 555:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgDirectDrive(
 556:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 557:lib_AT91SAM7S64.h **** 	unsigned int directDrive)    // \arg PIO to be configured with direct drive
 558:lib_AT91SAM7S64.h **** 
 559:lib_AT91SAM7S64.h **** {
 560:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 561:lib_AT91SAM7S64.h **** 	pPio->PIO_OWDR  = ~directDrive;
 562:lib_AT91SAM7S64.h **** 	pPio->PIO_OWER  = directDrive;
 563:lib_AT91SAM7S64.h **** }
 564:lib_AT91SAM7S64.h **** 
 565:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 566:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_CfgInputFilter
 567:lib_AT91SAM7S64.h **** //* \brief Enable input filter on input PIO
 568:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 569:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_CfgInputFilter(
 570:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,             // \arg pointer to a PIO controller
 571:lib_AT91SAM7S64.h **** 	unsigned int inputFilter)    // \arg PIO to be configured with input filter
 572:lib_AT91SAM7S64.h **** 
 573:lib_AT91SAM7S64.h **** {
 574:lib_AT91SAM7S64.h **** 	// Configure the Direct Drive
 575:lib_AT91SAM7S64.h **** 	pPio->PIO_IFDR  = ~inputFilter;
 576:lib_AT91SAM7S64.h **** 	pPio->PIO_IFER  = inputFilter;
 577:lib_AT91SAM7S64.h **** }
 578:lib_AT91SAM7S64.h **** 
 579:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 580:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInput
 581:lib_AT91SAM7S64.h **** //* \brief Return PIO input value
 582:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 583:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInput( // \return PIO input
 584:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 585:lib_AT91SAM7S64.h **** {
 586:lib_AT91SAM7S64.h **** 	return pPio->PIO_PDSR;
 587:lib_AT91SAM7S64.h **** }
 588:lib_AT91SAM7S64.h **** 
 589:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 590:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputSet
 591:lib_AT91SAM7S64.h **** //* \brief Test if PIO is input flag is active
 592:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 593:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputSet(
 594:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 595:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  flag to be tested
 596:lib_AT91SAM7S64.h **** {
 597:lib_AT91SAM7S64.h **** 	return (AT91F_PIO_GetInput(pPio) & flag);
 598:lib_AT91SAM7S64.h **** }
 599:lib_AT91SAM7S64.h **** 
 600:lib_AT91SAM7S64.h **** 
 601:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 602:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_SetOutput
 603:lib_AT91SAM7S64.h **** //* \brief Set to 1 output PIO
 604:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 605:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_SetOutput(
 606:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 607:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be set
 608:lib_AT91SAM7S64.h **** {
 609:lib_AT91SAM7S64.h **** 	pPio->PIO_SODR = flag;
 610:lib_AT91SAM7S64.h **** }
 611:lib_AT91SAM7S64.h **** 
 612:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 613:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ClearOutput
 614:lib_AT91SAM7S64.h **** //* \brief Set to 0 output PIO
 615:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 616:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ClearOutput(
 617:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 618:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be cleared
 619:lib_AT91SAM7S64.h **** {
 620:lib_AT91SAM7S64.h **** 	pPio->PIO_CODR = flag;
 123              		.loc 2 620 0
 124 0090 0B2CE0E3 		mvn	r2, #2816
 125 0094 0830A0E3 		mov	r3, #8
 126 0098 CB3002E5 		str	r3, [r2, #-203]
 127              	.LBE9:
 128              	.LBE8:
 129              	.LBB10:
 130              	.LBB11:
 131 009c 033083E0 		add	r3, r3, r3
 132 00a0 CB3002E5 		str	r3, [r2, #-203]
 133              	.LBE11:
 134              	.LBE10:
 135              	.LBB12:
 136              	.LBB13:
 137 00a4 103083E2 		add	r3, r3, #16
 138              	.LBE13:
 139              	.LBE12:
 140              		.loc 1 139 0
 141              		@ lr needed for prologue
 142              	.LBB14:
 143              	.LBB15:
 144              		.loc 2 620 0
 145 00a8 CB3002E5 		str	r3, [r2, #-203]
 146              	.LBE15:
 147              	.LBE14:
 148              		.loc 1 143 0
 149 00ac 1EFF2FE1 		bx	lr
 150              	.LFE289:
 152              		.align	2
 153              		.global	releasePosition
 155              	releasePosition:
 156              	.LFB296:
 157              		.loc 1 205 0
 158              		@ args = 0, pretend = 0, frame = 0
 159              		@ frame_needed = 0, uses_anonymous_args = 0
 160              		@ link register save eliminated.
 161              	.LBB20:
 162              	.LBB21:
 163              		.loc 2 620 0
 164 00b0 0B3CE0E3 		mvn	r3, #2816
 165 00b4 8020A0E3 		mov	r2, #128
 166 00b8 CB2003E5 		str	r2, [r3, #-203]
 167              	.LBE21:
 168              	.LBE20:
 169              	.LBB22:
 170              	.LBB23:
 171 00bc 4020A0E3 		mov	r2, #64
 172              	.LBE23:
 173              	.LBE22:
 174              		.loc 1 205 0
 175              		@ lr needed for prologue
 176              	.LBB24:
 177              	.LBB25:
 178              		.loc 2 620 0
 179 00c0 CB2003E5 		str	r2, [r3, #-203]
 180              	.LBE25:
 181              	.LBE24:
 182              		.loc 1 208 0
 183 00c4 1EFF2FE1 		bx	lr
 184              	.LFE296:
 186              		.align	2
 187              		.global	startBlinking
 189              	startBlinking:
 190              	.LFB291:
 191              		.loc 1 155 0
 192              		@ args = 0, pretend = 0, frame = 0
 193              		@ frame_needed = 0, uses_anonymous_args = 0
 194              	.LVL5:
 195 00c8 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 196              	.LCFI3:
 197              	.LBB38:
 198              	.LBB39:
 199              		.loc 2 609 0
 200 00cc 0B5CE0E3 		mvn	r5, #2816
 201 00d0 0840A0E3 		mov	r4, #8
 202              	.LBE39:
 203              	.LBE38:
 204              		.loc 1 155 0
 205 00d4 0060A0E1 		mov	r6, r0
 206              	.LBB40:
 207              	.LBB41:
 208              		.loc 2 609 0
 209 00d8 CF4005E5 		str	r4, [r5, #-207]
 210              	.LBE41:
 211              	.LBE40:
 212              		.loc 1 159 0
 213 00dc FEFFFFEB 		bl	Delay
 214              	.LVL6:
 215              	.LBB42:
 216              	.LBB43:
 217              		.loc 2 620 0
 218 00e0 CB4005E5 		str	r4, [r5, #-203]
 219              	.LBE43:
 220              	.LBE42:
 221              		.loc 1 161 0
 222 00e4 0600A0E1 		mov	r0, r6
 223              	.LBB44:
 224              	.LBB45:
 225              		.loc 2 609 0
 226 00e8 044084E0 		add	r4, r4, r4
 227              	.LBE45:
 228              	.LBE44:
 229              		.loc 1 161 0
 230 00ec FEFFFFEB 		bl	Delay
 231              	.LBB46:
 232              	.LBB47:
 233              		.loc 2 609 0
 234 00f0 CF4005E5 		str	r4, [r5, #-207]
 235              	.LBE47:
 236              	.LBE46:
 237              		.loc 1 164 0
 238 00f4 0600A0E1 		mov	r0, r6
 239 00f8 FEFFFFEB 		bl	Delay
 240              	.LBB48:
 241              	.LBB49:
 242              		.loc 2 620 0
 243 00fc CB4005E5 		str	r4, [r5, #-203]
 244              	.LBE49:
 245              	.LBE48:
 246              		.loc 1 166 0
 247 0100 0600A0E1 		mov	r0, r6
 248              	.LBB50:
 249              	.LBB51:
 250              		.loc 2 609 0
 251 0104 104084E2 		add	r4, r4, #16
 252              	.LBE51:
 253              	.LBE50:
 254              		.loc 1 166 0
 255 0108 FEFFFFEB 		bl	Delay
 256              		.loc 1 169 0
 257 010c 0600A0E1 		mov	r0, r6
 258              	.LBB52:
 259              	.LBB53:
 260              		.loc 2 609 0
 261 0110 CF4005E5 		str	r4, [r5, #-207]
 262              	.LBE53:
 263              	.LBE52:
 264              		.loc 1 169 0
 265 0114 FEFFFFEB 		bl	Delay
 266              		.loc 1 171 0
 267 0118 0600A0E1 		mov	r0, r6
 268              	.LBB54:
 269              	.LBB55:
 270              		.loc 2 620 0
 271 011c CB4005E5 		str	r4, [r5, #-203]
 272              	.LBE55:
 273              	.LBE54:
 274              		.loc 1 172 0
 275 0120 7040BDE8 		ldmfd	sp!, {r4, r5, r6, lr}
 276              		.loc 1 171 0
 277 0124 FEFFFFEA 		b	Delay
 278              	.LFE291:
 280              		.align	2
 281              		.global	blinkingGreen
 283              	blinkingGreen:
 284              	.LFB290:
 285              		.loc 1 146 0
 286              		@ args = 0, pretend = 0, frame = 0
 287              		@ frame_needed = 0, uses_anonymous_args = 0
 288              	.LVL7:
 289 0128 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 290              	.LCFI4:
 291              	.LBB60:
 292              	.LBB61:
 293              		.loc 2 609 0
 294 012c 0B5CE0E3 		mvn	r5, #2816
 295 0130 2040A0E3 		mov	r4, #32
 296 0134 CF4005E5 		str	r4, [r5, #-207]
 297              	.LBE61:
 298              	.LBE60:
 299              		.loc 1 146 0
 300 0138 0060A0E1 		mov	r6, r0
 301              		.loc 1 149 0
 302 013c FEFFFFEB 		bl	Delay
 303              	.LVL8:
 304              		.loc 1 151 0
 305 0140 0600A0E1 		mov	r0, r6
 306              	.LBB62:
 307              	.LBB63:
 308              		.loc 2 620 0
 309 0144 CB4005E5 		str	r4, [r5, #-203]
 310              	.LBE63:
 311              	.LBE62:
 312              		.loc 1 152 0
 313 0148 7040BDE8 		ldmfd	sp!, {r4, r5, r6, lr}
 314              		.loc 1 151 0
 315 014c FEFFFFEA 		b	Delay
 316              	.LFE290:
 318              		.section	.rodata.str1.4,"aMS",%progbits,1
 319              		.align	2
 320              	.LC1:
 321 0000 54455354 		.ascii	"TEST\000"
 321      00
 322 0005 000000   		.align	2
 323              	.LC2:
 324 0008 494E4954 		.ascii	"INITIAL TEST\015\012\000"
 324      49414C20 
 324      54455354 
 324      0D0A00
 325 0017 00       		.align	2
 326              	.LC3:
 327 0018 44494147 		.ascii	"DIAG\000"
 327      00
 328 001d 000000   		.align	2
 329              	.LC4:
 330 0020 53544152 		.ascii	"START\000"
 330      5400
 331 0026 0000     		.align	2
 332              	.LC5:
 333 0028 53544F50 		.ascii	"STOP\000"
 333      00
 334 002d 000000   		.align	2
 335              	.LC6:
 336 0030 53544550 		.ascii	"STEP4\000"
 336      3400
 337 0036 0000     		.align	2
 338              	.LC7:
 339 0038 44494147 		.ascii	"DIAG#3#DONE\015\012\000"
 339      23332344 
 339      4F4E450D 
 339      0A00
 340 0046 0000     		.align	2
 341              	.LC8:
 342 0048 504F5349 		.ascii	"POSITION\000"
 342      54494F4E 
 342      00
 343 0051 000000   		.align	2
 344              	.LC9:
 345 0054 4D415800 		.ascii	"MAX\000"
 346              		.align	2
 347              	.LC10:
 348 0058 4D415820 		.ascii	"MAX POSITION IS SET TO: %d\015\012\000"
 348      504F5349 
 348      54494F4E 
 348      20495320 
 348      53455420 
 349 0075 000000   		.align	2
 350              	.LC11:
 351 0078 4D494E00 		.ascii	"MIN\000"
 352              		.align	2
 353              	.LC12:
 354 007c 4D494E20 		.ascii	"MIN POSITION IS SET TO: %d\015\012\000"
 354      504F5349 
 354      54494F4E 
 354      20495320 
 354      53455420 
 355 0099 000000   		.align	2
 356              	.LC13:
 357 009c 53455400 		.ascii	"SET\000"
 358              		.align	2
 359              	.LC14:
 360 00a0 43555252 		.ascii	"CURRENT POSITION IS SET TO: %d\015\012\000"
 360      454E5420 
 360      504F5349 
 360      54494F4E 
 360      20495320 
 361 00c1 000000   		.align	2
 362              	.LC15:
 363 00c4 464F5243 		.ascii	"FORCE\000"
 363      4500
 364 00ca 0000     		.align	2
 365              	.LC16:
 366 00cc 4D415820 		.ascii	"MAX FORCE IS SET TO: %d\015\012\000"
 366      464F5243 
 366      45204953 
 366      20534554 
 366      20544F3A 
 367 00e6 0000     		.align	2
 368              	.LC17:
 369 00e8 4D494E20 		.ascii	"MIN FORCE IS SET TO: %d\015\012\000"
 369      464F5243 
 369      45204953 
 369      20534554 
 369      20544F3A 
 370 0102 0000     		.align	2
 371              	.LC18:
 372 0104 43555252 		.ascii	"CURRENT FORCE IS SET TO: %d\015\012\000"
 372      454E5420 
 372      464F5243 
 372      45204953 
 372      20534554 
 373 0122 0000     		.align	2
 374              	.LC19:
 375 0124 44494147 		.ascii	"DIAGMIN\000"
 375      4D494E00 
 376              		.align	2
 377              	.LC20:
 378 012c 4D494E49 		.ascii	"MINIMUM DIAG FORCE IS SET TO: %d\015\012\000"
 378      4D554D20 
 378      44494147 
 378      20464F52 
 378      43452049 
 379 014f 00       		.align	2
 380              	.LC21:
 381 0150 44494147 		.ascii	"DIAGLOCK\000"
 381      4C4F434B 
 381      00
 382 0159 000000   		.align	2
 383              	.LC22:
 384 015c 4C4F434B 		.ascii	"LOCK DIAG FORCE IS SET TO: %d\015\012\000"
 384      20444941 
 384      4720464F 
 384      52434520 
 384      49532053 
 385              		.align	2
 386              	.LC23:
 387 017c 50524553 		.ascii	"PRESSURE\000"
 387      53555245 
 387      00
 388 0185 000000   		.align	2
 389              	.LC24:
 390 0188 5345544C 		.ascii	"SETLOCK\000"
 390      4F434B00 
 391              		.align	2
 392              	.LC25:
 393 0190 4C4F434B 		.ascii	"LOCK PRESSURE IS SET TO: %d\015\012\000"
 393      20505245 
 393      53535552 
 393      45204953 
 393      20534554 
 394 01ae 0000     		.align	2
 395              	.LC26:
 396 01b0 53455454 		.ascii	"SETTINGS\000"
 396      494E4753 
 396      00
 397 01b9 000000   		.align	2
 398              	.LC27:
 399 01bc 47455400 		.ascii	"GET\000"
 400              		.align	2
 401              	.LC28:
 402 01c0 53455454 		.ascii	"SETTINGS: %-80s\015\012\000"
 402      494E4753 
 402      3A20252D 
 402      3830730D 
 402      0A00
 403 01d2 0000     		.align	2
 404              	.LC29:
 405 01d4 504F5349 		.ascii	"POSITION#MIN#%d~POSITION#MAX#%d~POSITION#SET#%d~FOR"
 405      54494F4E 
 405      234D494E 
 405      2325647E 
 405      504F5349 
 406 0207 4345234D 		.ascii	"CE#MIN#%d~FORCE#MAX#%d~FORCE#SET#%d\000"
 406      494E2325 
 406      647E464F 
 406      52434523 
 406      4D415823 
 407 022b 00       		.align	2
 408              	.LC30:
 409 022c 0D0A5772 		.ascii	"\015\012Wrote %d bytes to flash at address 0x%08X.\015"
 409      6F746520 
 409      25642062 
 409      79746573 
 409      20746F20 
 410 0259 0A00     		.ascii	"\012\000"
 411 025b 00       		.align	2
 412              	.LC31:
 413 025c 52454144 		.ascii	"READINGS\000"
 413      494E4753 
 413      00
 414 0265 000000   		.align	2
 415              	.LC32:
 416 0268 54524143 		.ascii	"TRACE\000"
 416      4500
 417 026e 0000     		.align	2
 418              	.LC33:
 419 0270 52454144 		.ascii	"READINGS STARTED\015\012\000"
 419      494E4753 
 419      20535441 
 419      52544544 
 419      0D0A00
 420 0283 00       		.align	2
 421              	.LC34:
 422 0284 44415441 		.ascii	"DATA\000"
 422      00
 423 0289 000000   		.align	2
 424              	.LC35:
 425 028c 52454144 		.ascii	"READINGS STOPPED\015\012\000"
 425      494E4753 
 425      2053544F 
 425      50504544 
 425      0D0A00
 426 029f 00       		.align	2
 427              	.LC36:
 428 02a0 56414C55 		.ascii	"VALUES\000"
 428      455300
 429 02a7 00       		.align	2
 430              	.LC37:
 431 02a8 4C454400 		.ascii	"LED\000"
 432              		.align	2
 433              	.LC38:
 434 02ac 52454400 		.ascii	"RED\000"
 435              		.align	2
 436              	.LC39:
 437 02b0 4F4E00   		.ascii	"ON\000"
 438 02b3 00       		.align	2
 439              	.LC40:
 440 02b4 4F464600 		.ascii	"OFF\000"
 441              		.align	2
 442              	.LC41:
 443 02b8 59454C4C 		.ascii	"YELLOW\000"
 443      4F5700
 444 02bf 00       		.align	2
 445              	.LC42:
 446 02c0 47524545 		.ascii	"GREEN\000"
 446      4E00
 447 02c6 0000     		.align	2
 448              	.LC43:
 449 02c8 414C4C4F 		.ascii	"ALLOFF\000"
 449      464600
 450 02cf 00       		.align	2
 451              	.LC0:
 452 02d0 2300     		.ascii	"#\000"
 453              		.text
 454              		.align	2
 455              		.global	parseSettings
 457              	parseSettings:
 458              	.LFB299:
 235:main.c        ****     }
 236:main.c        **** }
 237:main.c        **** 
 238:main.c        **** void parseSettings(char data[MSG_SIZE])
 239:main.c        **** {
 459              		.loc 1 239 0
 460              		@ args = 0, pretend = 0, frame = 4
 461              		@ frame_needed = 0, uses_anonymous_args = 0
 462              	.LVL9:
 463 0150 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 464              	.LCFI5:
 240:main.c        ****     int i;
 241:main.c        ****     int  settings_size;
 242:main.c        **** 
 243:main.c        ****     char cmdDelim[] = "#";
 465              		.loc 1 243 0
 466 0154 F8379FE5 		ldr	r3, .L105
 467              		.loc 1 239 0
 468 0158 14D04DE2 		sub	sp, sp, #20
 469              	.LCFI6:
 470              		.loc 1 243 0
 471 015c B030D3E1 		ldrh	r3, [r3, #0]
 472 0160 14408DE2 		add	r4, sp, #20
 473 0164 B23064E1 		strh	r3, [r4, #-2]!	@ movhi
 244:main.c        ****     char *cmdParts = NULL;
 245:main.c        **** 
 246:main.c        ****     cmdParts = strtok( data, cmdDelim );
 474              		.loc 1 246 0
 475 0168 0410A0E1 		mov	r1, r4
 476 016c FEFFFFEB 		bl	strtok
 477              	.LVL10:
 247:main.c        **** 
 248:main.c        ****     if (strcmp(cmdParts, "TEST") == 0)
 478              		.loc 1 248 0
 479 0170 E0179FE5 		ldr	r1, .L105+4
 480              		.loc 1 246 0
 481 0174 0060A0E1 		mov	r6, r0
 482              	.LVL11:
 483              		.loc 1 248 0
 484 0178 FEFFFFEB 		bl	strcmp
 485 017c 000050E3 		cmp	r0, #0
 486 0180 6D00001A 		bne	.L26
 249:main.c        ****     {
 250:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 487              		.loc 1 250 0
 488 0184 0410A0E1 		mov	r1, r4
 489 0188 FEFFFFEB 		bl	strtok
 251:main.c        ****         if (strcmp(cmdParts, "TEST") == 0)
 490              		.loc 1 251 0
 491 018c C4179FE5 		ldr	r1, .L105+4
 492              		.loc 1 250 0
 493 0190 0060A0E1 		mov	r6, r0
 494              		.loc 1 251 0
 495 0194 FEFFFFEB 		bl	strcmp
 496 0198 004050E2 		subs	r4, r0, #0
 497 019c 6D00001A 		bne	.L26
 252:main.c        ****         {
 253:main.c        ****             //INITIAL TEST
 254:main.c        ****             printTrace("INITIAL TEST\r\n");
 498              		.loc 1 254 0
 499 01a0 B4079FE5 		ldr	r0, .L105+8
 500 01a4 FEFFFFEB 		bl	printTrace
 501              	.L29:
 502              	.LVL12:
 255:main.c        ****             for (i = 0; i < 15; i++)
 503              		.loc 1 255 0
 504 01a8 014084E2 		add	r4, r4, #1
 256:main.c        ****             {
 257:main.c        ****                 startBlinking(50000);
 505              		.loc 1 257 0
 506 01ac AC079FE5 		ldr	r0, .L105+12
 507 01b0 FEFFFFEB 		bl	startBlinking
 508              		.loc 1 255 0
 509 01b4 0F0054E3 		cmp	r4, #15
 510 01b8 6800001A 		bne	.L29
 511              	.L26:
 258:main.c        ****             }
 259:main.c        ****         }
 260:main.c        ****     }
 261:main.c        ****     //AAT process
 262:main.c        ****     if (strcmp(cmdParts, "DIAG") == 0)
 512              		.loc 1 262 0
 513 01bc 0600A0E1 		mov	r0, r6
 514 01c0 9C179FE5 		ldr	r1, .L105+16
 515 01c4 FEFFFFEB 		bl	strcmp
 516 01c8 000050E3 		cmp	r0, #0
 517 01cc 9400001A 		bne	.L30
 263:main.c        ****     {
 264:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 518              		.loc 1 264 0
 519 01d0 12108DE2 		add	r1, sp, #18
 520 01d4 FEFFFFEB 		bl	strtok
 265:main.c        ****         if (strcmp(cmdParts, "START") == 0)
 521              		.loc 1 265 0
 522 01d8 88179FE5 		ldr	r1, .L105+20
 523              		.loc 1 264 0
 524 01dc 0060A0E1 		mov	r6, r0
 525              		.loc 1 265 0
 526 01e0 FEFFFFEB 		bl	strcmp
 527 01e4 000050E3 		cmp	r0, #0
 266:main.c        ****         {
 267:main.c        ****             aatDiag = 1;
 528              		.loc 1 267 0
 529 01e8 7C279F05 		ldreq	r2, .L105+24
 530 01ec 0130A003 		moveq	r3, #1
 531 01f0 0030C205 		streqb	r3, [r2, #0]
 268:main.c        ****             aatDiagStep = 0;
 532              		.loc 1 268 0
 533 01f4 74379F05 		ldreq	r3, .L105+28
 269:main.c        ****         }
 270:main.c        ****         if (strcmp(cmdParts, "STOP") == 0)
 534              		.loc 1 270 0
 535 01f8 74179FE5 		ldr	r1, .L105+32
 536              		.loc 1 268 0
 537 01fc 0000C305 		streqb	r0, [r3, #0]
 538              		.loc 1 270 0
 539 0200 0600A0E1 		mov	r0, r6
 540 0204 FEFFFFEB 		bl	strcmp
 541 0208 000050E3 		cmp	r0, #0
 271:main.c        ****         {
 272:main.c        ****             aatDiag = 0;
 542              		.loc 1 272 0
 543 020c 58379F05 		ldreq	r3, .L105+24
 273:main.c        ****         }
 274:main.c        ****         if (strcmp(cmdParts, "STEP4") == 0)
 544              		.loc 1 274 0
 545 0210 60179FE5 		ldr	r1, .L105+36
 546              		.loc 1 272 0
 547 0214 0000C305 		streqb	r0, [r3, #0]
 548              		.loc 1 274 0
 549 0218 0600A0E1 		mov	r0, r6
 550 021c FEFFFFEB 		bl	strcmp
 551 0220 000050E3 		cmp	r0, #0
 552 0224 9400001A 		bne	.L30
 275:main.c        ****         {
 276:main.c        ****             printTrace("DIAG#3#DONE\r\n");
 553              		.loc 1 276 0
 554 0228 4C079FE5 		ldr	r0, .L105+40
 555 022c FEFFFFEB 		bl	printTrace
 277:main.c        ****             AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED3);
 278:main.c        ****             aatDiagStep = 4;
 279:main.c        ****             diagForce = maxForce;
 556              		.loc 1 279 0
 557 0230 48379FE5 		ldr	r3, .L105+44
 558              	.LBB103:
 559              	.LBB104:
 560              		.loc 2 609 0
 561 0234 2020A0E3 		mov	r2, #32
 562              	.LBE104:
 563              	.LBE103:
 564              		.loc 1 279 0
 565 0238 001093E5 		ldr	r1, [r3, #0]
 566              	.LBB105:
 567              	.LBB106:
 568              		.loc 2 609 0
 569 023c 0B3CE0E3 		mvn	r3, #2816
 570 0240 CF2003E5 		str	r2, [r3, #-207]
 571              	.LBE106:
 572              	.LBE105:
 573              		.loc 1 278 0
 574 0244 24379FE5 		ldr	r3, .L105+28
 575 0248 0420A0E3 		mov	r2, #4
 576 024c 0020C3E5 		strb	r2, [r3, #0]
 577              		.loc 1 279 0
 578 0250 2C379FE5 		ldr	r3, .L105+48
 579 0254 001083E5 		str	r1, [r3, #0]
 580              	.L30:
 280:main.c        ****         }
 281:main.c        ****     }
 282:main.c        ****     if (strcmp(cmdParts, "POSITION") == 0)
 581              		.loc 1 282 0
 582 0258 0600A0E1 		mov	r0, r6
 583 025c 24179FE5 		ldr	r1, .L105+52
 584 0260 FEFFFFEB 		bl	strcmp
 585 0264 000050E3 		cmp	r0, #0
 586 0268 CF00001A 		bne	.L37
 283:main.c        ****     {
 284:main.c        ****         // POSITION SETTING
 285:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 587              		.loc 1 285 0
 588 026c 12408DE2 		add	r4, sp, #18
 589              	.LVL13:
 590 0270 0410A0E1 		mov	r1, r4
 591 0274 FEFFFFEB 		bl	strtok
 286:main.c        ****         if (strcmp(cmdParts, "MAX") == 0)
 592              		.loc 1 286 0
 593 0278 0C179FE5 		ldr	r1, .L105+56
 594              		.loc 1 285 0
 595 027c 0060A0E1 		mov	r6, r0
 596              		.loc 1 286 0
 597 0280 FEFFFFEB 		bl	strcmp
 598 0284 000050E3 		cmp	r0, #0
 599 0288 AD00001A 		bne	.L39
 287:main.c        ****         {
 288:main.c        ****             //MAX POSITION
 289:main.c        ****             maxPos = atoi(strtok( NULL, cmdDelim ));
 600              		.loc 1 289 0
 601 028c 0410A0E1 		mov	r1, r4
 602 0290 FEFFFFEB 		bl	strtok
 603 0294 FEFFFFEB 		bl	atoi
 604 0298 F0369FE5 		ldr	r3, .L105+60
 605 029c 00C0A0E1 		mov	ip, r0
 290:main.c        ****             sprintf((char *)msg,"MAX POSITION IS SET TO: %d\r\n", maxPos);
 606              		.loc 1 290 0
 607 02a0 0020A0E1 		mov	r2, r0
 608 02a4 E8169FE5 		ldr	r1, .L105+64
 609 02a8 E8069FE5 		ldr	r0, .L105+68
 610              		.loc 1 289 0
 611 02ac 00C083E5 		str	ip, [r3, #0]
 612              		.loc 1 290 0
 613 02b0 FEFFFFEB 		bl	sprintf
 291:main.c        ****             printTrace(msg);
 614              		.loc 1 291 0
 615 02b4 DC069FE5 		ldr	r0, .L105+68
 616 02b8 FEFFFFEB 		bl	printTrace
 617              	.L39:
 292:main.c        ****         }
 293:main.c        ****         if (strcmp(cmdParts, "MIN") == 0)
 618              		.loc 1 293 0
 619 02bc 0600A0E1 		mov	r0, r6
 620 02c0 D4169FE5 		ldr	r1, .L105+72
 621 02c4 FEFFFFEB 		bl	strcmp
 622 02c8 000050E3 		cmp	r0, #0
 623 02cc BE00001A 		bne	.L41
 294:main.c        ****         {
 295:main.c        ****             //MIN POSITION
 296:main.c        ****             minPos = atoi(strtok( NULL, cmdDelim ));
 624              		.loc 1 296 0
 625 02d0 0410A0E1 		mov	r1, r4
 626 02d4 FEFFFFEB 		bl	strtok
 627 02d8 FEFFFFEB 		bl	atoi
 628 02dc BC369FE5 		ldr	r3, .L105+76
 629 02e0 00C0A0E1 		mov	ip, r0
 297:main.c        ****             sprintf((char *)msg,"MIN POSITION IS SET TO: %d\r\n", minPos);
 630              		.loc 1 297 0
 631 02e4 0020A0E1 		mov	r2, r0
 632 02e8 B4169FE5 		ldr	r1, .L105+80
 633 02ec A4069FE5 		ldr	r0, .L105+68
 634              		.loc 1 296 0
 635 02f0 00C083E5 		str	ip, [r3, #0]
 636              		.loc 1 297 0
 637 02f4 FEFFFFEB 		bl	sprintf
 298:main.c        ****             printTrace(msg);
 638              		.loc 1 298 0
 639 02f8 98069FE5 		ldr	r0, .L105+68
 640 02fc FEFFFFEB 		bl	printTrace
 641              	.L41:
 299:main.c        ****         }
 300:main.c        ****         if (strcmp(cmdParts, "SET") == 0)
 642              		.loc 1 300 0
 643 0300 0600A0E1 		mov	r0, r6
 644 0304 9C169FE5 		ldr	r1, .L105+84
 645 0308 FEFFFFEB 		bl	strcmp
 646 030c 000050E3 		cmp	r0, #0
 647 0310 CF00001A 		bne	.L37
 301:main.c        ****         {
 302:main.c        ****             //CUR POSITION
 303:main.c        ****             curPos = atoi(strtok( NULL, cmdDelim ));
 648              		.loc 1 303 0
 649 0314 0410A0E1 		mov	r1, r4
 650 0318 FEFFFFEB 		bl	strtok
 651 031c FEFFFFEB 		bl	atoi
 652 0320 84369FE5 		ldr	r3, .L105+88
 653 0324 00C0A0E1 		mov	ip, r0
 304:main.c        ****             sprintf((char *)msg,"CURRENT POSITION IS SET TO: %d\r\n", curPos);
 654              		.loc 1 304 0
 655 0328 0020A0E1 		mov	r2, r0
 656 032c 7C169FE5 		ldr	r1, .L105+92
 657 0330 60069FE5 		ldr	r0, .L105+68
 658              		.loc 1 303 0
 659 0334 00C083E5 		str	ip, [r3, #0]
 660              		.loc 1 304 0
 661 0338 FEFFFFEB 		bl	sprintf
 305:main.c        ****             printTrace(msg);
 662              		.loc 1 305 0
 663 033c 54069FE5 		ldr	r0, .L105+68
 664 0340 FEFFFFEB 		bl	printTrace
 665              	.LVL14:
 666              	.L37:
 306:main.c        ****         }
 307:main.c        ****     }
 308:main.c        ****     if (strcmp(cmdParts, "FORCE") == 0)
 667              		.loc 1 308 0
 668 0344 0600A0E1 		mov	r0, r6
 669 0348 64169FE5 		ldr	r1, .L105+96
 670 034c FEFFFFEB 		bl	strcmp
 671 0350 000050E3 		cmp	r0, #0
 672 0354 2C01001A 		bne	.L44
 309:main.c        ****     {
 310:main.c        ****         // FORCE SETTING
 311:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 673              		.loc 1 311 0
 674 0358 12408DE2 		add	r4, sp, #18
 675              	.LVL15:
 676 035c 0410A0E1 		mov	r1, r4
 677 0360 FEFFFFEB 		bl	strtok
 312:main.c        ****         if (strcmp(cmdParts, "MAX") == 0)
 678              		.loc 1 312 0
 679 0364 20169FE5 		ldr	r1, .L105+56
 680              		.loc 1 311 0
 681 0368 0060A0E1 		mov	r6, r0
 682              		.loc 1 312 0
 683 036c FEFFFFEB 		bl	strcmp
 684 0370 000050E3 		cmp	r0, #0
 685 0374 E800001A 		bne	.L46
 313:main.c        ****         {
 314:main.c        ****             //MAX FORCE
 315:main.c        ****             maxForce = atoi(strtok( NULL, cmdDelim ));
 686              		.loc 1 315 0
 687 0378 0410A0E1 		mov	r1, r4
 688 037c FEFFFFEB 		bl	strtok
 689 0380 FEFFFFEB 		bl	atoi
 690 0384 F4359FE5 		ldr	r3, .L105+44
 691 0388 00C0A0E1 		mov	ip, r0
 316:main.c        ****             sprintf((char *)msg,"MAX FORCE IS SET TO: %d\r\n", maxForce);
 692              		.loc 1 316 0
 693 038c 0020A0E1 		mov	r2, r0
 694 0390 20169FE5 		ldr	r1, .L105+100
 695 0394 FC059FE5 		ldr	r0, .L105+68
 696              		.loc 1 315 0
 697 0398 00C083E5 		str	ip, [r3, #0]
 698              		.loc 1 316 0
 699 039c FEFFFFEB 		bl	sprintf
 317:main.c        ****             printTrace(msg);
 700              		.loc 1 317 0
 701 03a0 F0059FE5 		ldr	r0, .L105+68
 702 03a4 FEFFFFEB 		bl	printTrace
 703              	.L46:
 318:main.c        ****         }
 319:main.c        ****         if (strcmp(cmdParts, "MIN") == 0)
 704              		.loc 1 319 0
 705 03a8 0600A0E1 		mov	r0, r6
 706 03ac E8159FE5 		ldr	r1, .L105+72
 707 03b0 FEFFFFEB 		bl	strcmp
 708 03b4 000050E3 		cmp	r0, #0
 709 03b8 F900001A 		bne	.L48
 320:main.c        ****         {
 321:main.c        ****             //MIN FORCE
 322:main.c        ****             minForce = atoi(strtok( NULL, cmdDelim ));
 710              		.loc 1 322 0
 711 03bc 0410A0E1 		mov	r1, r4
 712 03c0 FEFFFFEB 		bl	strtok
 713 03c4 FEFFFFEB 		bl	atoi
 714 03c8 EC359FE5 		ldr	r3, .L105+104
 715 03cc 00C0A0E1 		mov	ip, r0
 323:main.c        ****             sprintf((char *)msg,"MIN FORCE IS SET TO: %d\r\n", minForce);
 716              		.loc 1 323 0
 717 03d0 0020A0E1 		mov	r2, r0
 718 03d4 E4159FE5 		ldr	r1, .L105+108
 719 03d8 B8059FE5 		ldr	r0, .L105+68
 720              		.loc 1 322 0
 721 03dc 00C083E5 		str	ip, [r3, #0]
 722              		.loc 1 323 0
 723 03e0 FEFFFFEB 		bl	sprintf
 324:main.c        ****             printTrace(msg);
 724              		.loc 1 324 0
 725 03e4 AC059FE5 		ldr	r0, .L105+68
 726 03e8 FEFFFFEB 		bl	printTrace
 727              	.L48:
 325:main.c        ****         }
 326:main.c        ****         if (strcmp(cmdParts, "SET") == 0)
 728              		.loc 1 326 0
 729 03ec 0600A0E1 		mov	r0, r6
 730 03f0 B0159FE5 		ldr	r1, .L105+84
 731 03f4 FEFFFFEB 		bl	strcmp
 732 03f8 000050E3 		cmp	r0, #0
 733 03fc 0A01001A 		bne	.L50
 327:main.c        ****         {
 328:main.c        ****             //CUR FORCE
 329:main.c        ****             curForce = atoi(strtok( NULL, cmdDelim ));
 734              		.loc 1 329 0
 735 0400 0410A0E1 		mov	r1, r4
 736 0404 FEFFFFEB 		bl	strtok
 737 0408 FEFFFFEB 		bl	atoi
 738 040c B0359FE5 		ldr	r3, .L105+112
 739 0410 00C0A0E1 		mov	ip, r0
 330:main.c        ****             sprintf((char *)msg,"CURRENT FORCE IS SET TO: %d\r\n", curForce);
 740              		.loc 1 330 0
 741 0414 0020A0E1 		mov	r2, r0
 742 0418 A8159FE5 		ldr	r1, .L105+116
 743 041c 74059FE5 		ldr	r0, .L105+68
 744              		.loc 1 329 0
 745 0420 00C083E5 		str	ip, [r3, #0]
 746              		.loc 1 330 0
 747 0424 FEFFFFEB 		bl	sprintf
 331:main.c        ****             printTrace(msg);
 748              		.loc 1 331 0
 749 0428 68059FE5 		ldr	r0, .L105+68
 750 042c FEFFFFEB 		bl	printTrace
 751              	.L50:
 332:main.c        ****         }
 333:main.c        ****         //AAT process
 334:main.c        ****         if (strcmp(cmdParts, "DIAGMIN") == 0)
 752              		.loc 1 334 0
 753 0430 0600A0E1 		mov	r0, r6
 754 0434 90159FE5 		ldr	r1, .L105+120
 755 0438 FEFFFFEB 		bl	strcmp
 756 043c 000050E3 		cmp	r0, #0
 757 0440 1B01001A 		bne	.L52
 335:main.c        ****         {
 336:main.c        ****             //CUR FORCE
 337:main.c        ****             minDiagForce = atoi(strtok( NULL, cmdDelim ));
 758              		.loc 1 337 0
 759 0444 0410A0E1 		mov	r1, r4
 760 0448 FEFFFFEB 		bl	strtok
 761 044c FEFFFFEB 		bl	atoi
 762 0450 78359FE5 		ldr	r3, .L105+124
 763 0454 00C0A0E1 		mov	ip, r0
 338:main.c        ****             sprintf((char *)msg,"MINIMUM DIAG FORCE IS SET TO: %d\r\n", minDiagForce);
 764              		.loc 1 338 0
 765 0458 0020A0E1 		mov	r2, r0
 766 045c 70159FE5 		ldr	r1, .L105+128
 767 0460 30059FE5 		ldr	r0, .L105+68
 768              		.loc 1 337 0
 769 0464 00C083E5 		str	ip, [r3, #0]
 770              		.loc 1 338 0
 771 0468 FEFFFFEB 		bl	sprintf
 339:main.c        ****             printTrace(msg);
 772              		.loc 1 339 0
 773 046c 24059FE5 		ldr	r0, .L105+68
 774 0470 FEFFFFEB 		bl	printTrace
 775              	.L52:
 340:main.c        ****         }
 341:main.c        ****         if (strcmp(cmdParts, "DIAGLOCK") == 0)
 776              		.loc 1 341 0
 777 0474 0600A0E1 		mov	r0, r6
 778 0478 58159FE5 		ldr	r1, .L105+132
 779 047c FEFFFFEB 		bl	strcmp
 780 0480 000050E3 		cmp	r0, #0
 781 0484 2C01001A 		bne	.L44
 342:main.c        ****         {
 343:main.c        ****             //CUR FORCE
 344:main.c        ****             lockDiagForce = atoi(strtok( NULL, cmdDelim ));
 782              		.loc 1 344 0
 783 0488 0410A0E1 		mov	r1, r4
 784 048c FEFFFFEB 		bl	strtok
 785 0490 FEFFFFEB 		bl	atoi
 786 0494 40359FE5 		ldr	r3, .L105+136
 787 0498 00C0A0E1 		mov	ip, r0
 345:main.c        ****             sprintf((char *)msg,"LOCK DIAG FORCE IS SET TO: %d\r\n", lockDiagForce);
 788              		.loc 1 345 0
 789 049c 0020A0E1 		mov	r2, r0
 790 04a0 38159FE5 		ldr	r1, .L105+140
 791 04a4 EC049FE5 		ldr	r0, .L105+68
 792              		.loc 1 344 0
 793 04a8 00C083E5 		str	ip, [r3, #0]
 794              		.loc 1 345 0
 795 04ac FEFFFFEB 		bl	sprintf
 346:main.c        ****             printTrace(msg);
 796              		.loc 1 346 0
 797 04b0 E0049FE5 		ldr	r0, .L105+68
 798 04b4 FEFFFFEB 		bl	printTrace
 799              	.LVL16:
 800              	.L44:
 347:main.c        ****         }
 348:main.c        ****     }
 349:main.c        ****     //AAT setting
 350:main.c        ****     if (strcmp(cmdParts, "PRESSURE") == 0)
 801              		.loc 1 350 0
 802 04b8 0600A0E1 		mov	r0, r6
 803 04bc 20159FE5 		ldr	r1, .L105+144
 804 04c0 FEFFFFEB 		bl	strcmp
 805 04c4 000050E3 		cmp	r0, #0
 806 04c8 4201001A 		bne	.L55
 351:main.c        ****     {
 352:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 807              		.loc 1 352 0
 808 04cc 12108DE2 		add	r1, sp, #18
 809 04d0 FEFFFFEB 		bl	strtok
 353:main.c        ****         if (strcmp(cmdParts, "SETLOCK") == 0)
 810              		.loc 1 353 0
 811 04d4 0C159FE5 		ldr	r1, .L105+148
 812              		.loc 1 352 0
 813 04d8 0060A0E1 		mov	r6, r0
 814              		.loc 1 353 0
 815 04dc FEFFFFEB 		bl	strcmp
 816 04e0 000050E3 		cmp	r0, #0
 817 04e4 4201001A 		bne	.L55
 354:main.c        ****         {
 355:main.c        ****             //LOCK PRESSURE
 356:main.c        ****             lockDiagPressure = pressure;
 818              		.loc 1 356 0
 819 04e8 FC349FE5 		ldr	r3, .L105+152
 820 04ec 00C093E5 		ldr	ip, [r3, #0]
 821 04f0 F8349FE5 		ldr	r3, .L105+156
 357:main.c        ****             sprintf((char *)msg,"LOCK PRESSURE IS SET TO: %d\r\n", lockDiagPressure);
 822              		.loc 1 357 0
 823 04f4 0C20A0E1 		mov	r2, ip
 824 04f8 98049FE5 		ldr	r0, .L105+68
 825 04fc F0149FE5 		ldr	r1, .L105+160
 826              		.loc 1 356 0
 827 0500 00C083E5 		str	ip, [r3, #0]
 828              		.loc 1 357 0
 829 0504 FEFFFFEB 		bl	sprintf
 358:main.c        ****             printTrace(msg);
 830              		.loc 1 358 0
 831 0508 88049FE5 		ldr	r0, .L105+68
 832 050c FEFFFFEB 		bl	printTrace
 833              	.L55:
 359:main.c        ****         }
 360:main.c        ****     }
 361:main.c        ****     if (strcmp(cmdParts, "SETTINGS") == 0)
 834              		.loc 1 361 0
 835 0510 0600A0E1 		mov	r0, r6
 836 0514 DC149FE5 		ldr	r1, .L105+164
 837 0518 FEFFFFEB 		bl	strcmp
 838 051c 000050E3 		cmp	r0, #0
 839 0520 8501001A 		bne	.L58
 362:main.c        ****     {
 363:main.c        ****         //SETTINGS
 364:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 840              		.loc 1 364 0
 841 0524 12108DE2 		add	r1, sp, #18
 842 0528 FEFFFFEB 		bl	strtok
 365:main.c        ****         if (strcmp(cmdParts, "GET") == 0)
 843              		.loc 1 365 0
 844 052c C8149FE5 		ldr	r1, .L105+168
 845              		.loc 1 364 0
 846 0530 0060A0E1 		mov	r6, r0
 847              		.loc 1 365 0
 848 0534 FEFFFFEB 		bl	strcmp
 849 0538 000050E3 		cmp	r0, #0
 850 053c 5401001A 		bne	.L60
 366:main.c        ****         {
 367:main.c        ****             sprintf((char *)msg,"SETTINGS: %-80s\r\n", OUR_FLASH_ADDR);
 851              		.loc 1 367 0
 852 0540 50049FE5 		ldr	r0, .L105+68
 853 0544 B4149FE5 		ldr	r1, .L105+172
 854 0548 B4249FE5 		ldr	r2, .L105+176
 855 054c FEFFFFEB 		bl	sprintf
 368:main.c        ****             printTrace(msg);
 856              		.loc 1 368 0
 857 0550 40049FE5 		ldr	r0, .L105+68
 858 0554 FEFFFFEB 		bl	printTrace
 859              	.L60:
 369:main.c        ****         }
 370:main.c        ****         if (strcmp(cmdParts, "SET") == 0)
 860              		.loc 1 370 0
 861 0558 0600A0E1 		mov	r0, r6
 862 055c 44149FE5 		ldr	r1, .L105+84
 863 0560 FEFFFFEB 		bl	strcmp
 864 0564 000050E3 		cmp	r0, #0
 865 0568 8501001A 		bne	.L58
 866 056c 94249FE5 		ldr	r2, .L105+180
 867              	.L63:
 868              	.LBB107:
 371:main.c        ****         {
 372:main.c        ****             for(int r = 0; r < 128; r++)
 373:main.c        ****             {
 374:main.c        ****                 settings[r] = '\0';
 869              		.loc 1 374 0
 870 0570 0030A0E3 		mov	r3, #0
 871 0574 0130C2E4 		strb	r3, [r2], #1
 872              		.loc 1 372 0
 873 0578 8C349FE5 		ldr	r3, .L105+184
 874 057c 030052E1 		cmp	r2, r3
 875 0580 5A01001A 		bne	.L63
 876              	.LBE107:
 375:main.c        ****             }
 376:main.c        ****             sprintf((char *)settings,"POSITION#MIN#%d~POSITION#MAX#%d~POSITION#SET#%d~FORCE#MIN#%d~
 877              		.loc 1 376 0
 878 0584 20349FE5 		ldr	r3, .L105+88
 879 0588 005093E5 		ldr	r5, [r3, #0]
 880 058c 28349FE5 		ldr	r3, .L105+104
 881 0590 004093E5 		ldr	r4, [r3, #0]
 882              	.LVL17:
 883 0594 E4339FE5 		ldr	r3, .L105+44
 884 0598 00E093E5 		ldr	lr, [r3, #0]
 885 059c 20349FE5 		ldr	r3, .L105+112
 886 05a0 F8239FE5 		ldr	r2, .L105+76
 887 05a4 00C093E5 		ldr	ip, [r3, #0]
 888 05a8 E0339FE5 		ldr	r3, .L105+60
 889 05ac 002092E5 		ldr	r2, [r2, #0]
 890 05b0 003093E5 		ldr	r3, [r3, #0]
 891 05b4 54149FE5 		ldr	r1, .L105+188
 892 05b8 48049FE5 		ldr	r0, .L105+180
 893 05bc 08E08DE5 		str	lr, [sp, #8]
 894 05c0 0CC08DE5 		str	ip, [sp, #12]
 895 05c4 04408DE5 		str	r4, [sp, #4]
 896 05c8 00508DE5 		str	r5, [sp, #0]
 897 05cc FEFFFFEB 		bl	sprintf
 377:main.c        ****             settings_size = strlen(settings) + 1;
 898              		.loc 1 377 0
 899 05d0 30049FE5 		ldr	r0, .L105+180
 900 05d4 FEFFFFEB 		bl	strlen
 378:main.c        ****             flashWrite(OUR_FLASH_ADDR, settings, settings_size);
 901              		.loc 1 378 0
 902 05d8 28149FE5 		ldr	r1, .L105+180
 903 05dc 012080E2 		add	r2, r0, #1
 904              	.LVL18:
 905 05e0 2C349FE5 		ldr	r3, .L105+192
 906              		.loc 1 377 0
 907 05e4 0040A0E1 		mov	r4, r0
 908              		.loc 1 378 0
 909 05e8 14049FE5 		ldr	r0, .L105+176
 910 05ec 0FE0A0E1 		mov	lr, pc
 911 05f0 13FF2FE1 		bx	r3
 912              	.LVL19:
 379:main.c        ****             printTrace(settings);
 380:main.c        ****             sprintf((char *)msg,"\r\nWrote %d bytes to flash at address 0x%08X.\r\n", (3 + settings
 913              		.loc 1 380 0
 914 05f4 044084E2 		add	r4, r4, #4
 915              		.loc 1 379 0
 916 05f8 08049FE5 		ldr	r0, .L105+180
 917 05fc FEFFFFEB 		bl	printTrace
 918              		.loc 1 380 0
 919 0600 0320C4E3 		bic	r2, r4, #3
 920 0604 8C039FE5 		ldr	r0, .L105+68
 921 0608 08149FE5 		ldr	r1, .L105+196
 922 060c F0339FE5 		ldr	r3, .L105+176
 923 0610 FEFFFFEB 		bl	sprintf
 381:main.c        ****             printTrace(msg);
 924              		.loc 1 381 0
 925 0614 7C039FE5 		ldr	r0, .L105+68
 926 0618 FEFFFFEB 		bl	printTrace
 927              	.LVL20:
 928              	.L58:
 382:main.c        ****         }
 383:main.c        ****     }
 384:main.c        ****     if (strcmp(cmdParts, "READINGS") == 0)
 929              		.loc 1 384 0
 930 061c 0600A0E1 		mov	r0, r6
 931 0620 F4139FE5 		ldr	r1, .L105+200
 932 0624 FEFFFFEB 		bl	strcmp
 933 0628 000050E3 		cmp	r0, #0
 934 062c BA01001A 		bne	.L65
 385:main.c        ****     {
 386:main.c        ****         // READINGS
 387:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 935              		.loc 1 387 0
 936 0630 12408DE2 		add	r4, sp, #18
 937              	.LVL21:
 938 0634 0410A0E1 		mov	r1, r4
 939 0638 FEFFFFEB 		bl	strtok
 388:main.c        ****         if (strcmp(cmdParts, "START") == 0)
 940              		.loc 1 388 0
 941 063c 24139FE5 		ldr	r1, .L105+20
 942              		.loc 1 387 0
 943 0640 0060A0E1 		mov	r6, r0
 944              		.loc 1 388 0
 945 0644 FEFFFFEB 		bl	strcmp
 946 0648 000050E3 		cmp	r0, #0
 947 064c AC01001A 		bne	.L67
 389:main.c        ****         {
 390:main.c        ****             //START
 391:main.c        ****             cmdParts = strtok( NULL, cmdDelim );
 948              		.loc 1 391 0
 949 0650 0410A0E1 		mov	r1, r4
 950 0654 FEFFFFEB 		bl	strtok
 392:main.c        ****             if (strcmp(cmdParts, "TRACE") == 0)
 951              		.loc 1 392 0
 952 0658 C0139FE5 		ldr	r1, .L105+204
 953              		.loc 1 391 0
 954 065c 0060A0E1 		mov	r6, r0
 955              		.loc 1 392 0
 956 0660 FEFFFFEB 		bl	strcmp
 957 0664 004050E2 		subs	r4, r0, #0
 958 0668 A201001A 		bne	.L69
 393:main.c        ****             {
 394:main.c        ****                 sprintf((char *)msg,"READINGS STARTED\r\n", maxPos);
 959              		.loc 1 394 0
 960 066c 1C339FE5 		ldr	r3, .L105+60
 961 0670 AC139FE5 		ldr	r1, .L105+208
 962 0674 002093E5 		ldr	r2, [r3, #0]
 963 0678 18039FE5 		ldr	r0, .L105+68
 964 067c FEFFFFEB 		bl	sprintf
 395:main.c        ****                 printTrace(msg);
 965              		.loc 1 395 0
 966 0680 10039FE5 		ldr	r0, .L105+68
 967 0684 FEFFFFEB 		bl	printTrace
 396:main.c        ****                 dataReading = 0;
 968              		.loc 1 396 0
 969 0688 98339FE5 		ldr	r3, .L105+212
 970 068c 0040C3E5 		strb	r4, [r3, #0]
 971              	.L69:
 397:main.c        ****             }
 398:main.c        ****             if (strcmp(cmdParts, "DATA") == 0)
 972              		.loc 1 398 0
 973 0690 0600A0E1 		mov	r0, r6
 974 0694 90139FE5 		ldr	r1, .L105+216
 975 0698 FEFFFFEB 		bl	strcmp
 976 069c 000050E3 		cmp	r0, #0
 399:main.c        ****             {
 400:main.c        ****                 dataReading = 1;
 977              		.loc 1 400 0
 978 06a0 80339F05 		ldreq	r3, .L105+212
 979 06a4 0120A003 		moveq	r2, #1
 980 06a8 0020C305 		streqb	r2, [r3, #0]
 401:main.c        ****             }
 402:main.c        ****             reading = 1;
 981              		.loc 1 402 0
 982 06ac 7C339FE5 		ldr	r3, .L105+220
 983 06b0 0120A0E3 		mov	r2, #1
 984 06b4 0020C3E5 		strb	r2, [r3, #0]
 985              	.L67:
 403:main.c        ****         }
 404:main.c        ****         if (strcmp(cmdParts, "STOP") == 0)
 986              		.loc 1 404 0
 987 06b8 0600A0E1 		mov	r0, r6
 988 06bc B0129FE5 		ldr	r1, .L105+32
 989 06c0 FEFFFFEB 		bl	strcmp
 990 06c4 004050E2 		subs	r4, r0, #0
 991 06c8 BA01001A 		bne	.L65
 405:main.c        ****         {
 406:main.c        ****             //STOP
 407:main.c        ****             sprintf((char *)msg,"READINGS STOPPED\r\n", minPos);
 992              		.loc 1 407 0
 993 06cc CC329FE5 		ldr	r3, .L105+76
 994 06d0 5C139FE5 		ldr	r1, .L105+224
 995 06d4 002093E5 		ldr	r2, [r3, #0]
 996 06d8 B8029FE5 		ldr	r0, .L105+68
 997 06dc FEFFFFEB 		bl	sprintf
 408:main.c        ****             printTrace(msg);
 998              		.loc 1 408 0
 999 06e0 B0029FE5 		ldr	r0, .L105+68
 1000 06e4 FEFFFFEB 		bl	printTrace
 409:main.c        ****             reading = 0;
 1001              		.loc 1 409 0
 1002 06e8 40339FE5 		ldr	r3, .L105+220
 1003 06ec 0040C3E5 		strb	r4, [r3, #0]
 1004              	.LVL22:
 1005              	.L65:
 410:main.c        ****         }
 411:main.c        ****     }
 412:main.c        ****     if (strcmp(cmdParts, "VALUES") == 0)
 1006              		.loc 1 412 0
 1007 06f0 0600A0E1 		mov	r0, r6
 1008 06f4 3C139FE5 		ldr	r1, .L105+228
 1009 06f8 FEFFFFEB 		bl	strcmp
 1010 06fc 000050E3 		cmp	r0, #0
 1011 0700 DA01001A 		bne	.L74
 413:main.c        ****     {
 414:main.c        ****         // GET CURRENT VALUES
 415:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 1012              		.loc 1 415 0
 1013 0704 12108DE2 		add	r1, sp, #18
 1014 0708 FEFFFFEB 		bl	strtok
 416:main.c        ****         if (strcmp(cmdParts, "GET") == 0)
 1015              		.loc 1 416 0
 1016 070c E8129FE5 		ldr	r1, .L105+168
 1017              		.loc 1 415 0
 1018 0710 0060A0E1 		mov	r6, r0
 1019              		.loc 1 416 0
 1020 0714 FEFFFFEB 		bl	strcmp
 1021 0718 000050E3 		cmp	r0, #0
 1022 071c DA01001A 		bne	.L74
 417:main.c        ****         {
 418:main.c        ****             sprintf((char *)msg,"POSITION#MIN#%d~POSITION#MAX#%d~POSITION#SET#%d~FORCE#MIN#%d~FORCE
 1023              		.loc 1 418 0
 1024 0720 84329FE5 		ldr	r3, .L105+88
 1025 0724 005093E5 		ldr	r5, [r3, #0]
 1026 0728 8C329FE5 		ldr	r3, .L105+104
 1027 072c 004093E5 		ldr	r4, [r3, #0]
 1028              	.LVL23:
 1029 0730 48329FE5 		ldr	r3, .L105+44
 1030 0734 00E093E5 		ldr	lr, [r3, #0]
 1031 0738 84329FE5 		ldr	r3, .L105+112
 1032 073c 00C093E5 		ldr	ip, [r3, #0]
 1033 0740 58329FE5 		ldr	r3, .L105+76
 1034 0744 002093E5 		ldr	r2, [r3, #0]
 1035 0748 40329FE5 		ldr	r3, .L105+60
 1036 074c 44029FE5 		ldr	r0, .L105+68
 1037 0750 003093E5 		ldr	r3, [r3, #0]
 1038 0754 B4129FE5 		ldr	r1, .L105+188
 1039 0758 00508DE5 		str	r5, [sp, #0]
 1040 075c 10408DE9 		stmib	sp, {r4, lr}	@ phole stm
 1041 0760 0CC08DE5 		str	ip, [sp, #12]
 1042 0764 FEFFFFEB 		bl	sprintf
 419:main.c        ****             printTrace(msg);
 1043              		.loc 1 419 0
 1044 0768 28029FE5 		ldr	r0, .L105+68
 1045 076c FEFFFFEB 		bl	printTrace
 1046              	.LVL24:
 1047              	.L74:
 420:main.c        ****         }
 421:main.c        ****     }
 422:main.c        ****     if (strcmp(cmdParts, "LED") == 0)
 1048              		.loc 1 422 0
 1049 0770 0600A0E1 		mov	r0, r6
 1050 0774 C0129FE5 		ldr	r1, .L105+232
 1051 0778 FEFFFFEB 		bl	strcmp
 1052 077c 000050E3 		cmp	r0, #0
 1053 0780 5102001A 		bne	.L101
 423:main.c        ****     {
 424:main.c        ****         // LEDs control
 425:main.c        ****         cmdParts = strtok( NULL, cmdDelim );
 1054              		.loc 1 425 0
 1055 0784 12508DE2 		add	r5, sp, #18
 1056 0788 0510A0E1 		mov	r1, r5
 1057 078c FEFFFFEB 		bl	strtok
 426:main.c        ****         if (strcmp(cmdParts, "RED") == 0)
 1058              		.loc 1 426 0
 1059 0790 A8129FE5 		ldr	r1, .L105+236
 1060              		.loc 1 425 0
 1061 0794 0040A0E1 		mov	r4, r0
 1062              	.LVL25:
 1063              		.loc 1 426 0
 1064 0798 FEFFFFEB 		bl	strcmp
 1065 079c 000050E3 		cmp	r0, #0
 1066 07a0 0302001A 		bne	.L79
 427:main.c        ****         {
 428:main.c        ****             //GREEN LED
 429:main.c        ****             cmdParts = strtok( NULL, cmdDelim );
 1067              		.loc 1 429 0
 1068 07a4 0510A0E1 		mov	r1, r5
 1069 07a8 FEFFFFEB 		bl	strtok
 430:main.c        ****             if (strcmp(cmdParts, "ON") == 0)
 1070              		.loc 1 430 0
 1071 07ac 90129FE5 		ldr	r1, .L105+240
 1072              		.loc 1 429 0
 1073 07b0 0040A0E1 		mov	r4, r0
 1074              		.loc 1 430 0
 1075 07b4 FEFFFFEB 		bl	strcmp
 1076 07b8 000050E3 		cmp	r0, #0
 1077              	.LBB108:
 1078              	.LBB109:
 1079              		.loc 2 609 0
 1080 07bc 0820A003 		moveq	r2, #8
 1081 07c0 0B3CE003 		mvneq	r3, #2816
 1082 07c4 CF200305 		streq	r2, [r3, #-207]
 1083              	.LBE109:
 1084              	.LBE108:
 431:main.c        ****             {
 432:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED1);
 433:main.c        ****             }
 434:main.c        ****             if (strcmp(cmdParts, "OFF") == 0)
 1085              		.loc 1 434 0
 1086 07c8 78129FE5 		ldr	r1, .L105+244
 1087 07cc 0400A0E1 		mov	r0, r4
 1088 07d0 FEFFFFEB 		bl	strcmp
 1089 07d4 000050E3 		cmp	r0, #0
 1090              	.LBB110:
 1091              	.LBB111:
 1092              		.loc 2 620 0
 1093 07d8 0820A003 		moveq	r2, #8
 1094 07dc 0B3CE003 		mvneq	r3, #2816
 1095 07e0 CB200305 		streq	r2, [r3, #-203]
 1096              	.LBE111:
 1097              	.LBE110:
 435:main.c        ****             {
 436:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 437:main.c        ****             }
 438:main.c        ****             if (strcmp(cmdParts, "SET") == 0)
 1098              		.loc 1 438 0
 1099 07e4 0400A0E1 		mov	r0, r4
 1100 07e8 B8119FE5 		ldr	r1, .L105+84
 1101 07ec FEFFFFEB 		bl	strcmp
 1102 07f0 000050E3 		cmp	r0, #0
 1103 07f4 0302001A 		bne	.L79
 1104              	.LBB112:
 1105              	.LBB113:
 1106              		.loc 2 609 0
 1107 07f8 0B2CE0E3 		mvn	r2, #2816
 1108 07fc 0830A0E3 		mov	r3, #8
 1109 0800 CF3002E5 		str	r3, [r2, #-207]
 1110              	.LBE113:
 1111              	.LBE112:
 1112              	.LBB114:
 1113              	.LBB115:
 1114              		.loc 2 620 0
 1115 0804 033083E0 		add	r3, r3, r3
 1116 0808 CB3002E5 		str	r3, [r2, #-203]
 1117              	.LBE115:
 1118              	.LBE114:
 1119              	.LBB116:
 1120              	.LBB117:
 1121 080c 103083E2 		add	r3, r3, #16
 1122 0810 CB3002E5 		str	r3, [r2, #-203]
 1123              	.L79:
 1124              	.LBE117:
 1125              	.LBE116:
 439:main.c        ****             {
 440:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED1);
 441:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 442:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 443:main.c        ****             }
 444:main.c        ****         }
 445:main.c        ****         if (strcmp(cmdParts, "YELLOW") == 0)
 1126              		.loc 1 445 0
 1127 0814 0400A0E1 		mov	r0, r4
 1128 0818 2C129FE5 		ldr	r1, .L105+248
 1129 081c FEFFFFEB 		bl	strcmp
 1130 0820 000050E3 		cmp	r0, #0
 1131 0824 2402001A 		bne	.L86
 446:main.c        ****         {
 447:main.c        ****             //YELLOW LED
 448:main.c        ****             cmdParts = strtok( NULL, cmdDelim );
 1132              		.loc 1 448 0
 1133 0828 12108DE2 		add	r1, sp, #18
 1134 082c FEFFFFEB 		bl	strtok
 449:main.c        ****             if (strcmp(cmdParts, "ON") == 0)
 1135              		.loc 1 449 0
 1136 0830 0C129FE5 		ldr	r1, .L105+240
 1137              		.loc 1 448 0
 1138 0834 0040A0E1 		mov	r4, r0
 1139              		.loc 1 449 0
 1140 0838 FEFFFFEB 		bl	strcmp
 1141 083c 000050E3 		cmp	r0, #0
 1142              	.LBB118:
 1143              	.LBB119:
 1144              		.loc 2 609 0
 1145 0840 1020A003 		moveq	r2, #16
 1146 0844 0B3CE003 		mvneq	r3, #2816
 1147 0848 CF200305 		streq	r2, [r3, #-207]
 1148              	.LBE119:
 1149              	.LBE118:
 450:main.c        ****             {
 451:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED2);
 452:main.c        ****             }
 453:main.c        ****             if (strcmp(cmdParts, "OFF") == 0)
 1150              		.loc 1 453 0
 1151 084c F4119FE5 		ldr	r1, .L105+244
 1152 0850 0400A0E1 		mov	r0, r4
 1153 0854 FEFFFFEB 		bl	strcmp
 1154 0858 000050E3 		cmp	r0, #0
 1155              	.LBB120:
 1156              	.LBB121:
 1157              		.loc 2 620 0
 1158 085c 1020A003 		moveq	r2, #16
 1159 0860 0B3CE003 		mvneq	r3, #2816
 1160 0864 CB200305 		streq	r2, [r3, #-203]
 1161              	.LBE121:
 1162              	.LBE120:
 454:main.c        ****             {
 455:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 456:main.c        ****             }
 457:main.c        ****             if (strcmp(cmdParts, "SET") == 0)
 1163              		.loc 1 457 0
 1164 0868 0400A0E1 		mov	r0, r4
 1165 086c 34119FE5 		ldr	r1, .L105+84
 1166 0870 FEFFFFEB 		bl	strcmp
 1167 0874 000050E3 		cmp	r0, #0
 1168 0878 2402001A 		bne	.L86
 1169              	.LBB122:
 1170              	.LBB123:
 1171              		.loc 2 609 0
 1172 087c 0B2CE0E3 		mvn	r2, #2816
 1173 0880 1030A0E3 		mov	r3, #16
 1174 0884 CF3002E5 		str	r3, [r2, #-207]
 1175              	.LBE123:
 1176              	.LBE122:
 1177              	.LBB124:
 1178              	.LBB125:
 1179              		.loc 2 620 0
 1180 0888 0830A0E3 		mov	r3, #8
 1181 088c CB3002E5 		str	r3, [r2, #-203]
 1182              	.LBE125:
 1183              	.LBE124:
 1184              	.LBB126:
 1185              	.LBB127:
 1186 0890 183083E2 		add	r3, r3, #24
 1187 0894 CB3002E5 		str	r3, [r2, #-203]
 1188              	.L86:
 1189              	.LBE127:
 1190              	.LBE126:
 458:main.c        ****             {
 459:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED2);
 460:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 461:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 462:main.c        ****             }
 463:main.c        ****         }
 464:main.c        ****         if (strcmp(cmdParts, "GREEN") == 0)
 1191              		.loc 1 464 0
 1192 0898 0400A0E1 		mov	r0, r4
 1193 089c AC119FE5 		ldr	r1, .L105+252
 1194 08a0 FEFFFFEB 		bl	strcmp
 1195 08a4 000050E3 		cmp	r0, #0
 1196 08a8 4502001A 		bne	.L93
 465:main.c        ****         {
 466:main.c        ****             //RED LED
 467:main.c        ****             cmdParts = strtok( NULL, cmdDelim );
 1197              		.loc 1 467 0
 1198 08ac 12108DE2 		add	r1, sp, #18
 1199 08b0 FEFFFFEB 		bl	strtok
 468:main.c        ****             if (strcmp(cmdParts, "ON") == 0)
 1200              		.loc 1 468 0
 1201 08b4 88119FE5 		ldr	r1, .L105+240
 1202              		.loc 1 467 0
 1203 08b8 0040A0E1 		mov	r4, r0
 1204              		.loc 1 468 0
 1205 08bc FEFFFFEB 		bl	strcmp
 1206 08c0 000050E3 		cmp	r0, #0
 1207              	.LBB128:
 1208              	.LBB129:
 1209              		.loc 2 609 0
 1210 08c4 2020A003 		moveq	r2, #32
 1211 08c8 0B3CE003 		mvneq	r3, #2816
 1212 08cc CF200305 		streq	r2, [r3, #-207]
 1213              	.LBE129:
 1214              	.LBE128:
 469:main.c        ****             {
 470:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED3);
 471:main.c        ****             }
 472:main.c        ****             if (strcmp(cmdParts, "OFF") == 0)
 1215              		.loc 1 472 0
 1216 08d0 70119FE5 		ldr	r1, .L105+244
 1217 08d4 0400A0E1 		mov	r0, r4
 1218 08d8 FEFFFFEB 		bl	strcmp
 1219 08dc 000050E3 		cmp	r0, #0
 1220              	.LBB130:
 1221              	.LBB131:
 1222              		.loc 2 620 0
 1223 08e0 2020A003 		moveq	r2, #32
 1224 08e4 0B3CE003 		mvneq	r3, #2816
 1225 08e8 CB200305 		streq	r2, [r3, #-203]
 1226              	.LBE131:
 1227              	.LBE130:
 473:main.c        ****             {
 474:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 475:main.c        ****             }
 476:main.c        ****             if (strcmp(cmdParts, "SET") == 0)
 1228              		.loc 1 476 0
 1229 08ec 0400A0E1 		mov	r0, r4
 1230 08f0 B0109FE5 		ldr	r1, .L105+84
 1231 08f4 FEFFFFEB 		bl	strcmp
 1232 08f8 000050E3 		cmp	r0, #0
 1233 08fc 4502001A 		bne	.L93
 1234              	.LBB132:
 1235              	.LBB133:
 1236              		.loc 2 609 0
 1237 0900 0B2CE0E3 		mvn	r2, #2816
 1238 0904 2030A0E3 		mov	r3, #32
 1239 0908 CF3002E5 		str	r3, [r2, #-207]
 1240              	.LBE133:
 1241              	.LBE132:
 1242              	.LBB134:
 1243              	.LBB135:
 1244              		.loc 2 620 0
 1245 090c 1030A0E3 		mov	r3, #16
 1246 0910 CB3002E5 		str	r3, [r2, #-203]
 1247              	.LBE135:
 1248              	.LBE134:
 1249              	.LBB136:
 1250              	.LBB137:
 1251 0914 0830A0E3 		mov	r3, #8
 1252 0918 CB3002E5 		str	r3, [r2, #-203]
 1253              	.L93:
 1254              	.LBE137:
 1255              	.LBE136:
 477:main.c        ****             {
 478:main.c        ****                 AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED3);
 479:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 480:main.c        ****                 AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 481:main.c        ****             }
 482:main.c        ****         }
 483:main.c        ****         if (strcmp(cmdParts, "ALLOFF") == 0)
 1256              		.loc 1 483 0
 1257 091c 0400A0E1 		mov	r0, r4
 1258 0920 2C119FE5 		ldr	r1, .L105+256
 1259 0924 FEFFFFEB 		bl	strcmp
 1260 0928 000050E3 		cmp	r0, #0
 1261 092c 5102001A 		bne	.L101
 1262              	.LBB138:
 1263              	.LBB139:
 1264              		.loc 2 620 0
 1265 0930 0B2CE0E3 		mvn	r2, #2816
 1266 0934 0830A0E3 		mov	r3, #8
 1267 0938 CB3002E5 		str	r3, [r2, #-203]
 1268              	.LBE139:
 1269              	.LBE138:
 1270              	.LBB140:
 1271              	.LBB141:
 1272 093c 033083E0 		add	r3, r3, r3
 1273 0940 CB3002E5 		str	r3, [r2, #-203]
 1274              	.LBE141:
 1275              	.LBE140:
 1276              	.LBB142:
 1277              	.LBB143:
 1278 0944 103083E2 		add	r3, r3, #16
 1279 0948 CB3002E5 		str	r3, [r2, #-203]
 1280              	.LVL26:
 1281              	.L101:
 1282              	.LBE143:
 1283              	.LBE142:
 484:main.c        ****         {
 485:main.c        ****             AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 486:main.c        ****             AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 487:main.c        ****             AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 488:main.c        ****         }
 489:main.c        ****     }
 490:main.c        **** }
 1284              		.loc 1 490 0
 1285 094c 14D08DE2 		add	sp, sp, #20
 1286 0950 7080BDE8 		ldmfd	sp!, {r4, r5, r6, pc}
 1287              	.L106:
 1288              		.align	2
 1289              	.L105:
 1290 0954 D0020000 		.word	.LC0
 1291 0958 00000000 		.word	.LC1
 1292 095c 08000000 		.word	.LC2
 1293 0960 50C30000 		.word	50000
 1294 0964 18000000 		.word	.LC3
 1295 0968 20000000 		.word	.LC4
 1296 096c 00000000 		.word	aatDiag
 1297 0970 00000000 		.word	aatDiagStep
 1298 0974 28000000 		.word	.LC5
 1299 0978 30000000 		.word	.LC6
 1300 097c 38000000 		.word	.LC7
 1301 0980 00000000 		.word	maxForce
 1302 0984 00000000 		.word	diagForce
 1303 0988 48000000 		.word	.LC8
 1304 098c 54000000 		.word	.LC9
 1305 0990 00000000 		.word	maxPos
 1306 0994 58000000 		.word	.LC10
 1307 0998 00000000 		.word	msg
 1308 099c 78000000 		.word	.LC11
 1309 09a0 00000000 		.word	minPos
 1310 09a4 7C000000 		.word	.LC12
 1311 09a8 9C000000 		.word	.LC13
 1312 09ac 00000000 		.word	curPos
 1313 09b0 A0000000 		.word	.LC14
 1314 09b4 C4000000 		.word	.LC15
 1315 09b8 CC000000 		.word	.LC16
 1316 09bc 00000000 		.word	minForce
 1317 09c0 E8000000 		.word	.LC17
 1318 09c4 00000000 		.word	curForce
 1319 09c8 04010000 		.word	.LC18
 1320 09cc 24010000 		.word	.LC19
 1321 09d0 00000000 		.word	minDiagForce
 1322 09d4 2C010000 		.word	.LC20
 1323 09d8 50010000 		.word	.LC21
 1324 09dc 00000000 		.word	lockDiagForce
 1325 09e0 5C010000 		.word	.LC22
 1326 09e4 7C010000 		.word	.LC23
 1327 09e8 88010000 		.word	.LC24
 1328 09ec 00000000 		.word	pressure
 1329 09f0 00000000 		.word	lockDiagPressure
 1330 09f4 90010000 		.word	.LC25
 1331 09f8 B0010000 		.word	.LC26
 1332 09fc BC010000 		.word	.LC27
 1333 0a00 C0010000 		.word	.LC28
 1334 0a04 80FF1100 		.word	1179520
 1335 0a08 00000000 		.word	settings
 1336 0a0c 80000000 		.word	settings+128
 1337 0a10 D4010000 		.word	.LC29
 1338 0a14 00000000 		.word	flashWrite
 1339 0a18 2C020000 		.word	.LC30
 1340 0a1c 5C020000 		.word	.LC31
 1341 0a20 68020000 		.word	.LC32
 1342 0a24 70020000 		.word	.LC33
 1343 0a28 00000000 		.word	dataReading
 1344 0a2c 84020000 		.word	.LC34
 1345 0a30 00000000 		.word	reading
 1346 0a34 8C020000 		.word	.LC35
 1347 0a38 A0020000 		.word	.LC36
 1348 0a3c A8020000 		.word	.LC37
 1349 0a40 AC020000 		.word	.LC38
 1350 0a44 B0020000 		.word	.LC39
 1351 0a48 B4020000 		.word	.LC40
 1352 0a4c B8020000 		.word	.LC41
 1353 0a50 C0020000 		.word	.LC42
 1354 0a54 C8020000 		.word	.LC43
 1355              	.LFE299:
 1357              		.align	2
 1358              		.global	setForce
 1360              	setForce:
 1361              	.LFB293:
 1362              		.loc 1 181 0
 1363              		@ args = 0, pretend = 0, frame = 0
 1364              		@ frame_needed = 0, uses_anonymous_args = 0
 1365              		@ link register save eliminated.
 1366              	.LVL27:
 1367              	.LBB152:
 1368              	.LBB153:
 621:lib_AT91SAM7S64.h **** }
 622:lib_AT91SAM7S64.h **** 
 623:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 624:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_ForceOutput
 625:lib_AT91SAM7S64.h **** //* \brief Force output when Direct drive option is enabled
 626:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 627:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_ForceOutput(
 628:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 629:lib_AT91SAM7S64.h **** 	unsigned int flag) // \arg  output to be forced
 630:lib_AT91SAM7S64.h **** {
 631:lib_AT91SAM7S64.h **** 	pPio->PIO_ODSR = flag;
 632:lib_AT91SAM7S64.h **** }
 633:lib_AT91SAM7S64.h **** 
 634:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 635:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Enable
 636:lib_AT91SAM7S64.h **** //* \brief Enable PIO
 637:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 638:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Enable(
 639:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 640:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled 
 641:lib_AT91SAM7S64.h **** {
 642:lib_AT91SAM7S64.h ****         pPio->PIO_PER = flag;
 643:lib_AT91SAM7S64.h **** }
 644:lib_AT91SAM7S64.h **** 
 645:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 646:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Disable
 647:lib_AT91SAM7S64.h **** //* \brief Disable PIO
 648:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 649:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_Disable(
 650:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 651:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled 
 652:lib_AT91SAM7S64.h **** {
 653:lib_AT91SAM7S64.h ****         pPio->PIO_PDR = flag;
 654:lib_AT91SAM7S64.h **** }
 655:lib_AT91SAM7S64.h **** 
 656:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 657:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetStatus
 658:lib_AT91SAM7S64.h **** //* \brief Return PIO Status
 659:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 660:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetStatus( // \return PIO Status
 661:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 662:lib_AT91SAM7S64.h **** {
 663:lib_AT91SAM7S64.h ****         return pPio->PIO_PSR;
 664:lib_AT91SAM7S64.h **** }
 665:lib_AT91SAM7S64.h **** 
 666:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 667:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsSet
 668:lib_AT91SAM7S64.h **** //* \brief Test if PIO is Set
 669:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 670:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsSet(
 671:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 672:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 673:lib_AT91SAM7S64.h **** {
 674:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetStatus(pPio) & flag);
 675:lib_AT91SAM7S64.h **** }
 676:lib_AT91SAM7S64.h **** 
 677:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 678:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputEnable
 679:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 680:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 681:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputEnable(
 682:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 683:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be enabled
 684:lib_AT91SAM7S64.h **** {
 685:lib_AT91SAM7S64.h ****         pPio->PIO_OER = flag;
 686:lib_AT91SAM7S64.h **** }
 687:lib_AT91SAM7S64.h **** 
 688:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 689:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputDisable
 690:lib_AT91SAM7S64.h **** //* \brief Output Enable PIO
 691:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 692:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputDisable(
 693:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 694:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output to be disabled
 695:lib_AT91SAM7S64.h **** {
 696:lib_AT91SAM7S64.h ****         pPio->PIO_ODR = flag;
 697:lib_AT91SAM7S64.h **** }
 698:lib_AT91SAM7S64.h **** 
 699:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 700:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputStatus
 701:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Status
 702:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 703:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputStatus( // \return PIO Output Status
 704:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 705:lib_AT91SAM7S64.h **** {
 706:lib_AT91SAM7S64.h ****         return pPio->PIO_OSR;
 707:lib_AT91SAM7S64.h **** }
 708:lib_AT91SAM7S64.h **** 
 709:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 710:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOuputSet
 711:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output is Set
 712:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 713:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputSet(
 714:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 715:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 716:lib_AT91SAM7S64.h **** {
 717:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputStatus(pPio) & flag);
 718:lib_AT91SAM7S64.h **** }
 719:lib_AT91SAM7S64.h **** 
 720:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 721:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterEnable
 722:lib_AT91SAM7S64.h **** //* \brief Input Filter Enable PIO
 723:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 724:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterEnable(
 725:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 726:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be enabled
 727:lib_AT91SAM7S64.h **** {
 728:lib_AT91SAM7S64.h ****         pPio->PIO_IFER = flag;
 729:lib_AT91SAM7S64.h **** }
 730:lib_AT91SAM7S64.h **** 
 731:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 732:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InputFilterDisable
 733:lib_AT91SAM7S64.h **** //* \brief Input Filter Disable PIO
 734:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 735:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InputFilterDisable(
 736:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 737:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio input filter to be disabled
 738:lib_AT91SAM7S64.h **** {
 739:lib_AT91SAM7S64.h ****         pPio->PIO_IFDR = flag;
 740:lib_AT91SAM7S64.h **** }
 741:lib_AT91SAM7S64.h **** 
 742:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 743:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInputFilterStatus
 744:lib_AT91SAM7S64.h **** //* \brief Return PIO Input Filter Status
 745:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 746:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInputFilterStatus( // \return PIO Input Filter Status
 747:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 748:lib_AT91SAM7S64.h **** {
 749:lib_AT91SAM7S64.h ****         return pPio->PIO_IFSR;
 750:lib_AT91SAM7S64.h **** }
 751:lib_AT91SAM7S64.h **** 
 752:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 753:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInputFilterSet
 754:lib_AT91SAM7S64.h **** //* \brief Test if PIO Input filter is Set
 755:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 756:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInputFilterSet(
 757:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 758:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 759:lib_AT91SAM7S64.h **** {
 760:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInputFilterStatus(pPio) & flag);
 761:lib_AT91SAM7S64.h **** }
 762:lib_AT91SAM7S64.h **** 
 763:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 764:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputDataStatus
 765:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Data Status 
 766:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 767:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputDataStatus( // \return PIO Output Data Status 
 768:lib_AT91SAM7S64.h **** 	AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 769:lib_AT91SAM7S64.h **** {
 770:lib_AT91SAM7S64.h ****         return pPio->PIO_ODSR;
 771:lib_AT91SAM7S64.h **** }
 772:lib_AT91SAM7S64.h **** 
 773:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 774:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptEnable
 775:lib_AT91SAM7S64.h **** //* \brief Enable PIO Interrupt
 776:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 777:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptEnable(
 778:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 779:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be enabled
 780:lib_AT91SAM7S64.h **** {
 781:lib_AT91SAM7S64.h ****         pPio->PIO_IER = flag;
 782:lib_AT91SAM7S64.h **** }
 783:lib_AT91SAM7S64.h **** 
 784:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 785:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_InterruptDisable
 786:lib_AT91SAM7S64.h **** //* \brief Disable PIO Interrupt
 787:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 788:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_InterruptDisable(
 789:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 790:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio interrupt to be disabled
 791:lib_AT91SAM7S64.h **** {
 792:lib_AT91SAM7S64.h ****         pPio->PIO_IDR = flag;
 793:lib_AT91SAM7S64.h **** }
 794:lib_AT91SAM7S64.h **** 
 795:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 796:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptMaskStatus
 797:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Mask Status
 798:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 799:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptMaskStatus( // \return PIO Interrupt Mask Status
 800:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 801:lib_AT91SAM7S64.h **** {
 802:lib_AT91SAM7S64.h ****         return pPio->PIO_IMR;
 803:lib_AT91SAM7S64.h **** }
 804:lib_AT91SAM7S64.h **** 
 805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 806:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetInterruptStatus
 807:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 808:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 809:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetInterruptStatus( // \return PIO Interrupt Status
 810:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 811:lib_AT91SAM7S64.h **** {
 812:lib_AT91SAM7S64.h ****         return pPio->PIO_ISR;
 813:lib_AT91SAM7S64.h **** }
 814:lib_AT91SAM7S64.h **** 
 815:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 816:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptMasked
 817:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Masked 
 818:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 819:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptMasked(
 820:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 821:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 822:lib_AT91SAM7S64.h **** {
 823:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptMaskStatus(pPio) & flag);
 824:lib_AT91SAM7S64.h **** }
 825:lib_AT91SAM7S64.h **** 
 826:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 827:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsInterruptSet
 828:lib_AT91SAM7S64.h **** //* \brief Test if PIO Interrupt is Set
 829:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 830:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsInterruptSet(
 831:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 832:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 833:lib_AT91SAM7S64.h **** {
 834:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetInterruptStatus(pPio) & flag);
 835:lib_AT91SAM7S64.h **** }
 836:lib_AT91SAM7S64.h **** 
 837:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 838:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverEnable
 839:lib_AT91SAM7S64.h **** //* \brief Multi Driver Enable PIO
 840:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 841:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverEnable(
 842:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 843:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be enabled
 844:lib_AT91SAM7S64.h **** {
 845:lib_AT91SAM7S64.h ****         pPio->PIO_MDER = flag;
 846:lib_AT91SAM7S64.h **** }
 847:lib_AT91SAM7S64.h **** 
 848:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 849:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_MultiDriverDisable
 850:lib_AT91SAM7S64.h **** //* \brief Multi Driver Disable PIO
 851:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 852:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_MultiDriverDisable(
 853:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 854:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio to be disabled
 855:lib_AT91SAM7S64.h **** {
 856:lib_AT91SAM7S64.h ****         pPio->PIO_MDDR = flag;
 857:lib_AT91SAM7S64.h **** }
 858:lib_AT91SAM7S64.h **** 
 859:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 860:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetMultiDriverStatus
 861:lib_AT91SAM7S64.h **** //* \brief Return PIO Multi Driver Status
 862:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 863:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetMultiDriverStatus( // \return PIO Multi Driver Status
 864:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 865:lib_AT91SAM7S64.h **** {
 866:lib_AT91SAM7S64.h ****         return pPio->PIO_MDSR;
 867:lib_AT91SAM7S64.h **** }
 868:lib_AT91SAM7S64.h **** 
 869:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 870:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsMultiDriverSet
 871:lib_AT91SAM7S64.h **** //* \brief Test if PIO MultiDriver is Set
 872:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 873:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsMultiDriverSet(
 874:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 875:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 876:lib_AT91SAM7S64.h **** {
 877:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetMultiDriverStatus(pPio) & flag);
 878:lib_AT91SAM7S64.h **** }
 879:lib_AT91SAM7S64.h **** 
 880:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 881:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_A_RegisterSelection
 882:lib_AT91SAM7S64.h **** //* \brief PIO A Register Selection 
 883:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 884:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_A_RegisterSelection(
 885:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 886:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio A register selection
 887:lib_AT91SAM7S64.h **** {
 888:lib_AT91SAM7S64.h ****         pPio->PIO_ASR = flag;
 889:lib_AT91SAM7S64.h **** }
 890:lib_AT91SAM7S64.h **** 
 891:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 892:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_B_RegisterSelection
 893:lib_AT91SAM7S64.h **** //* \brief PIO B Register Selection 
 894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 895:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_B_RegisterSelection(
 896:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 897:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio B register selection 
 898:lib_AT91SAM7S64.h **** {
 899:lib_AT91SAM7S64.h ****         pPio->PIO_BSR = flag;
 900:lib_AT91SAM7S64.h **** }
 901:lib_AT91SAM7S64.h **** 
 902:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 903:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_Get_AB_RegisterStatus
 904:lib_AT91SAM7S64.h **** //* \brief Return PIO Interrupt Status
 905:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 906:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_Get_AB_RegisterStatus( // \return PIO AB Register Status
 907:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 908:lib_AT91SAM7S64.h **** {
 909:lib_AT91SAM7S64.h ****         return pPio->PIO_ABSR;
 910:lib_AT91SAM7S64.h **** }
 911:lib_AT91SAM7S64.h **** 
 912:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 913:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsAB_RegisterSet
 914:lib_AT91SAM7S64.h **** //* \brief Test if PIO AB Register is Set
 915:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 916:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsAB_RegisterSet(
 917:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 918:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 919:lib_AT91SAM7S64.h **** {
 920:lib_AT91SAM7S64.h ****         return (AT91F_PIO_Get_AB_RegisterStatus(pPio) & flag);
 921:lib_AT91SAM7S64.h **** }
 922:lib_AT91SAM7S64.h **** 
 923:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 924:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteEnable
 925:lib_AT91SAM7S64.h **** //* \brief Output Write Enable PIO
 926:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 927:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteEnable(
 928:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 929:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be enabled
 930:lib_AT91SAM7S64.h **** {
 931:lib_AT91SAM7S64.h ****         pPio->PIO_OWER = flag;
 932:lib_AT91SAM7S64.h **** }
 933:lib_AT91SAM7S64.h **** 
 934:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 935:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_OutputWriteDisable
 936:lib_AT91SAM7S64.h **** //* \brief Output Write Disable PIO
 937:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 938:lib_AT91SAM7S64.h **** __inline void AT91F_PIO_OutputWriteDisable(
 939:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 940:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  pio output write to be disabled
 941:lib_AT91SAM7S64.h **** {
 942:lib_AT91SAM7S64.h ****         pPio->PIO_OWDR = flag;
 943:lib_AT91SAM7S64.h **** }
 944:lib_AT91SAM7S64.h **** 
 945:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 946:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetOutputWriteStatus
 947:lib_AT91SAM7S64.h **** //* \brief Return PIO Output Write Status
 948:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 949:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetOutputWriteStatus( // \return PIO Output Write Status
 950:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 951:lib_AT91SAM7S64.h **** {
 952:lib_AT91SAM7S64.h ****         return pPio->PIO_OWSR;
 953:lib_AT91SAM7S64.h **** }
 954:lib_AT91SAM7S64.h **** 
 955:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 956:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputWriteSet
 957:lib_AT91SAM7S64.h **** //* \brief Test if PIO OutputWrite is Set
 958:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 959:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputWriteSet(
 960:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 961:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 962:lib_AT91SAM7S64.h **** {
 963:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputWriteStatus(pPio) & flag);
 964:lib_AT91SAM7S64.h **** }
 965:lib_AT91SAM7S64.h **** 
 966:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 967:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_GetCfgPullup
 968:lib_AT91SAM7S64.h **** //* \brief Return PIO Configuration Pullup
 969:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 970:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PIO_GetCfgPullup( // \return PIO Configuration Pullup 
 971:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio) // \arg  pointer to a PIO controller
 972:lib_AT91SAM7S64.h **** {
 973:lib_AT91SAM7S64.h ****         return pPio->PIO_PPUSR;
 974:lib_AT91SAM7S64.h **** }
 975:lib_AT91SAM7S64.h **** 
 976:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 977:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsOutputDataStatusSet
 978:lib_AT91SAM7S64.h **** //* \brief Test if PIO Output Data Status is Set 
 979:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 980:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsOutputDataStatusSet(
 981:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 982:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 983:lib_AT91SAM7S64.h **** {
 984:lib_AT91SAM7S64.h ****         return (AT91F_PIO_GetOutputDataStatus(pPio) & flag);
 985:lib_AT91SAM7S64.h **** }
 986:lib_AT91SAM7S64.h **** 
 987:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 988:lib_AT91SAM7S64.h **** //* \fn    AT91F_PIO_IsCfgPullupStatusSet
 989:lib_AT91SAM7S64.h **** //* \brief Test if PIO Configuration Pullup Status is Set
 990:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
 991:lib_AT91SAM7S64.h **** __inline int AT91F_PIO_IsCfgPullupStatusSet(
 992:lib_AT91SAM7S64.h ****         AT91PS_PIO pPio,   // \arg  pointer to a PIO controller
 993:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
 994:lib_AT91SAM7S64.h **** {
 995:lib_AT91SAM7S64.h ****         return (~AT91F_PIO_GetCfgPullup(pPio) & flag);
 996:lib_AT91SAM7S64.h **** }
 997:lib_AT91SAM7S64.h **** 
 998:lib_AT91SAM7S64.h **** /* *****************************************************************************
 999:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PMC
1000:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1001:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1002:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkEnableReg
1003:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Enable Register of the PMC controller
1004:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1005:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkEnableReg (
1006:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1007:lib_AT91SAM7S64.h **** 	unsigned int mode)
1008:lib_AT91SAM7S64.h **** {
1009:lib_AT91SAM7S64.h **** 	//* Write to the SCER register
1010:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = mode;
1011:lib_AT91SAM7S64.h **** }
1012:lib_AT91SAM7S64.h **** 
1013:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1014:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgSysClkDisableReg
1015:lib_AT91SAM7S64.h **** //* \brief Configure the System Clock Disable Register of the PMC controller
1016:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1017:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgSysClkDisableReg (
1018:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1019:lib_AT91SAM7S64.h **** 	unsigned int mode)
1020:lib_AT91SAM7S64.h **** {
1021:lib_AT91SAM7S64.h **** 	//* Write to the SCDR register
1022:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = mode;
1023:lib_AT91SAM7S64.h **** }
1024:lib_AT91SAM7S64.h **** 
1025:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1026:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetSysClkStatusReg
1027:lib_AT91SAM7S64.h **** //* \brief Return the System Clock Status Register of the PMC controller
1028:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1029:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetSysClkStatusReg (
1030:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC // pointer to a CAN controller
1031:lib_AT91SAM7S64.h **** 	)
1032:lib_AT91SAM7S64.h **** {
1033:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SCSR;
1034:lib_AT91SAM7S64.h **** }
1035:lib_AT91SAM7S64.h **** 
1036:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1037:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePeriphClock
1038:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1039:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1040:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePeriphClock (
1041:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1042:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1043:lib_AT91SAM7S64.h **** {
1044:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCER = periphIds;
1045:lib_AT91SAM7S64.h **** }
1046:lib_AT91SAM7S64.h **** 
1047:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1048:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePeriphClock
1049:lib_AT91SAM7S64.h **** //* \brief Disable peripheral clock
1050:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1051:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePeriphClock (
1052:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1053:lib_AT91SAM7S64.h **** 	unsigned int periphIds)  // \arg IDs of peripherals to enable
1054:lib_AT91SAM7S64.h **** {
1055:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCDR = periphIds;
1056:lib_AT91SAM7S64.h **** }
1057:lib_AT91SAM7S64.h **** 
1058:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1059:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetPeriphClock
1060:lib_AT91SAM7S64.h **** //* \brief Get peripheral clock status
1061:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1062:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetPeriphClock (
1063:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1064:lib_AT91SAM7S64.h **** {
1065:lib_AT91SAM7S64.h **** 	return pPMC->PMC_PCSR;
1066:lib_AT91SAM7S64.h **** }
1067:lib_AT91SAM7S64.h **** 
1068:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1069:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscillatorReg
1070:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1071:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1072:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscillatorReg (
1073:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1074:lib_AT91SAM7S64.h **** 	unsigned int mode)
1075:lib_AT91SAM7S64.h **** {
1076:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR = mode;
1077:lib_AT91SAM7S64.h **** }
1078:lib_AT91SAM7S64.h **** 
1079:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1080:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainOscillatorReg
1081:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1082:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1083:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainOscillatorReg (
1084:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1085:lib_AT91SAM7S64.h **** {
1086:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MOR;
1087:lib_AT91SAM7S64.h **** }
1088:lib_AT91SAM7S64.h **** 
1089:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1090:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_EnableMainOscillator
1091:lib_AT91SAM7S64.h **** //* \brief Enable the main oscillator
1092:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1093:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_EnableMainOscillator(
1094:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1095:lib_AT91SAM7S64.h **** {
1096:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= AT91C_CKGR_MOSCEN;
1097:lib_AT91SAM7S64.h **** }
1098:lib_AT91SAM7S64.h **** 
1099:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1100:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_DisableMainOscillator
1101:lib_AT91SAM7S64.h **** //* \brief Disable the main oscillator
1102:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1103:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_DisableMainOscillator (
1104:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1105:lib_AT91SAM7S64.h **** {
1106:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_MOSCEN;
1107:lib_AT91SAM7S64.h **** }
1108:lib_AT91SAM7S64.h **** 
1109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1110:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_CfgMainOscStartUpTime
1111:lib_AT91SAM7S64.h **** //* \brief Cfg MOR Register according to the main osc startup time
1112:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1113:lib_AT91SAM7S64.h **** __inline void AT91F_CKGR_CfgMainOscStartUpTime (
1114:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1115:lib_AT91SAM7S64.h **** 	unsigned int startup_time,  // \arg main osc startup time in microsecond (us)
1116:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1117:lib_AT91SAM7S64.h **** {
1118:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR &= ~AT91C_CKGR_OSCOUNT;
1119:lib_AT91SAM7S64.h **** 	pCKGR->CKGR_MOR |= ((slowClock * startup_time)/(8*1000000)) << 8;
1120:lib_AT91SAM7S64.h **** }
1121:lib_AT91SAM7S64.h **** 
1122:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1123:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClockFreqReg
1124:lib_AT91SAM7S64.h **** //* \brief Cfg the main oscillator
1125:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1126:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClockFreqReg (
1127:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR) // \arg pointer to CKGR controller
1128:lib_AT91SAM7S64.h **** {
1129:lib_AT91SAM7S64.h **** 	return pCKGR->CKGR_MCFR;
1130:lib_AT91SAM7S64.h **** }
1131:lib_AT91SAM7S64.h **** 
1132:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1133:lib_AT91SAM7S64.h **** //* \fn    AT91F_CKGR_GetMainClock
1134:lib_AT91SAM7S64.h **** //* \brief Return Main clock in Hz
1135:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1136:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_CKGR_GetMainClock (
1137:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1138:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1139:lib_AT91SAM7S64.h **** {
1140:lib_AT91SAM7S64.h **** 	return ((pCKGR->CKGR_MCFR  & AT91C_CKGR_MAINF) * slowClock) >> 4;
1141:lib_AT91SAM7S64.h **** }
1142:lib_AT91SAM7S64.h **** 
1143:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1144:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_CfgMCKReg
1145:lib_AT91SAM7S64.h **** //* \brief Cfg Master Clock Register
1146:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1147:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_CfgMCKReg (
1148:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1149:lib_AT91SAM7S64.h **** 	unsigned int mode)
1150:lib_AT91SAM7S64.h **** {
1151:lib_AT91SAM7S64.h **** 	pPMC->PMC_MCKR = mode;
1152:lib_AT91SAM7S64.h **** }
1153:lib_AT91SAM7S64.h **** 
1154:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1155:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMCKReg
1156:lib_AT91SAM7S64.h **** //* \brief Return Master Clock Register
1157:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1158:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMCKReg(
1159:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // \arg pointer to PMC controller
1160:lib_AT91SAM7S64.h **** {
1161:lib_AT91SAM7S64.h **** 	return pPMC->PMC_MCKR;
1162:lib_AT91SAM7S64.h **** }
1163:lib_AT91SAM7S64.h **** 
1164:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1165:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetMasterClock
1166:lib_AT91SAM7S64.h **** //* \brief Return master clock in Hz which correponds to processor clock for ARM7
1167:lib_AT91SAM7S64.h **** //*------------------------------------------------------------------------------
1168:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetMasterClock (
1169:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1170:lib_AT91SAM7S64.h **** 	AT91PS_CKGR pCKGR, // \arg pointer to CKGR controller
1171:lib_AT91SAM7S64.h **** 	unsigned int slowClock)  // \arg slowClock in Hz
1172:lib_AT91SAM7S64.h **** {
1173:lib_AT91SAM7S64.h **** 	unsigned int reg = pPMC->PMC_MCKR;
1174:lib_AT91SAM7S64.h **** 	unsigned int prescaler = (1 << ((reg & AT91C_PMC_PRES) >> 2));
1175:lib_AT91SAM7S64.h **** 	unsigned int pllDivider, pllMultiplier;
1176:lib_AT91SAM7S64.h **** 
1177:lib_AT91SAM7S64.h **** 	switch (reg & AT91C_PMC_CSS) {
1178:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_SLOW_CLK: // Slow clock selected
1179:lib_AT91SAM7S64.h **** 			return slowClock / prescaler;
1180:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_MAIN_CLK: // Main clock is selected
1181:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / prescaler;
1182:lib_AT91SAM7S64.h **** 		case AT91C_PMC_CSS_PLL_CLK: // PLLB clock is selected
1183:lib_AT91SAM7S64.h **** 			reg = pCKGR->CKGR_PLLR;
1184:lib_AT91SAM7S64.h **** 			pllDivider    = (reg  & AT91C_CKGR_DIV);
1185:lib_AT91SAM7S64.h **** 			pllMultiplier = ((reg  & AT91C_CKGR_MUL) >> 16) + 1;
1186:lib_AT91SAM7S64.h **** 			return AT91F_CKGR_GetMainClock(pCKGR, slowClock) / pllDivider * pllMultiplier / prescaler;
1187:lib_AT91SAM7S64.h **** 	}
1188:lib_AT91SAM7S64.h **** 	return 0;
1189:lib_AT91SAM7S64.h **** }
1190:lib_AT91SAM7S64.h **** 
1191:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1192:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnablePCK
1193:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1194:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1195:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnablePCK (
1196:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1197:lib_AT91SAM7S64.h **** 	unsigned int pck,  // \arg Peripheral clock identifier 0 .. 7
1198:lib_AT91SAM7S64.h **** 	unsigned int mode)
1199:lib_AT91SAM7S64.h **** {
1200:lib_AT91SAM7S64.h **** 	pPMC->PMC_PCKR[pck] = mode;
1201:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCER = (1 << pck) << 8;
1202:lib_AT91SAM7S64.h **** }
1203:lib_AT91SAM7S64.h **** 
1204:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1205:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisablePCK
1206:lib_AT91SAM7S64.h **** //* \brief Enable peripheral clock
1207:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1208:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisablePCK (
1209:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // \arg pointer to PMC controller
1210:lib_AT91SAM7S64.h **** 	unsigned int pck)  // \arg Peripheral clock identifier 0 .. 7
1211:lib_AT91SAM7S64.h **** {
1212:lib_AT91SAM7S64.h **** 	pPMC->PMC_SCDR = (1 << pck) << 8;
1213:lib_AT91SAM7S64.h **** }
1214:lib_AT91SAM7S64.h **** 
1215:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1216:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_EnableIt
1217:lib_AT91SAM7S64.h **** //* \brief Enable PMC interrupt
1218:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1219:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_EnableIt (
1220:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC,     // pointer to a PMC controller
1221:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1222:lib_AT91SAM7S64.h **** {
1223:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1224:lib_AT91SAM7S64.h **** 	pPMC->PMC_IER = flag;
1225:lib_AT91SAM7S64.h **** }
1226:lib_AT91SAM7S64.h **** 
1227:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1228:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_DisableIt
1229:lib_AT91SAM7S64.h **** //* \brief Disable PMC interrupt
1230:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1231:lib_AT91SAM7S64.h **** __inline void AT91F_PMC_DisableIt (
1232:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC, // pointer to a PMC controller
1233:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1234:lib_AT91SAM7S64.h **** {
1235:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1236:lib_AT91SAM7S64.h **** 	pPMC->PMC_IDR = flag;
1237:lib_AT91SAM7S64.h **** }
1238:lib_AT91SAM7S64.h **** 
1239:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1240:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetStatus
1241:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Status
1242:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1243:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetStatus( // \return PMC Interrupt Status
1244:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1245:lib_AT91SAM7S64.h **** {
1246:lib_AT91SAM7S64.h **** 	return pPMC->PMC_SR;
1247:lib_AT91SAM7S64.h **** }
1248:lib_AT91SAM7S64.h **** 
1249:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1250:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_GetInterruptMaskStatus
1251:lib_AT91SAM7S64.h **** //* \brief Return PMC Interrupt Mask Status
1252:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1253:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_GetInterruptMaskStatus( // \return PMC Interrupt Mask Status
1254:lib_AT91SAM7S64.h **** 	AT91PS_PMC pPMC) // pointer to a PMC controller
1255:lib_AT91SAM7S64.h **** {
1256:lib_AT91SAM7S64.h **** 	return pPMC->PMC_IMR;
1257:lib_AT91SAM7S64.h **** }
1258:lib_AT91SAM7S64.h **** 
1259:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1260:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsInterruptMasked
1261:lib_AT91SAM7S64.h **** //* \brief Test if PMC Interrupt is Masked
1262:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1263:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsInterruptMasked(
1264:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1265:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1266:lib_AT91SAM7S64.h **** {
1267:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetInterruptMaskStatus(pPMC) & flag);
1268:lib_AT91SAM7S64.h **** }
1269:lib_AT91SAM7S64.h **** 
1270:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1271:lib_AT91SAM7S64.h **** //* \fn    AT91F_PMC_IsStatusSet
1272:lib_AT91SAM7S64.h **** //* \brief Test if PMC Status is Set
1273:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1274:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PMC_IsStatusSet(
1275:lib_AT91SAM7S64.h ****         AT91PS_PMC pPMC,   // \arg  pointer to a PMC controller
1276:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1277:lib_AT91SAM7S64.h **** {
1278:lib_AT91SAM7S64.h **** 	return (AT91F_PMC_GetStatus(pPMC) & flag);
1279:lib_AT91SAM7S64.h **** }/* *****************************************************************************
1280:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RSTC
1281:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1282:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1283:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSoftReset
1284:lib_AT91SAM7S64.h **** //* \brief Start Software Reset
1285:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1286:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSoftReset(
1287:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1288:lib_AT91SAM7S64.h ****         unsigned int reset)
1289:lib_AT91SAM7S64.h **** {
1290:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RCR = (0xA5000000 | reset);
1291:lib_AT91SAM7S64.h **** }
1292:lib_AT91SAM7S64.h **** 
1293:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1294:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTSetMode
1295:lib_AT91SAM7S64.h **** //* \brief Set Reset Mode
1296:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1297:lib_AT91SAM7S64.h **** __inline void AT91F_RSTSetMode(
1298:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC,
1299:lib_AT91SAM7S64.h ****         unsigned int mode)
1300:lib_AT91SAM7S64.h **** {
1301:lib_AT91SAM7S64.h **** 	pRSTC->RSTC_RMR = (0xA5000000 | mode);
1302:lib_AT91SAM7S64.h **** }
1303:lib_AT91SAM7S64.h **** 
1304:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1305:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetMode
1306:lib_AT91SAM7S64.h **** //* \brief Get Reset Mode
1307:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1308:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetMode(
1309:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1310:lib_AT91SAM7S64.h **** {
1311:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RMR);
1312:lib_AT91SAM7S64.h **** }
1313:lib_AT91SAM7S64.h **** 
1314:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1315:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTGetStatus
1316:lib_AT91SAM7S64.h **** //* \brief Get Reset Status
1317:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1318:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTGetStatus(
1319:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1320:lib_AT91SAM7S64.h **** {
1321:lib_AT91SAM7S64.h **** 	return (pRSTC->RSTC_RSR);
1322:lib_AT91SAM7S64.h **** }
1323:lib_AT91SAM7S64.h **** 
1324:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1325:lib_AT91SAM7S64.h **** //* \fn    AT91F_RSTIsSoftRstActive
1326:lib_AT91SAM7S64.h **** //* \brief Return !=0 if software reset is still not completed
1327:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1328:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RSTIsSoftRstActive(
1329:lib_AT91SAM7S64.h ****         AT91PS_RSTC pRSTC)
1330:lib_AT91SAM7S64.h **** {
1331:lib_AT91SAM7S64.h **** 	return ((pRSTC->RSTC_RSR) & AT91C_RSTC_SRCMP);
1332:lib_AT91SAM7S64.h **** }
1333:lib_AT91SAM7S64.h **** /* *****************************************************************************
1334:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR RTTC
1335:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1336:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1337:lib_AT91SAM7S64.h **** //* \fn     AT91F_SetRTT_TimeBase()
1338:lib_AT91SAM7S64.h **** //* \brief  Set the RTT prescaler according to the TimeBase in ms
1339:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1340:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetTimeBase(
1341:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1342:lib_AT91SAM7S64.h ****         unsigned int ms)
1343:lib_AT91SAM7S64.h **** {
1344:lib_AT91SAM7S64.h **** 	if (ms > 2000)
1345:lib_AT91SAM7S64.h **** 		return 1;   // AT91C_TIME_OUT_OF_RANGE
1346:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1347:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (((ms << 15) /1000) & 0xFFFF);	
1348:lib_AT91SAM7S64.h **** 	return 0;
1349:lib_AT91SAM7S64.h **** }
1350:lib_AT91SAM7S64.h **** 
1351:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1352:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTSetPrescaler()
1353:lib_AT91SAM7S64.h **** //* \brief  Set the new prescaler value
1354:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1355:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTSetPrescaler(
1356:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, 
1357:lib_AT91SAM7S64.h ****         unsigned int rtpres)
1358:lib_AT91SAM7S64.h **** {
1359:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~0xFFFF;	
1360:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= (rtpres & 0xFFFF);	
1361:lib_AT91SAM7S64.h **** 	return (pRTTC->RTTC_RTMR);
1362:lib_AT91SAM7S64.h **** }
1363:lib_AT91SAM7S64.h **** 
1364:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1365:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTRestart()
1366:lib_AT91SAM7S64.h **** //* \brief  Restart the RTT prescaler
1367:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1368:lib_AT91SAM7S64.h **** __inline void AT91F_RTTRestart(
1369:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1370:lib_AT91SAM7S64.h **** {
1371:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTRST;	
1372:lib_AT91SAM7S64.h **** }
1373:lib_AT91SAM7S64.h **** 
1374:lib_AT91SAM7S64.h **** 
1375:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1376:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmINT()
1377:lib_AT91SAM7S64.h **** //* \brief  Enable RTT Alarm Interrupt
1378:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1379:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmINT(
1380:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1381:lib_AT91SAM7S64.h **** {
1382:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_ALMIEN;
1383:lib_AT91SAM7S64.h **** }
1384:lib_AT91SAM7S64.h **** 
1385:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1386:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearAlarmINT()
1387:lib_AT91SAM7S64.h **** //* \brief  Disable RTT Alarm Interrupt
1388:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1389:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearAlarmINT(
1390:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1391:lib_AT91SAM7S64.h **** {
1392:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_ALMIEN;
1393:lib_AT91SAM7S64.h **** }
1394:lib_AT91SAM7S64.h **** 
1395:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1396:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetRttIncINT()
1397:lib_AT91SAM7S64.h **** //* \brief  Enable RTT INC Interrupt
1398:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1399:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetRttIncINT(
1400:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1401:lib_AT91SAM7S64.h **** {
1402:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR |= AT91C_RTTC_RTTINCIEN;
1403:lib_AT91SAM7S64.h **** }
1404:lib_AT91SAM7S64.h **** 
1405:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1406:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ClearRttIncINT()
1407:lib_AT91SAM7S64.h **** //* \brief  Disable RTT INC Interrupt
1408:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1409:lib_AT91SAM7S64.h **** __inline void AT91F_RTTClearRttIncINT(
1410:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1411:lib_AT91SAM7S64.h **** {
1412:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTMR &= ~AT91C_RTTC_RTTINCIEN;
1413:lib_AT91SAM7S64.h **** }
1414:lib_AT91SAM7S64.h **** 
1415:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1416:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_SetAlarmValue()
1417:lib_AT91SAM7S64.h **** //* \brief  Set RTT Alarm Value
1418:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1419:lib_AT91SAM7S64.h **** __inline void AT91F_RTTSetAlarmValue(
1420:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC, unsigned int alarm)
1421:lib_AT91SAM7S64.h **** {
1422:lib_AT91SAM7S64.h **** 	pRTTC->RTTC_RTAR = alarm;
1423:lib_AT91SAM7S64.h **** }
1424:lib_AT91SAM7S64.h **** 
1425:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1426:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_GetAlarmValue()
1427:lib_AT91SAM7S64.h **** //* \brief  Get RTT Alarm Value
1428:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1429:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetAlarmValue(
1430:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1431:lib_AT91SAM7S64.h **** {
1432:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTAR);
1433:lib_AT91SAM7S64.h **** }
1434:lib_AT91SAM7S64.h **** 
1435:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1436:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTTGetStatus()
1437:lib_AT91SAM7S64.h **** //* \brief  Read the RTT status
1438:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1439:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTGetStatus(
1440:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1441:lib_AT91SAM7S64.h **** {
1442:lib_AT91SAM7S64.h **** 	return(pRTTC->RTTC_RTSR);
1443:lib_AT91SAM7S64.h **** }
1444:lib_AT91SAM7S64.h **** 
1445:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1446:lib_AT91SAM7S64.h **** //* \fn     AT91F_RTT_ReadValue()
1447:lib_AT91SAM7S64.h **** //* \brief  Read the RTT value
1448:lib_AT91SAM7S64.h **** //*--------------------------------------------------------------------------------------
1449:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_RTTReadValue(
1450:lib_AT91SAM7S64.h ****         AT91PS_RTTC pRTTC)
1451:lib_AT91SAM7S64.h **** {
1452:lib_AT91SAM7S64.h ****         register volatile unsigned int val1,val2;
1453:lib_AT91SAM7S64.h **** 	do
1454:lib_AT91SAM7S64.h **** 	{
1455:lib_AT91SAM7S64.h **** 		val1 = pRTTC->RTTC_RTVR;
1456:lib_AT91SAM7S64.h **** 		val2 = pRTTC->RTTC_RTVR;
1457:lib_AT91SAM7S64.h **** 	}	
1458:lib_AT91SAM7S64.h **** 	while(val1 != val2);
1459:lib_AT91SAM7S64.h **** 	return(val1);
1460:lib_AT91SAM7S64.h **** }
1461:lib_AT91SAM7S64.h **** /* *****************************************************************************
1462:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PITC
1463:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1464:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1465:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITInit
1466:lib_AT91SAM7S64.h **** //* \brief System timer init : period in second, system clock freq in MHz
1467:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1468:lib_AT91SAM7S64.h **** __inline void AT91F_PITInit(
1469:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1470:lib_AT91SAM7S64.h ****         unsigned int period,
1471:lib_AT91SAM7S64.h ****         unsigned int pit_frequency)
1472:lib_AT91SAM7S64.h **** {
1473:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = period? (period * pit_frequency + 8) >> 4 : 0; // +8 to avoid %10 and /10
1474:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITEN;	 
1475:lib_AT91SAM7S64.h **** }
1476:lib_AT91SAM7S64.h **** 
1477:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1478:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITSetPIV
1479:lib_AT91SAM7S64.h **** //* \brief Set the PIT Periodic Interval Value 
1480:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1481:lib_AT91SAM7S64.h **** __inline void AT91F_PITSetPIV(
1482:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC,
1483:lib_AT91SAM7S64.h ****         unsigned int piv)
1484:lib_AT91SAM7S64.h **** {
1485:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR = piv | (pPITC->PITC_PIMR & (AT91C_PITC_PITEN | AT91C_PITC_PITIEN));
1486:lib_AT91SAM7S64.h **** }
1487:lib_AT91SAM7S64.h **** 
1488:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1489:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITEnableInt
1490:lib_AT91SAM7S64.h **** //* \brief Enable PIT periodic interrupt
1491:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1492:lib_AT91SAM7S64.h **** __inline void AT91F_PITEnableInt(
1493:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1494:lib_AT91SAM7S64.h **** {
1495:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR |= AT91C_PITC_PITIEN;	 
1496:lib_AT91SAM7S64.h **** }
1497:lib_AT91SAM7S64.h **** 
1498:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1499:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITDisableInt
1500:lib_AT91SAM7S64.h **** //* \brief Disable PIT periodic interrupt
1501:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1502:lib_AT91SAM7S64.h **** __inline void AT91F_PITDisableInt(
1503:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1504:lib_AT91SAM7S64.h **** {
1505:lib_AT91SAM7S64.h **** 	pPITC->PITC_PIMR &= ~AT91C_PITC_PITIEN;	 
1506:lib_AT91SAM7S64.h **** }
1507:lib_AT91SAM7S64.h **** 
1508:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1509:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetMode
1510:lib_AT91SAM7S64.h **** //* \brief Read PIT mode register
1511:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1512:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetMode(
1513:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1514:lib_AT91SAM7S64.h **** {
1515:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIMR);
1516:lib_AT91SAM7S64.h **** }
1517:lib_AT91SAM7S64.h **** 
1518:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1519:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetStatus
1520:lib_AT91SAM7S64.h **** //* \brief Read PIT status register
1521:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1522:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetStatus(
1523:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1524:lib_AT91SAM7S64.h **** {
1525:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PISR);
1526:lib_AT91SAM7S64.h **** }
1527:lib_AT91SAM7S64.h **** 
1528:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1529:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIIR
1530:lib_AT91SAM7S64.h **** //* \brief Read PIT CPIV and PICNT without ressetting the counters
1531:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1532:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIIR(
1533:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1534:lib_AT91SAM7S64.h **** {
1535:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIIR);
1536:lib_AT91SAM7S64.h **** }
1537:lib_AT91SAM7S64.h **** 
1538:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1539:lib_AT91SAM7S64.h **** //* \fn    AT91F_PITGetPIVR
1540:lib_AT91SAM7S64.h **** //* \brief Read System timer CPIV and PICNT without ressetting the counters
1541:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1542:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PITGetPIVR(
1543:lib_AT91SAM7S64.h ****         AT91PS_PITC pPITC)
1544:lib_AT91SAM7S64.h **** {
1545:lib_AT91SAM7S64.h **** 	return(pPITC->PITC_PIVR);
1546:lib_AT91SAM7S64.h **** }
1547:lib_AT91SAM7S64.h **** /* *****************************************************************************
1548:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR WDTC
1549:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1550:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1551:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSetMode
1552:lib_AT91SAM7S64.h **** //* \brief Set Watchdog Mode Register
1553:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1554:lib_AT91SAM7S64.h **** __inline void AT91F_WDTSetMode(
1555:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC,
1556:lib_AT91SAM7S64.h ****         unsigned int Mode)
1557:lib_AT91SAM7S64.h **** {
1558:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDMR = Mode;
1559:lib_AT91SAM7S64.h **** }
1560:lib_AT91SAM7S64.h **** 
1561:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1562:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTRestart
1563:lib_AT91SAM7S64.h **** //* \brief Restart Watchdog
1564:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1565:lib_AT91SAM7S64.h **** __inline void AT91F_WDTRestart(
1566:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1567:lib_AT91SAM7S64.h **** {
1568:lib_AT91SAM7S64.h **** 	pWDTC->WDTC_WDCR = 0xA5000001;
1569:lib_AT91SAM7S64.h **** }
1570:lib_AT91SAM7S64.h **** 
1571:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1572:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTSGettatus
1573:lib_AT91SAM7S64.h **** //* \brief Get Watchdog Status
1574:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1575:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTSGettatus(
1576:lib_AT91SAM7S64.h ****         AT91PS_WDTC pWDTC)
1577:lib_AT91SAM7S64.h **** {
1578:lib_AT91SAM7S64.h **** 	return(pWDTC->WDTC_WDSR & 0x3);
1579:lib_AT91SAM7S64.h **** }
1580:lib_AT91SAM7S64.h **** 
1581:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1582:lib_AT91SAM7S64.h **** //* \fn    AT91F_WDTGetPeriod
1583:lib_AT91SAM7S64.h **** //* \brief Translate ms into Watchdog Compatible value
1584:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1585:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_WDTGetPeriod(unsigned int ms)
1586:lib_AT91SAM7S64.h **** {
1587:lib_AT91SAM7S64.h **** 	if ((ms < 4) || (ms > 16000))
1588:lib_AT91SAM7S64.h **** 		return 0;
1589:lib_AT91SAM7S64.h **** 	return((ms << 8) / 1000);
1590:lib_AT91SAM7S64.h **** }
1591:lib_AT91SAM7S64.h **** /* *****************************************************************************
1592:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR VREG
1593:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1594:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1595:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Enable_LowPowerMode
1596:lib_AT91SAM7S64.h **** //* \brief Enable VREG Low Power Mode
1597:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1598:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Enable_LowPowerMode(
1599:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1600:lib_AT91SAM7S64.h **** {
1601:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR |= AT91C_VREG_PSTDBY;	 
1602:lib_AT91SAM7S64.h **** }
1603:lib_AT91SAM7S64.h **** 
1604:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1605:lib_AT91SAM7S64.h **** //* \fn    AT91F_VREG_Disable_LowPowerMode
1606:lib_AT91SAM7S64.h **** //* \brief Disable VREG Low Power Mode
1607:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1608:lib_AT91SAM7S64.h **** __inline void AT91F_VREG_Disable_LowPowerMode(
1609:lib_AT91SAM7S64.h ****         AT91PS_VREG pVREG)
1610:lib_AT91SAM7S64.h **** {
1611:lib_AT91SAM7S64.h **** 	pVREG->VREG_MR &= ~AT91C_VREG_PSTDBY;	 
1612:lib_AT91SAM7S64.h **** }/* *****************************************************************************
1613:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR MC
1614:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1615:lib_AT91SAM7S64.h **** 
1616:lib_AT91SAM7S64.h **** #define AT91C_MC_CORRECT_KEY  ((unsigned int) 0x5A << 24) // (MC) Correct Protect Key
1617:lib_AT91SAM7S64.h **** 
1618:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1619:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_Remap
1620:lib_AT91SAM7S64.h **** //* \brief Make Remap
1621:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1622:lib_AT91SAM7S64.h **** __inline void AT91F_MC_Remap (void)     //  
1623:lib_AT91SAM7S64.h **** {
1624:lib_AT91SAM7S64.h ****     AT91PS_MC pMC = (AT91PS_MC) AT91C_BASE_MC;
1625:lib_AT91SAM7S64.h ****     
1626:lib_AT91SAM7S64.h ****     pMC->MC_RCR = AT91C_MC_RCB;
1627:lib_AT91SAM7S64.h **** }
1628:lib_AT91SAM7S64.h **** 
1629:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1630:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_CfgModeReg
1631:lib_AT91SAM7S64.h **** //* \brief Configure the EFC Mode Register of the MC controller
1632:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1633:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_CfgModeReg (
1634:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1635:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
1636:lib_AT91SAM7S64.h **** {
1637:lib_AT91SAM7S64.h **** 	// Write to the FMR register
1638:lib_AT91SAM7S64.h **** 	pMC->MC_FMR = mode;
1639:lib_AT91SAM7S64.h **** }
1640:lib_AT91SAM7S64.h **** 
1641:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1642:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetModeReg
1643:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1644:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1645:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetModeReg(
1646:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1647:lib_AT91SAM7S64.h **** {
1648:lib_AT91SAM7S64.h **** 	return pMC->MC_FMR;
1649:lib_AT91SAM7S64.h **** }
1650:lib_AT91SAM7S64.h **** 
1651:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1652:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_ComputeFMCN
1653:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Mode Regsiter
1654:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1655:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_ComputeFMCN(
1656:lib_AT91SAM7S64.h **** 	int master_clock) // master clock in Hz
1657:lib_AT91SAM7S64.h **** {
1658:lib_AT91SAM7S64.h **** 	return (master_clock/1000000 +2);
1659:lib_AT91SAM7S64.h **** }
1660:lib_AT91SAM7S64.h **** 
1661:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1662:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_PerformCmd
1663:lib_AT91SAM7S64.h **** //* \brief Perform EFC Command
1664:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1665:lib_AT91SAM7S64.h **** __inline void AT91F_MC_EFC_PerformCmd (
1666:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC, // pointer to a MC controller
1667:lib_AT91SAM7S64.h ****     unsigned int transfer_cmd)
1668:lib_AT91SAM7S64.h **** {
1669:lib_AT91SAM7S64.h **** 	pMC->MC_FCR = transfer_cmd;	
1670:lib_AT91SAM7S64.h **** }
1671:lib_AT91SAM7S64.h **** 
1672:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1673:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_GetStatus
1674:lib_AT91SAM7S64.h **** //* \brief Return MC EFC Status
1675:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1676:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_GetStatus(
1677:lib_AT91SAM7S64.h **** 	AT91PS_MC pMC) // pointer to a MC controller
1678:lib_AT91SAM7S64.h **** {
1679:lib_AT91SAM7S64.h **** 	return pMC->MC_FSR;
1680:lib_AT91SAM7S64.h **** }
1681:lib_AT91SAM7S64.h **** 
1682:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1683:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptMasked
1684:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Masked 
1685:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1686:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptMasked(
1687:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1688:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1689:lib_AT91SAM7S64.h **** {
1690:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetModeReg(pMC) & flag);
1691:lib_AT91SAM7S64.h **** }
1692:lib_AT91SAM7S64.h **** 
1693:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1694:lib_AT91SAM7S64.h **** //* \fn    AT91F_MC_EFC_IsInterruptSet
1695:lib_AT91SAM7S64.h **** //* \brief Test if EFC MC Interrupt is Set
1696:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1697:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_MC_EFC_IsInterruptSet(
1698:lib_AT91SAM7S64.h ****         AT91PS_MC pMC,   // \arg  pointer to a MC controller
1699:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1700:lib_AT91SAM7S64.h **** {
1701:lib_AT91SAM7S64.h **** 	return (AT91F_MC_EFC_GetStatus(pMC) & flag);
1702:lib_AT91SAM7S64.h **** }
1703:lib_AT91SAM7S64.h **** 
1704:lib_AT91SAM7S64.h **** /* *****************************************************************************
1705:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SPI
1706:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1707:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1708:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Open
1709:lib_AT91SAM7S64.h **** //* \brief Open a SPI Port
1710:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1711:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_Open (
1712:lib_AT91SAM7S64.h ****         const unsigned int null)  // \arg
1713:lib_AT91SAM7S64.h **** {
1714:lib_AT91SAM7S64.h ****         /* NOT DEFINED AT THIS MOMENT */
1715:lib_AT91SAM7S64.h ****         return ( 0 );
1716:lib_AT91SAM7S64.h **** }
1717:lib_AT91SAM7S64.h **** 
1718:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1719:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgCs
1720:lib_AT91SAM7S64.h **** //* \brief Configure SPI chip select register
1721:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1722:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgCs (
1723:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1724:lib_AT91SAM7S64.h **** 	int cs,     // SPI cs number (0 to 3)
1725:lib_AT91SAM7S64.h ****  	int val)   //  chip select register
1726:lib_AT91SAM7S64.h **** {
1727:lib_AT91SAM7S64.h **** 	//* Write to the CSR register
1728:lib_AT91SAM7S64.h **** 	*(pSPI->SPI_CSR + cs) = val;
1729:lib_AT91SAM7S64.h **** }
1730:lib_AT91SAM7S64.h **** 
1731:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1732:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_EnableIt
1733:lib_AT91SAM7S64.h **** //* \brief Enable SPI interrupt
1734:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1735:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_EnableIt (
1736:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,     // pointer to a SPI controller
1737:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1738:lib_AT91SAM7S64.h **** {
1739:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1740:lib_AT91SAM7S64.h **** 	pSPI->SPI_IER = flag;
1741:lib_AT91SAM7S64.h **** }
1742:lib_AT91SAM7S64.h **** 
1743:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1744:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_DisableIt
1745:lib_AT91SAM7S64.h **** //* \brief Disable SPI interrupt
1746:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1747:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_DisableIt (
1748:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1749:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1750:lib_AT91SAM7S64.h **** {
1751:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1752:lib_AT91SAM7S64.h **** 	pSPI->SPI_IDR = flag;
1753:lib_AT91SAM7S64.h **** }
1754:lib_AT91SAM7S64.h **** 
1755:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1756:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Reset
1757:lib_AT91SAM7S64.h **** //* \brief Reset the SPI controller
1758:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1759:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Reset (
1760:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1761:lib_AT91SAM7S64.h **** 	)
1762:lib_AT91SAM7S64.h **** {
1763:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1764:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SWRST;
1765:lib_AT91SAM7S64.h **** }
1766:lib_AT91SAM7S64.h **** 
1767:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1768:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Enable
1769:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1770:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1771:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Enable (
1772:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1773:lib_AT91SAM7S64.h **** 	)
1774:lib_AT91SAM7S64.h **** {
1775:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1776:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIEN;
1777:lib_AT91SAM7S64.h **** }
1778:lib_AT91SAM7S64.h **** 
1779:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1780:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Disable
1781:lib_AT91SAM7S64.h **** //* \brief Disable the SPI controller
1782:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1783:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Disable (
1784:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI // pointer to a SPI controller
1785:lib_AT91SAM7S64.h **** 	)
1786:lib_AT91SAM7S64.h **** {
1787:lib_AT91SAM7S64.h **** 	//* Write to the CR register
1788:lib_AT91SAM7S64.h **** 	pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1789:lib_AT91SAM7S64.h **** }
1790:lib_AT91SAM7S64.h **** 
1791:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1792:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgMode
1793:lib_AT91SAM7S64.h **** //* \brief Enable the SPI controller
1794:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1795:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgMode (
1796:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1797:lib_AT91SAM7S64.h **** 	int mode)        // mode register 
1798:lib_AT91SAM7S64.h **** {
1799:lib_AT91SAM7S64.h **** 	//* Write to the MR register
1800:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR = mode;
1801:lib_AT91SAM7S64.h **** }
1802:lib_AT91SAM7S64.h **** 
1803:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1804:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_CfgPCS
1805:lib_AT91SAM7S64.h **** //* \brief Switch to the correct PCS of SPI Mode Register : Fixed Peripheral Selected
1806:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1807:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_CfgPCS (
1808:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI, // pointer to a SPI controller
1809:lib_AT91SAM7S64.h **** 	char PCS_Device) // PCS of the Device
1810:lib_AT91SAM7S64.h **** {	
1811:lib_AT91SAM7S64.h ****  	//* Write to the MR register
1812:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR &= 0xFFF0FFFF;
1813:lib_AT91SAM7S64.h **** 	pSPI->SPI_MR |= ( (PCS_Device<<16) & AT91C_SPI_PCS );
1814:lib_AT91SAM7S64.h **** }
1815:lib_AT91SAM7S64.h **** 
1816:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1817:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_ReceiveFrame
1818:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1819:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1820:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_ReceiveFrame (
1821:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1822:lib_AT91SAM7S64.h **** 	char *pBuffer,
1823:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1824:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1825:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1826:lib_AT91SAM7S64.h **** {
1827:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
1828:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1829:lib_AT91SAM7S64.h **** 		pBuffer,
1830:lib_AT91SAM7S64.h **** 		szBuffer,
1831:lib_AT91SAM7S64.h **** 		pNextBuffer,
1832:lib_AT91SAM7S64.h **** 		szNextBuffer);
1833:lib_AT91SAM7S64.h **** }
1834:lib_AT91SAM7S64.h **** 
1835:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1836:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_SendFrame
1837:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
1838:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1839:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_SendFrame(
1840:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1841:lib_AT91SAM7S64.h **** 	char *pBuffer,
1842:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
1843:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
1844:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
1845:lib_AT91SAM7S64.h **** {
1846:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
1847:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSPI->SPI_RPR),
1848:lib_AT91SAM7S64.h **** 		pBuffer,
1849:lib_AT91SAM7S64.h **** 		szBuffer,
1850:lib_AT91SAM7S64.h **** 		pNextBuffer,
1851:lib_AT91SAM7S64.h **** 		szNextBuffer);
1852:lib_AT91SAM7S64.h **** }
1853:lib_AT91SAM7S64.h **** 
1854:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1855:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_Close
1856:lib_AT91SAM7S64.h **** //* \brief Close SPI: disable IT disable transfert, close PDC
1857:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1858:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_Close (
1859:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI)     // \arg pointer to a SPI controller
1860:lib_AT91SAM7S64.h **** {
1861:lib_AT91SAM7S64.h ****     //* Reset all the Chip Select register
1862:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[0] = 0 ;
1863:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[1] = 0 ;
1864:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[2] = 0 ;
1865:lib_AT91SAM7S64.h ****     pSPI->SPI_CSR[3] = 0 ;
1866:lib_AT91SAM7S64.h **** 
1867:lib_AT91SAM7S64.h ****     //* Reset the SPI mode
1868:lib_AT91SAM7S64.h ****     pSPI->SPI_MR = 0  ;
1869:lib_AT91SAM7S64.h **** 
1870:lib_AT91SAM7S64.h ****     //* Disable all interrupts
1871:lib_AT91SAM7S64.h ****     pSPI->SPI_IDR = 0xFFFFFFFF ;
1872:lib_AT91SAM7S64.h **** 
1873:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
1874:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pSPI->SPI_RPR));
1875:lib_AT91SAM7S64.h **** 
1876:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
1877:lib_AT91SAM7S64.h ****     pSPI->SPI_CR = AT91C_SPI_SPIDIS;
1878:lib_AT91SAM7S64.h **** }
1879:lib_AT91SAM7S64.h **** 
1880:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1881:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_PutChar
1882:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
1883:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1884:lib_AT91SAM7S64.h **** __inline void AT91F_SPI_PutChar (
1885:lib_AT91SAM7S64.h **** 	AT91PS_SPI pSPI,
1886:lib_AT91SAM7S64.h **** 	unsigned int character,
1887:lib_AT91SAM7S64.h ****              unsigned int cs_number )
1888:lib_AT91SAM7S64.h **** {
1889:lib_AT91SAM7S64.h ****     unsigned int value_for_cs;
1890:lib_AT91SAM7S64.h ****     value_for_cs = (~(1 << cs_number)) & 0xF;  //Place a zero among a 4 ONEs number
1891:lib_AT91SAM7S64.h ****     pSPI->SPI_TDR = (character & 0xFFFF) | (value_for_cs << 16);
1892:lib_AT91SAM7S64.h **** }
1893:lib_AT91SAM7S64.h **** 
1894:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1895:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetChar
1896:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
1897:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1898:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_GetChar (
1899:lib_AT91SAM7S64.h **** 	const AT91PS_SPI pSPI)
1900:lib_AT91SAM7S64.h **** {
1901:lib_AT91SAM7S64.h ****     return((pSPI->SPI_RDR) & 0xFFFF);
1902:lib_AT91SAM7S64.h **** }
1903:lib_AT91SAM7S64.h **** 
1904:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1905:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_GetInterruptMaskStatus
1906:lib_AT91SAM7S64.h **** //* \brief Return SPI Interrupt Mask Status
1907:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1908:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SPI_GetInterruptMaskStatus( // \return SPI Interrupt Mask Status
1909:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi) // \arg  pointer to a SPI controller
1910:lib_AT91SAM7S64.h **** {
1911:lib_AT91SAM7S64.h ****         return pSpi->SPI_IMR;
1912:lib_AT91SAM7S64.h **** }
1913:lib_AT91SAM7S64.h **** 
1914:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1915:lib_AT91SAM7S64.h **** //* \fn    AT91F_SPI_IsInterruptMasked
1916:lib_AT91SAM7S64.h **** //* \brief Test if SPI Interrupt is Masked 
1917:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1918:lib_AT91SAM7S64.h **** __inline int AT91F_SPI_IsInterruptMasked(
1919:lib_AT91SAM7S64.h ****         AT91PS_SPI pSpi,   // \arg  pointer to a SPI controller
1920:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1921:lib_AT91SAM7S64.h **** {
1922:lib_AT91SAM7S64.h ****         return (AT91F_SPI_GetInterruptMaskStatus(pSpi) & flag);
1923:lib_AT91SAM7S64.h **** }
1924:lib_AT91SAM7S64.h **** 
1925:lib_AT91SAM7S64.h **** /* *****************************************************************************
1926:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR ADC
1927:lib_AT91SAM7S64.h ****    ***************************************************************************** */
1928:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1929:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableIt
1930:lib_AT91SAM7S64.h **** //* \brief Enable ADC interrupt
1931:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1932:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableIt (
1933:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC,     // pointer to a ADC controller
1934:lib_AT91SAM7S64.h **** 	unsigned int flag)   // IT to be enabled
1935:lib_AT91SAM7S64.h **** {
1936:lib_AT91SAM7S64.h **** 	//* Write to the IER register
1937:lib_AT91SAM7S64.h **** 	pADC->ADC_IER = flag;
1938:lib_AT91SAM7S64.h **** }
1939:lib_AT91SAM7S64.h **** 
1940:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1941:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableIt
1942:lib_AT91SAM7S64.h **** //* \brief Disable ADC interrupt
1943:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1944:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableIt (
1945:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
1946:lib_AT91SAM7S64.h **** 	unsigned int flag) // IT to be disabled
1947:lib_AT91SAM7S64.h **** {
1948:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
1949:lib_AT91SAM7S64.h **** 	pADC->ADC_IDR = flag;
1950:lib_AT91SAM7S64.h **** }
1951:lib_AT91SAM7S64.h **** 
1952:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1953:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetStatus
1954:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Status
1955:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1956:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetStatus( // \return ADC Interrupt Status
1957:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1958:lib_AT91SAM7S64.h **** {
1959:lib_AT91SAM7S64.h **** 	return pADC->ADC_SR;
1960:lib_AT91SAM7S64.h **** }
1961:lib_AT91SAM7S64.h **** 
1962:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1963:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetInterruptMaskStatus
1964:lib_AT91SAM7S64.h **** //* \brief Return ADC Interrupt Mask Status
1965:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1966:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetInterruptMaskStatus( // \return ADC Interrupt Mask Status
1967:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC) // pointer to a ADC controller
1968:lib_AT91SAM7S64.h **** {
1969:lib_AT91SAM7S64.h **** 	return pADC->ADC_IMR;
1970:lib_AT91SAM7S64.h **** }
1971:lib_AT91SAM7S64.h **** 
1972:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1973:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsInterruptMasked
1974:lib_AT91SAM7S64.h **** //* \brief Test if ADC Interrupt is Masked 
1975:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1976:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsInterruptMasked(
1977:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
1978:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1979:lib_AT91SAM7S64.h **** {
1980:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetInterruptMaskStatus(pADC) & flag);
1981:lib_AT91SAM7S64.h **** }
1982:lib_AT91SAM7S64.h **** 
1983:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1984:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_IsStatusSet
1985:lib_AT91SAM7S64.h **** //* \brief Test if ADC Status is Set
1986:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1987:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_IsStatusSet(
1988:lib_AT91SAM7S64.h ****         AT91PS_ADC pADC,   // \arg  pointer to a ADC controller
1989:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
1990:lib_AT91SAM7S64.h **** {
1991:lib_AT91SAM7S64.h **** 	return (AT91F_ADC_GetStatus(pADC) & flag);
1992:lib_AT91SAM7S64.h **** }
1993:lib_AT91SAM7S64.h **** 
1994:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1995:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgModeReg
1996:lib_AT91SAM7S64.h **** //* \brief Configure the Mode Register of the ADC controller
1997:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
1998:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgModeReg (
1999:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2000:lib_AT91SAM7S64.h **** 	unsigned int mode)        // mode register 
2001:lib_AT91SAM7S64.h **** {
2002:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2003:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = mode;
2004:lib_AT91SAM7S64.h **** }
2005:lib_AT91SAM7S64.h **** 
2006:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2007:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetModeReg
2008:lib_AT91SAM7S64.h **** //* \brief Return the Mode Register of the ADC controller value
2009:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2010:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetModeReg (
2011:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2012:lib_AT91SAM7S64.h **** 	)
2013:lib_AT91SAM7S64.h **** {
2014:lib_AT91SAM7S64.h **** 	return pADC->ADC_MR;	
2015:lib_AT91SAM7S64.h **** }
2016:lib_AT91SAM7S64.h **** 
2017:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2018:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_CfgTimings
2019:lib_AT91SAM7S64.h **** //* \brief Configure the different necessary timings of the ADC controller
2020:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2021:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_CfgTimings (
2022:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2023:lib_AT91SAM7S64.h **** 	unsigned int mck_clock, // in MHz 
2024:lib_AT91SAM7S64.h **** 	unsigned int adc_clock, // in MHz 
2025:lib_AT91SAM7S64.h **** 	unsigned int startup_time, // in us 
2026:lib_AT91SAM7S64.h **** 	unsigned int sample_and_hold_time)	// in ns  
2027:lib_AT91SAM7S64.h **** {
2028:lib_AT91SAM7S64.h **** 	unsigned int prescal,startup,shtim;
2029:lib_AT91SAM7S64.h **** 	
2030:lib_AT91SAM7S64.h **** 	prescal = mck_clock/(2*adc_clock) - 1;
2031:lib_AT91SAM7S64.h **** 	startup = adc_clock*startup_time/8 - 1;
2032:lib_AT91SAM7S64.h **** 	shtim = adc_clock*sample_and_hold_time/1000 - 1;
2033:lib_AT91SAM7S64.h **** 	
2034:lib_AT91SAM7S64.h **** 	//* Write to the MR register
2035:lib_AT91SAM7S64.h **** 	pADC->ADC_MR = ( (prescal<<8) & AT91C_ADC_PRESCAL) | ( (startup<<16) & AT91C_ADC_STARTUP) | ( (sht
2036:lib_AT91SAM7S64.h **** }
2037:lib_AT91SAM7S64.h **** 
2038:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2039:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_EnableChannel
2040:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2041:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2042:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_EnableChannel (
2043:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2044:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2045:lib_AT91SAM7S64.h **** {
2046:lib_AT91SAM7S64.h **** 	//* Write to the CHER register
2047:lib_AT91SAM7S64.h **** 	pADC->ADC_CHER = channel;
2048:lib_AT91SAM7S64.h **** }
2049:lib_AT91SAM7S64.h **** 
2050:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2051:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_DisableChannel
2052:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2053:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2054:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_DisableChannel (
2055:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC, // pointer to a ADC controller
2056:lib_AT91SAM7S64.h **** 	unsigned int channel)        // mode register 
2057:lib_AT91SAM7S64.h **** {
2058:lib_AT91SAM7S64.h **** 	//* Write to the CHDR register
2059:lib_AT91SAM7S64.h **** 	pADC->ADC_CHDR = channel;
2060:lib_AT91SAM7S64.h **** }
2061:lib_AT91SAM7S64.h **** 
2062:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2063:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetChannelStatus
2064:lib_AT91SAM7S64.h **** //* \brief Return ADC Timer Register Value
2065:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2066:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetChannelStatus (
2067:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2068:lib_AT91SAM7S64.h **** 	)
2069:lib_AT91SAM7S64.h **** {
2070:lib_AT91SAM7S64.h **** 	return pADC->ADC_CHSR;	
2071:lib_AT91SAM7S64.h **** }
2072:lib_AT91SAM7S64.h **** 
2073:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2074:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_StartConversion
2075:lib_AT91SAM7S64.h **** //* \brief Software request for a analog to digital conversion 
2076:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2077:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_StartConversion (
2078:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2079:lib_AT91SAM7S64.h **** 	)
2080:lib_AT91SAM7S64.h **** {
2081:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_START;	
2082:lib_AT91SAM7S64.h **** }
2083:lib_AT91SAM7S64.h **** 
2084:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2085:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_SoftReset
2086:lib_AT91SAM7S64.h **** //* \brief Software reset
2087:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2088:lib_AT91SAM7S64.h **** __inline void AT91F_ADC_SoftReset (
2089:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2090:lib_AT91SAM7S64.h **** 	)
2091:lib_AT91SAM7S64.h **** {
2092:lib_AT91SAM7S64.h **** 	pADC->ADC_CR = AT91C_ADC_SWRST;	
2093:lib_AT91SAM7S64.h **** }
2094:lib_AT91SAM7S64.h **** 
2095:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2096:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetLastConvertedData
2097:lib_AT91SAM7S64.h **** //* \brief Return the Last Converted Data
2098:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2099:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetLastConvertedData (
2100:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2101:lib_AT91SAM7S64.h **** 	)
2102:lib_AT91SAM7S64.h **** {
2103:lib_AT91SAM7S64.h **** 	return pADC->ADC_LCDR;	
2104:lib_AT91SAM7S64.h **** }
2105:lib_AT91SAM7S64.h **** 
2106:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2107:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH0
2108:lib_AT91SAM7S64.h **** //* \brief Return the Channel 0 Converted Data
2109:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2110:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH0 (
2111:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2112:lib_AT91SAM7S64.h **** 	)
2113:lib_AT91SAM7S64.h **** {
2114:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR0;	
2115:lib_AT91SAM7S64.h **** }
2116:lib_AT91SAM7S64.h **** 
2117:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2118:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH1
2119:lib_AT91SAM7S64.h **** //* \brief Return the Channel 1 Converted Data
2120:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2121:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH1 (
2122:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2123:lib_AT91SAM7S64.h **** 	)
2124:lib_AT91SAM7S64.h **** {
2125:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR1;	
2126:lib_AT91SAM7S64.h **** }
2127:lib_AT91SAM7S64.h **** 
2128:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2129:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH2
2130:lib_AT91SAM7S64.h **** //* \brief Return the Channel 2 Converted Data
2131:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2132:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH2 (
2133:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2134:lib_AT91SAM7S64.h **** 	)
2135:lib_AT91SAM7S64.h **** {
2136:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR2;	
2137:lib_AT91SAM7S64.h **** }
2138:lib_AT91SAM7S64.h **** 
2139:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2140:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH3
2141:lib_AT91SAM7S64.h **** //* \brief Return the Channel 3 Converted Data
2142:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2143:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH3 (
2144:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2145:lib_AT91SAM7S64.h **** 	)
2146:lib_AT91SAM7S64.h **** {
2147:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR3;	
2148:lib_AT91SAM7S64.h **** }
2149:lib_AT91SAM7S64.h **** 
2150:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2151:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH4
2152:lib_AT91SAM7S64.h **** //* \brief Return the Channel 4 Converted Data
2153:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2154:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH4 (
2155:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2156:lib_AT91SAM7S64.h **** 	)
2157:lib_AT91SAM7S64.h **** {
2158:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR4;	
2159:lib_AT91SAM7S64.h **** }
2160:lib_AT91SAM7S64.h **** 
2161:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2162:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH5
2163:lib_AT91SAM7S64.h **** //* \brief Return the Channel 5 Converted Data
2164:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2165:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH5 (
2166:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2167:lib_AT91SAM7S64.h **** 	)
2168:lib_AT91SAM7S64.h **** {
2169:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR5;	
2170:lib_AT91SAM7S64.h **** }
2171:lib_AT91SAM7S64.h **** 
2172:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2173:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH6
2174:lib_AT91SAM7S64.h **** //* \brief Return the Channel 6 Converted Data
2175:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2176:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH6 (
2177:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2178:lib_AT91SAM7S64.h **** 	)
2179:lib_AT91SAM7S64.h **** {
2180:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR6;	
2181:lib_AT91SAM7S64.h **** }
2182:lib_AT91SAM7S64.h **** 
2183:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2184:lib_AT91SAM7S64.h **** //* \fn    AT91F_ADC_GetConvertedDataCH7
2185:lib_AT91SAM7S64.h **** //* \brief Return the Channel 7 Converted Data
2186:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2187:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_ADC_GetConvertedDataCH7 (
2188:lib_AT91SAM7S64.h **** 	AT91PS_ADC pADC // pointer to a ADC controller
2189:lib_AT91SAM7S64.h **** 	)
2190:lib_AT91SAM7S64.h **** {
2191:lib_AT91SAM7S64.h **** 	return pADC->ADC_CDR7;	
2192:lib_AT91SAM7S64.h **** }
2193:lib_AT91SAM7S64.h **** 
2194:lib_AT91SAM7S64.h **** /* *****************************************************************************
2195:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR SSC
2196:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2197:lib_AT91SAM7S64.h **** //* Define the standard I2S mode configuration
2198:lib_AT91SAM7S64.h **** 
2199:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Clock Mode Register
2200:lib_AT91SAM7S64.h **** //* Parameters :  nb_bit_by_slot : 8, 16 or 32 bits
2201:lib_AT91SAM7S64.h **** //* 			  nb_slot_by_frame : number of channels
2202:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_MASTER_TX_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2203:lib_AT91SAM7S64.h **** 									   AT91C_SSC_CKS_DIV   +\
2204:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKO_CONTINOUS      +\
2205:lib_AT91SAM7S64.h ****                             		   AT91C_SSC_CKG_NONE    +\
2206:lib_AT91SAM7S64.h ****                                        AT91C_SSC_START_FALL_RF +\
2207:lib_AT91SAM7S64.h ****                            			   AT91C_SSC_STTOUT  +\
2208:lib_AT91SAM7S64.h ****                             		   ((1<<16) & AT91C_SSC_STTDLY) +\
2209:lib_AT91SAM7S64.h ****                             		   ((((nb_bit_by_slot*nb_slot_by_frame)/2)-1) <<24))
2210:lib_AT91SAM7S64.h **** 
2211:lib_AT91SAM7S64.h **** 
2212:lib_AT91SAM7S64.h **** //* Configuration to set in the SSC Transmit Frame Mode Register
2213:lib_AT91SAM7S64.h **** //* Parameters : nb_bit_by_slot : 8, 16 or 32 bits
2214:lib_AT91SAM7S64.h **** //* 			 nb_slot_by_frame : number of channels
2215:lib_AT91SAM7S64.h **** #define AT91C_I2S_ASY_TX_FRAME_SETTING(nb_bit_by_slot, nb_slot_by_frame)( +\
2216:lib_AT91SAM7S64.h **** 									(nb_bit_by_slot-1)  +\
2217:lib_AT91SAM7S64.h ****                             		AT91C_SSC_MSBF   +\
2218:lib_AT91SAM7S64.h ****                             		(((nb_slot_by_frame-1)<<8) & AT91C_SSC_DATNB)  +\
2219:lib_AT91SAM7S64.h ****                             		(((nb_bit_by_slot-1)<<16) & AT91C_SSC_FSLEN) +\
2220:lib_AT91SAM7S64.h ****                             		AT91C_SSC_FSOS_NEGATIVE)
2221:lib_AT91SAM7S64.h **** 
2222:lib_AT91SAM7S64.h **** 
2223:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2224:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SetBaudrate
2225:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2226:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2227:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_SetBaudrate (
2228:lib_AT91SAM7S64.h ****         AT91PS_SSC pSSC,        // \arg pointer to a SSC controller
2229:lib_AT91SAM7S64.h ****         unsigned int mainClock, // \arg peripheral clock
2230:lib_AT91SAM7S64.h ****         unsigned int speed)     // \arg SSC baudrate
2231:lib_AT91SAM7S64.h **** {
2232:lib_AT91SAM7S64.h ****         unsigned int baud_value;
2233:lib_AT91SAM7S64.h ****         //* Define the baud rate divisor register
2234:lib_AT91SAM7S64.h ****         if (speed == 0)
2235:lib_AT91SAM7S64.h ****            baud_value = 0;
2236:lib_AT91SAM7S64.h ****         else
2237:lib_AT91SAM7S64.h ****         {
2238:lib_AT91SAM7S64.h ****            baud_value = (unsigned int) (mainClock * 10)/(2*speed);
2239:lib_AT91SAM7S64.h ****            if ((baud_value % 10) >= 5)
2240:lib_AT91SAM7S64.h ****                   baud_value = (baud_value / 10) + 1;
2241:lib_AT91SAM7S64.h ****            else
2242:lib_AT91SAM7S64.h ****                   baud_value /= 10;
2243:lib_AT91SAM7S64.h ****         }
2244:lib_AT91SAM7S64.h **** 
2245:lib_AT91SAM7S64.h ****         pSSC->SSC_CMR = baud_value;
2246:lib_AT91SAM7S64.h **** }
2247:lib_AT91SAM7S64.h **** 
2248:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2249:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_Configure
2250:lib_AT91SAM7S64.h **** //* \brief Configure SSC
2251:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2252:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_Configure (
2253:lib_AT91SAM7S64.h ****              AT91PS_SSC pSSC,          // \arg pointer to a SSC controller
2254:lib_AT91SAM7S64.h ****              unsigned int syst_clock,  // \arg System Clock Frequency
2255:lib_AT91SAM7S64.h ****              unsigned int baud_rate,   // \arg Expected Baud Rate Frequency
2256:lib_AT91SAM7S64.h ****              unsigned int clock_rx,    // \arg Receiver Clock Parameters
2257:lib_AT91SAM7S64.h ****              unsigned int mode_rx,     // \arg mode Register to be programmed
2258:lib_AT91SAM7S64.h ****              unsigned int clock_tx,    // \arg Transmitter Clock Parameters
2259:lib_AT91SAM7S64.h ****              unsigned int mode_tx)     // \arg mode Register to be programmed
2260:lib_AT91SAM7S64.h **** {
2261:lib_AT91SAM7S64.h ****     //* Disable interrupts
2262:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = (unsigned int) -1;
2263:lib_AT91SAM7S64.h **** 
2264:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2265:lib_AT91SAM7S64.h **** 	pSSC->SSC_CR = AT91C_SSC_SWRST | AT91C_SSC_RXDIS | AT91C_SSC_TXDIS ;
2266:lib_AT91SAM7S64.h **** 
2267:lib_AT91SAM7S64.h ****     //* Define the Clock Mode Register
2268:lib_AT91SAM7S64.h **** 	AT91F_SSC_SetBaudrate(pSSC, syst_clock, baud_rate);
2269:lib_AT91SAM7S64.h **** 
2270:lib_AT91SAM7S64.h ****      //* Write the Receive Clock Mode Register
2271:lib_AT91SAM7S64.h **** 	pSSC->SSC_RCMR =  clock_rx;
2272:lib_AT91SAM7S64.h **** 
2273:lib_AT91SAM7S64.h ****      //* Write the Transmit Clock Mode Register
2274:lib_AT91SAM7S64.h **** 	pSSC->SSC_TCMR =  clock_tx;
2275:lib_AT91SAM7S64.h **** 
2276:lib_AT91SAM7S64.h ****      //* Write the Receive Frame Mode Register
2277:lib_AT91SAM7S64.h **** 	pSSC->SSC_RFMR =  mode_rx;
2278:lib_AT91SAM7S64.h **** 
2279:lib_AT91SAM7S64.h ****      //* Write the Transmit Frame Mode Register
2280:lib_AT91SAM7S64.h **** 	pSSC->SSC_TFMR =  mode_tx;
2281:lib_AT91SAM7S64.h **** 
2282:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2283:lib_AT91SAM7S64.h **** 	AT91F_PDC_Open((AT91PS_PDC) &(pSSC->SSC_RPR));
2284:lib_AT91SAM7S64.h **** 
2285:lib_AT91SAM7S64.h **** 
2286:lib_AT91SAM7S64.h **** }
2287:lib_AT91SAM7S64.h **** 
2288:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2289:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableRx
2290:lib_AT91SAM7S64.h **** //* \brief Enable receiving datas
2291:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2292:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableRx (
2293:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2294:lib_AT91SAM7S64.h **** {
2295:lib_AT91SAM7S64.h ****     //* Enable receiver
2296:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXEN;
2297:lib_AT91SAM7S64.h **** }
2298:lib_AT91SAM7S64.h **** 
2299:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2300:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableRx
2301:lib_AT91SAM7S64.h **** //* \brief Disable receiving datas
2302:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2303:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableRx (
2304:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2305:lib_AT91SAM7S64.h **** {
2306:lib_AT91SAM7S64.h ****     //* Disable receiver
2307:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_RXDIS;
2308:lib_AT91SAM7S64.h **** }
2309:lib_AT91SAM7S64.h **** 
2310:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2311:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableTx
2312:lib_AT91SAM7S64.h **** //* \brief Enable sending datas
2313:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2314:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableTx (
2315:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2316:lib_AT91SAM7S64.h **** {
2317:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2318:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXEN;
2319:lib_AT91SAM7S64.h **** }
2320:lib_AT91SAM7S64.h **** 
2321:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2322:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableTx
2323:lib_AT91SAM7S64.h **** //* \brief Disable sending datas
2324:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2325:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableTx (
2326:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC)     // \arg pointer to a SSC controller
2327:lib_AT91SAM7S64.h **** {
2328:lib_AT91SAM7S64.h ****     //* Disable  transmitter
2329:lib_AT91SAM7S64.h ****     pSSC->SSC_CR = AT91C_SSC_TXDIS;
2330:lib_AT91SAM7S64.h **** }
2331:lib_AT91SAM7S64.h **** 
2332:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2333:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_EnableIt
2334:lib_AT91SAM7S64.h **** //* \brief Enable SSC IT
2335:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2336:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_EnableIt (
2337:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2338:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2339:lib_AT91SAM7S64.h **** {
2340:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2341:lib_AT91SAM7S64.h **** 	pSSC->SSC_IER = flag;
2342:lib_AT91SAM7S64.h **** }
2343:lib_AT91SAM7S64.h **** 
2344:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2345:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_DisableIt
2346:lib_AT91SAM7S64.h **** //* \brief Disable SSC IT
2347:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2348:lib_AT91SAM7S64.h **** __inline void AT91F_SSC_DisableIt (
2349:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC, // \arg pointer to a SSC controller
2350:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2351:lib_AT91SAM7S64.h **** {
2352:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
2353:lib_AT91SAM7S64.h **** 	pSSC->SSC_IDR = flag;
2354:lib_AT91SAM7S64.h **** }
2355:lib_AT91SAM7S64.h **** 
2356:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2357:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_ReceiveFrame
2358:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2359:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2360:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_ReceiveFrame (
2361:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2362:lib_AT91SAM7S64.h **** 	char *pBuffer,
2363:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2364:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2365:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2366:lib_AT91SAM7S64.h **** {
2367:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
2368:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2369:lib_AT91SAM7S64.h **** 		pBuffer,
2370:lib_AT91SAM7S64.h **** 		szBuffer,
2371:lib_AT91SAM7S64.h **** 		pNextBuffer,
2372:lib_AT91SAM7S64.h **** 		szNextBuffer);
2373:lib_AT91SAM7S64.h **** }
2374:lib_AT91SAM7S64.h **** 
2375:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2376:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_SendFrame
2377:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2378:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2379:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_SendFrame(
2380:lib_AT91SAM7S64.h **** 	AT91PS_SSC pSSC,
2381:lib_AT91SAM7S64.h **** 	char *pBuffer,
2382:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2383:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2384:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2385:lib_AT91SAM7S64.h **** {
2386:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
2387:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pSSC->SSC_RPR),
2388:lib_AT91SAM7S64.h **** 		pBuffer,
2389:lib_AT91SAM7S64.h **** 		szBuffer,
2390:lib_AT91SAM7S64.h **** 		pNextBuffer,
2391:lib_AT91SAM7S64.h **** 		szNextBuffer);
2392:lib_AT91SAM7S64.h **** }
2393:lib_AT91SAM7S64.h **** 
2394:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2395:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_GetInterruptMaskStatus
2396:lib_AT91SAM7S64.h **** //* \brief Return SSC Interrupt Mask Status
2397:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2398:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_SSC_GetInterruptMaskStatus( // \return SSC Interrupt Mask Status
2399:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc) // \arg  pointer to a SSC controller
2400:lib_AT91SAM7S64.h **** {
2401:lib_AT91SAM7S64.h ****         return pSsc->SSC_IMR;
2402:lib_AT91SAM7S64.h **** }
2403:lib_AT91SAM7S64.h **** 
2404:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2405:lib_AT91SAM7S64.h **** //* \fn    AT91F_SSC_IsInterruptMasked
2406:lib_AT91SAM7S64.h **** //* \brief Test if SSC Interrupt is Masked 
2407:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2408:lib_AT91SAM7S64.h **** __inline int AT91F_SSC_IsInterruptMasked(
2409:lib_AT91SAM7S64.h ****         AT91PS_SSC pSsc,   // \arg  pointer to a SSC controller
2410:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2411:lib_AT91SAM7S64.h **** {
2412:lib_AT91SAM7S64.h ****         return (AT91F_SSC_GetInterruptMaskStatus(pSsc) & flag);
2413:lib_AT91SAM7S64.h **** }
2414:lib_AT91SAM7S64.h **** 
2415:lib_AT91SAM7S64.h **** /* *****************************************************************************
2416:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR USART
2417:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2418:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2419:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2420:lib_AT91SAM7S64.h **** //* \brief Calculate the baudrate
2421:lib_AT91SAM7S64.h **** //* Standard Asynchronous Mode : 8 bits , 1 stop , no parity
2422:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_MODE ( AT91C_US_USMODE_NORMAL + \
2423:lib_AT91SAM7S64.h ****                         AT91C_US_NBSTOP_1_BIT + \
2424:lib_AT91SAM7S64.h ****                         AT91C_US_PAR_NONE + \
2425:lib_AT91SAM7S64.h ****                         AT91C_US_CHRL_8_BITS + \
2426:lib_AT91SAM7S64.h ****                         AT91C_US_CLKS_CLOCK )
2427:lib_AT91SAM7S64.h **** 
2428:lib_AT91SAM7S64.h **** //* Standard External Asynchronous Mode : 8 bits , 1 stop , no parity
2429:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_SCK_MODE ( AT91C_US_USMODE_NORMAL + \
2430:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2431:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2432:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2433:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_EXT )
2434:lib_AT91SAM7S64.h **** 
2435:lib_AT91SAM7S64.h **** //* Standard Synchronous Mode : 8 bits , 1 stop , no parity
2436:lib_AT91SAM7S64.h **** #define AT91C_US_SYNC_MODE ( AT91C_US_SYNC + \
2437:lib_AT91SAM7S64.h ****                        AT91C_US_USMODE_NORMAL + \
2438:lib_AT91SAM7S64.h ****                        AT91C_US_NBSTOP_1_BIT + \
2439:lib_AT91SAM7S64.h ****                        AT91C_US_PAR_NONE + \
2440:lib_AT91SAM7S64.h ****                        AT91C_US_CHRL_8_BITS + \
2441:lib_AT91SAM7S64.h ****                        AT91C_US_CLKS_CLOCK )
2442:lib_AT91SAM7S64.h **** 
2443:lib_AT91SAM7S64.h **** //* SCK used Label
2444:lib_AT91SAM7S64.h **** #define AT91C_US_SCK_USED (AT91C_US_CKLO | AT91C_US_CLKS_EXT)
2445:lib_AT91SAM7S64.h **** 
2446:lib_AT91SAM7S64.h **** //* Standard ISO T=0 Mode : 8 bits , 1 stop , parity
2447:lib_AT91SAM7S64.h **** #define AT91C_US_ISO_READER_MODE ( AT91C_US_USMODE_ISO7816_0 + \
2448:lib_AT91SAM7S64.h **** 					   		 AT91C_US_CLKS_CLOCK +\
2449:lib_AT91SAM7S64.h ****                        		 AT91C_US_NBSTOP_1_BIT + \
2450:lib_AT91SAM7S64.h ****                        		 AT91C_US_PAR_EVEN + \
2451:lib_AT91SAM7S64.h ****                        		 AT91C_US_CHRL_8_BITS + \
2452:lib_AT91SAM7S64.h ****                        		 AT91C_US_CKLO +\
2453:lib_AT91SAM7S64.h ****                        		 AT91C_US_OVER)
2454:lib_AT91SAM7S64.h **** 
2455:lib_AT91SAM7S64.h **** //* Standard IRDA mode
2456:lib_AT91SAM7S64.h **** #define AT91C_US_ASYNC_IRDA_MODE (  AT91C_US_USMODE_IRDA + \
2457:lib_AT91SAM7S64.h ****                             AT91C_US_NBSTOP_1_BIT + \
2458:lib_AT91SAM7S64.h ****                             AT91C_US_PAR_NONE + \
2459:lib_AT91SAM7S64.h ****                             AT91C_US_CHRL_8_BITS + \
2460:lib_AT91SAM7S64.h ****                             AT91C_US_CLKS_CLOCK )
2461:lib_AT91SAM7S64.h **** 
2462:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2463:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Baudrate
2464:lib_AT91SAM7S64.h **** //* \brief Caluculate baud_value according to the main clock and the baud rate
2465:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2466:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Baudrate (
2467:lib_AT91SAM7S64.h **** 	const unsigned int main_clock, // \arg peripheral clock
2468:lib_AT91SAM7S64.h **** 	const unsigned int baud_rate)  // \arg UART baudrate
2469:lib_AT91SAM7S64.h **** {
2470:lib_AT91SAM7S64.h **** 	unsigned int baud_value = ((main_clock*10)/(baud_rate * 16));
2471:lib_AT91SAM7S64.h **** 	if ((baud_value % 10) >= 5)
2472:lib_AT91SAM7S64.h **** 		baud_value = (baud_value / 10) + 1;
2473:lib_AT91SAM7S64.h **** 	else
2474:lib_AT91SAM7S64.h **** 		baud_value /= 10;
2475:lib_AT91SAM7S64.h **** 	return baud_value;
2476:lib_AT91SAM7S64.h **** }
2477:lib_AT91SAM7S64.h **** 
2478:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2479:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetBaudrate
2480:lib_AT91SAM7S64.h **** //* \brief Set the baudrate according to the CPU clock
2481:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2482:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetBaudrate (
2483:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2484:lib_AT91SAM7S64.h **** 	unsigned int mainClock, // \arg peripheral clock
2485:lib_AT91SAM7S64.h **** 	unsigned int speed)     // \arg UART baudrate
2486:lib_AT91SAM7S64.h **** {
2487:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2488:lib_AT91SAM7S64.h **** 	pUSART->US_BRGR = AT91F_US_Baudrate(mainClock, speed);
2489:lib_AT91SAM7S64.h **** }
2490:lib_AT91SAM7S64.h **** 
2491:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2492:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetTimeguard
2493:lib_AT91SAM7S64.h **** //* \brief Set USART timeguard
2494:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2495:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetTimeguard (
2496:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,    // \arg pointer to a USART controller
2497:lib_AT91SAM7S64.h **** 	unsigned int timeguard) // \arg timeguard value
2498:lib_AT91SAM7S64.h **** {
2499:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2500:lib_AT91SAM7S64.h **** 	pUSART->US_TTGR = timeguard ;
2501:lib_AT91SAM7S64.h **** }
2502:lib_AT91SAM7S64.h **** 
2503:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2504:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableIt
2505:lib_AT91SAM7S64.h **** //* \brief Enable USART IT
2506:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2507:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableIt (
2508:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2509:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2510:lib_AT91SAM7S64.h **** {
2511:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2512:lib_AT91SAM7S64.h **** 	pUSART->US_IER = flag;
2513:lib_AT91SAM7S64.h **** }
2514:lib_AT91SAM7S64.h **** 
2515:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2516:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableIt
2517:lib_AT91SAM7S64.h **** //* \brief Disable USART IT
2518:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2519:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableIt (
2520:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART, // \arg pointer to a USART controller
2521:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2522:lib_AT91SAM7S64.h **** {
2523:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2524:lib_AT91SAM7S64.h **** 	pUSART->US_IDR = flag;
2525:lib_AT91SAM7S64.h **** }
2526:lib_AT91SAM7S64.h **** 
2527:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2528:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Configure
2529:lib_AT91SAM7S64.h **** //* \brief Configure USART
2530:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2531:lib_AT91SAM7S64.h **** __inline void AT91F_US_Configure (
2532:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,     // \arg pointer to a USART controller
2533:lib_AT91SAM7S64.h **** 	unsigned int mainClock,  // \arg peripheral clock
2534:lib_AT91SAM7S64.h **** 	unsigned int mode ,      // \arg mode Register to be programmed
2535:lib_AT91SAM7S64.h **** 	unsigned int baudRate ,  // \arg baudrate to be programmed
2536:lib_AT91SAM7S64.h **** 	unsigned int timeguard ) // \arg timeguard to be programmed
2537:lib_AT91SAM7S64.h **** {
2538:lib_AT91SAM7S64.h ****     //* Disable interrupts
2539:lib_AT91SAM7S64.h ****     pUSART->US_IDR = (unsigned int) -1;
2540:lib_AT91SAM7S64.h **** 
2541:lib_AT91SAM7S64.h ****     //* Reset receiver and transmitter
2542:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RSTRX | AT91C_US_RSTTX | AT91C_US_RXDIS | AT91C_US_TXDIS ;
2543:lib_AT91SAM7S64.h **** 
2544:lib_AT91SAM7S64.h **** 	//* Define the baud rate divisor register
2545:lib_AT91SAM7S64.h **** 	AT91F_US_SetBaudrate(pUSART, mainClock, baudRate);
2546:lib_AT91SAM7S64.h **** 
2547:lib_AT91SAM7S64.h **** 	//* Write the Timeguard Register
2548:lib_AT91SAM7S64.h **** 	AT91F_US_SetTimeguard(pUSART, timeguard);
2549:lib_AT91SAM7S64.h **** 
2550:lib_AT91SAM7S64.h ****     //* Clear Transmit and Receive Counters
2551:lib_AT91SAM7S64.h ****     AT91F_PDC_Open((AT91PS_PDC) &(pUSART->US_RPR));
2552:lib_AT91SAM7S64.h **** 
2553:lib_AT91SAM7S64.h ****     //* Define the USART mode
2554:lib_AT91SAM7S64.h ****     pUSART->US_MR = mode  ;
2555:lib_AT91SAM7S64.h **** 
2556:lib_AT91SAM7S64.h **** }
2557:lib_AT91SAM7S64.h **** 
2558:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2559:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableRx
2560:lib_AT91SAM7S64.h **** //* \brief Enable receiving characters
2561:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2562:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableRx (
2563:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2564:lib_AT91SAM7S64.h **** {
2565:lib_AT91SAM7S64.h ****     //* Enable receiver
2566:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2567:lib_AT91SAM7S64.h **** }
2568:lib_AT91SAM7S64.h **** 
2569:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2570:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_EnableTx
2571:lib_AT91SAM7S64.h **** //* \brief Enable sending characters
2572:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2573:lib_AT91SAM7S64.h **** __inline void AT91F_US_EnableTx (
2574:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2575:lib_AT91SAM7S64.h **** {
2576:lib_AT91SAM7S64.h ****     //* Enable  transmitter
2577:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2578:lib_AT91SAM7S64.h **** }
2579:lib_AT91SAM7S64.h **** 
2580:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2581:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetRx
2582:lib_AT91SAM7S64.h **** //* \brief Reset Receiver and re-enable it
2583:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2584:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetRx (
2585:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2586:lib_AT91SAM7S64.h **** {
2587:lib_AT91SAM7S64.h **** 	//* Reset receiver
2588:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTRX;
2589:lib_AT91SAM7S64.h ****     //* Re-Enable receiver
2590:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXEN;
2591:lib_AT91SAM7S64.h **** }
2592:lib_AT91SAM7S64.h **** 
2593:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2594:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ResetTx
2595:lib_AT91SAM7S64.h **** //* \brief Reset Transmitter and re-enable it
2596:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2597:lib_AT91SAM7S64.h **** __inline void AT91F_US_ResetTx (
2598:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2599:lib_AT91SAM7S64.h **** {
2600:lib_AT91SAM7S64.h **** 	//* Reset transmitter
2601:lib_AT91SAM7S64.h **** 	pUSART->US_CR = AT91C_US_RSTTX;
2602:lib_AT91SAM7S64.h ****     //* Enable transmitter
2603:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXEN;
2604:lib_AT91SAM7S64.h **** }
2605:lib_AT91SAM7S64.h **** 
2606:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2607:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableRx
2608:lib_AT91SAM7S64.h **** //* \brief Disable Receiver
2609:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2610:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableRx (
2611:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2612:lib_AT91SAM7S64.h **** {
2613:lib_AT91SAM7S64.h ****     //* Disable receiver
2614:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_RXDIS;
2615:lib_AT91SAM7S64.h **** }
2616:lib_AT91SAM7S64.h **** 
2617:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2618:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_DisableTx
2619:lib_AT91SAM7S64.h **** //* \brief Disable Transmitter
2620:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2621:lib_AT91SAM7S64.h **** __inline void AT91F_US_DisableTx (
2622:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2623:lib_AT91SAM7S64.h **** {
2624:lib_AT91SAM7S64.h ****     //* Disable transmitter
2625:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS;
2626:lib_AT91SAM7S64.h **** }
2627:lib_AT91SAM7S64.h **** 
2628:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2629:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Close
2630:lib_AT91SAM7S64.h **** //* \brief Close USART: disable IT disable receiver and transmitter, close PDC
2631:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2632:lib_AT91SAM7S64.h **** __inline void AT91F_US_Close (
2633:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART)     // \arg pointer to a USART controller
2634:lib_AT91SAM7S64.h **** {
2635:lib_AT91SAM7S64.h ****     //* Reset the baud rate divisor register
2636:lib_AT91SAM7S64.h ****     pUSART->US_BRGR = 0 ;
2637:lib_AT91SAM7S64.h **** 
2638:lib_AT91SAM7S64.h ****     //* Reset the USART mode
2639:lib_AT91SAM7S64.h ****     pUSART->US_MR = 0  ;
2640:lib_AT91SAM7S64.h **** 
2641:lib_AT91SAM7S64.h ****     //* Reset the Timeguard Register
2642:lib_AT91SAM7S64.h ****     pUSART->US_TTGR = 0;
2643:lib_AT91SAM7S64.h **** 
2644:lib_AT91SAM7S64.h ****     //* Disable all interrupts
2645:lib_AT91SAM7S64.h ****     pUSART->US_IDR = 0xFFFFFFFF ;
2646:lib_AT91SAM7S64.h **** 
2647:lib_AT91SAM7S64.h ****     //* Abort the Peripheral Data Transfers
2648:lib_AT91SAM7S64.h ****     AT91F_PDC_Close((AT91PS_PDC) &(pUSART->US_RPR));
2649:lib_AT91SAM7S64.h **** 
2650:lib_AT91SAM7S64.h ****     //* Disable receiver and transmitter and stop any activity immediately
2651:lib_AT91SAM7S64.h ****     pUSART->US_CR = AT91C_US_TXDIS | AT91C_US_RXDIS | AT91C_US_RSTTX | AT91C_US_RSTRX ;
2652:lib_AT91SAM7S64.h **** }
2653:lib_AT91SAM7S64.h **** 
2654:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2655:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_TxReady
2656:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be written in US_THR
2657:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2658:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_TxReady (
2659:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2660:lib_AT91SAM7S64.h **** {
2661:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_TXRDY);
2662:lib_AT91SAM7S64.h **** }
2663:lib_AT91SAM7S64.h **** 
2664:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2665:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_RxReady
2666:lib_AT91SAM7S64.h **** //* \brief Return 1 if a character can be read in US_RHR
2667:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2668:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_RxReady (
2669:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2670:lib_AT91SAM7S64.h **** {
2671:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR & AT91C_US_RXRDY);
2672:lib_AT91SAM7S64.h **** }
2673:lib_AT91SAM7S64.h **** 
2674:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2675:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_Error
2676:lib_AT91SAM7S64.h **** //* \brief Return the error flag
2677:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2678:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_Error (
2679:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART )     // \arg pointer to a USART controller
2680:lib_AT91SAM7S64.h **** {
2681:lib_AT91SAM7S64.h ****     return (pUSART->US_CSR &
2682:lib_AT91SAM7S64.h ****     	(AT91C_US_OVRE |  // Overrun error
2683:lib_AT91SAM7S64.h ****     	 AT91C_US_FRAME | // Framing error
2684:lib_AT91SAM7S64.h ****     	 AT91C_US_PARE));  // Parity error
2685:lib_AT91SAM7S64.h **** }
2686:lib_AT91SAM7S64.h **** 
2687:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2688:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_PutChar
2689:lib_AT91SAM7S64.h **** //* \brief Send a character,does not check if ready to send
2690:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2691:lib_AT91SAM7S64.h **** __inline void AT91F_US_PutChar (
2692:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2693:lib_AT91SAM7S64.h **** 	int character )
2694:lib_AT91SAM7S64.h **** {
2695:lib_AT91SAM7S64.h ****     pUSART->US_THR = (character & 0x1FF);
2696:lib_AT91SAM7S64.h **** }
2697:lib_AT91SAM7S64.h **** 
2698:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2699:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_GetChar
2700:lib_AT91SAM7S64.h **** //* \brief Receive a character,does not check if a character is available
2701:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2702:lib_AT91SAM7S64.h **** __inline int AT91F_US_GetChar (
2703:lib_AT91SAM7S64.h **** 	const AT91PS_USART pUSART)
2704:lib_AT91SAM7S64.h **** {
2705:lib_AT91SAM7S64.h ****     return((pUSART->US_RHR) & 0x1FF);
2706:lib_AT91SAM7S64.h **** }
2707:lib_AT91SAM7S64.h **** 
2708:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2709:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SendFrame
2710:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2711:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2712:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_SendFrame(
2713:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2714:lib_AT91SAM7S64.h **** 	char *pBuffer,
2715:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2716:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2717:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2718:lib_AT91SAM7S64.h **** {
2719:lib_AT91SAM7S64.h **** 	return AT91F_PDC_SendFrame(
2720:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pUSART->US_RPR),
2721:lib_AT91SAM7S64.h **** 		pBuffer,
2722:lib_AT91SAM7S64.h **** 		szBuffer,
2723:lib_AT91SAM7S64.h **** 		pNextBuffer,
2724:lib_AT91SAM7S64.h **** 		szNextBuffer);
2725:lib_AT91SAM7S64.h **** }
2726:lib_AT91SAM7S64.h **** 
2727:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2728:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_ReceiveFrame
2729:lib_AT91SAM7S64.h **** //* \brief Return 2 if PDC has been initialized with Buffer and Next Buffer, 1 if PDC has been init
2730:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2731:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_US_ReceiveFrame (
2732:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2733:lib_AT91SAM7S64.h **** 	char *pBuffer,
2734:lib_AT91SAM7S64.h **** 	unsigned int szBuffer,
2735:lib_AT91SAM7S64.h **** 	char *pNextBuffer,
2736:lib_AT91SAM7S64.h **** 	unsigned int szNextBuffer )
2737:lib_AT91SAM7S64.h **** {
2738:lib_AT91SAM7S64.h **** 	return AT91F_PDC_ReceiveFrame(
2739:lib_AT91SAM7S64.h **** 		(AT91PS_PDC) &(pUSART->US_RPR),
2740:lib_AT91SAM7S64.h **** 		pBuffer,
2741:lib_AT91SAM7S64.h **** 		szBuffer,
2742:lib_AT91SAM7S64.h **** 		pNextBuffer,
2743:lib_AT91SAM7S64.h **** 		szNextBuffer);
2744:lib_AT91SAM7S64.h **** }
2745:lib_AT91SAM7S64.h **** 
2746:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2747:lib_AT91SAM7S64.h **** //* \fn    AT91F_US_SetIrdaFilter
2748:lib_AT91SAM7S64.h **** //* \brief Set the value of IrDa filter tregister
2749:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2750:lib_AT91SAM7S64.h **** __inline void AT91F_US_SetIrdaFilter (
2751:lib_AT91SAM7S64.h **** 	AT91PS_USART pUSART,
2752:lib_AT91SAM7S64.h **** 	unsigned char value
2753:lib_AT91SAM7S64.h **** )
2754:lib_AT91SAM7S64.h **** {
2755:lib_AT91SAM7S64.h **** 	pUSART->US_IF = value;
2756:lib_AT91SAM7S64.h **** }
2757:lib_AT91SAM7S64.h **** 
2758:lib_AT91SAM7S64.h **** /* *****************************************************************************
2759:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR TWI
2760:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2761:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2762:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_EnableIt
2763:lib_AT91SAM7S64.h **** //* \brief Enable TWI IT
2764:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2765:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_EnableIt (
2766:lib_AT91SAM7S64.h **** 	AT91PS_TWI pTWI, // \arg pointer to a TWI controller
2767:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be enabled
2768:lib_AT91SAM7S64.h **** {
2769:lib_AT91SAM7S64.h **** 	//* Write to the IER register
2770:lib_AT91SAM7S64.h **** 	pTWI->TWI_IER = flag;
2771:lib_AT91SAM7S64.h **** }
2772:lib_AT91SAM7S64.h **** 
2773:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2774:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_DisableIt
2775:lib_AT91SAM7S64.h **** //* \brief Disable TWI IT
2776:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2777:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_DisableIt (
2778:lib_AT91SAM7S64.h **** 	AT91PS_TWI pTWI, // \arg pointer to a TWI controller
2779:lib_AT91SAM7S64.h **** 	unsigned int flag)   // \arg IT to be disabled
2780:lib_AT91SAM7S64.h **** {
2781:lib_AT91SAM7S64.h **** 	//* Write to the IDR register
2782:lib_AT91SAM7S64.h **** 	pTWI->TWI_IDR = flag;
2783:lib_AT91SAM7S64.h **** }
2784:lib_AT91SAM7S64.h **** 
2785:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2786:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_Configure
2787:lib_AT91SAM7S64.h **** //* \brief Configure TWI in master mode
2788:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2789:lib_AT91SAM7S64.h **** __inline void AT91F_TWI_Configure ( AT91PS_TWI pTWI )          // \arg pointer to a TWI controller
2790:lib_AT91SAM7S64.h **** {
2791:lib_AT91SAM7S64.h ****     //* Disable interrupts
2792:lib_AT91SAM7S64.h **** 	pTWI->TWI_IDR = (unsigned int) -1;
2793:lib_AT91SAM7S64.h **** 
2794:lib_AT91SAM7S64.h ****     //* Reset peripheral
2795:lib_AT91SAM7S64.h **** 	pTWI->TWI_CR = AT91C_TWI_SWRST;
2796:lib_AT91SAM7S64.h **** 
2797:lib_AT91SAM7S64.h **** 	//* Set Master mode
2798:lib_AT91SAM7S64.h **** 	pTWI->TWI_CR = AT91C_TWI_MSEN;
2799:lib_AT91SAM7S64.h **** 
2800:lib_AT91SAM7S64.h **** }
2801:lib_AT91SAM7S64.h **** 
2802:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2803:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_GetInterruptMaskStatus
2804:lib_AT91SAM7S64.h **** //* \brief Return TWI Interrupt Mask Status
2805:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2806:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_TWI_GetInterruptMaskStatus( // \return TWI Interrupt Mask Status
2807:lib_AT91SAM7S64.h ****         AT91PS_TWI pTwi) // \arg  pointer to a TWI controller
2808:lib_AT91SAM7S64.h **** {
2809:lib_AT91SAM7S64.h ****         return pTwi->TWI_IMR;
2810:lib_AT91SAM7S64.h **** }
2811:lib_AT91SAM7S64.h **** 
2812:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2813:lib_AT91SAM7S64.h **** //* \fn    AT91F_TWI_IsInterruptMasked
2814:lib_AT91SAM7S64.h **** //* \brief Test if TWI Interrupt is Masked 
2815:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2816:lib_AT91SAM7S64.h **** __inline int AT91F_TWI_IsInterruptMasked(
2817:lib_AT91SAM7S64.h ****         AT91PS_TWI pTwi,   // \arg  pointer to a TWI controller
2818:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2819:lib_AT91SAM7S64.h **** {
2820:lib_AT91SAM7S64.h ****         return (AT91F_TWI_GetInterruptMaskStatus(pTwi) & flag);
2821:lib_AT91SAM7S64.h **** }
2822:lib_AT91SAM7S64.h **** 
2823:lib_AT91SAM7S64.h **** /* *****************************************************************************
2824:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR TC
2825:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2826:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2827:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_InterruptEnable
2828:lib_AT91SAM7S64.h **** //* \brief Enable TC Interrupt
2829:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2830:lib_AT91SAM7S64.h **** __inline void AT91F_TC_InterruptEnable(
2831:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2832:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  TC interrupt to be enabled
2833:lib_AT91SAM7S64.h **** {
2834:lib_AT91SAM7S64.h ****         pTc->TC_IER = flag;
2835:lib_AT91SAM7S64.h **** }
2836:lib_AT91SAM7S64.h **** 
2837:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2838:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_InterruptDisable
2839:lib_AT91SAM7S64.h **** //* \brief Disable TC Interrupt
2840:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2841:lib_AT91SAM7S64.h **** __inline void AT91F_TC_InterruptDisable(
2842:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2843:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  TC interrupt to be disabled
2844:lib_AT91SAM7S64.h **** {
2845:lib_AT91SAM7S64.h ****         pTc->TC_IDR = flag;
2846:lib_AT91SAM7S64.h **** }
2847:lib_AT91SAM7S64.h **** 
2848:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2849:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_GetInterruptMaskStatus
2850:lib_AT91SAM7S64.h **** //* \brief Return TC Interrupt Mask Status
2851:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2852:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_TC_GetInterruptMaskStatus( // \return TC Interrupt Mask Status
2853:lib_AT91SAM7S64.h ****         AT91PS_TC pTc) // \arg  pointer to a TC controller
2854:lib_AT91SAM7S64.h **** {
2855:lib_AT91SAM7S64.h ****         return pTc->TC_IMR;
2856:lib_AT91SAM7S64.h **** }
2857:lib_AT91SAM7S64.h **** 
2858:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2859:lib_AT91SAM7S64.h **** //* \fn    AT91F_TC_IsInterruptMasked
2860:lib_AT91SAM7S64.h **** //* \brief Test if TC Interrupt is Masked 
2861:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2862:lib_AT91SAM7S64.h **** __inline int AT91F_TC_IsInterruptMasked(
2863:lib_AT91SAM7S64.h ****         AT91PS_TC pTc,   // \arg  pointer to a TC controller
2864:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2865:lib_AT91SAM7S64.h **** {
2866:lib_AT91SAM7S64.h ****         return (AT91F_TC_GetInterruptMaskStatus(pTc) & flag);
2867:lib_AT91SAM7S64.h **** }
2868:lib_AT91SAM7S64.h **** 
2869:lib_AT91SAM7S64.h **** /* *****************************************************************************
2870:lib_AT91SAM7S64.h ****                 SOFTWARE API FOR PWMC
2871:lib_AT91SAM7S64.h ****    ***************************************************************************** */
2872:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2873:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_GetStatus
2874:lib_AT91SAM7S64.h **** //* \brief Return PWM Interrupt Status
2875:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2876:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_GetStatus( // \return PWM Interrupt Status
2877:lib_AT91SAM7S64.h **** 	AT91PS_PWMC pPWM) // pointer to a PWM controller
2878:lib_AT91SAM7S64.h **** {
2879:lib_AT91SAM7S64.h **** 	return pPWM->PWMC_SR;
2880:lib_AT91SAM7S64.h **** }
2881:lib_AT91SAM7S64.h **** 
2882:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2883:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_InterruptEnable
2884:lib_AT91SAM7S64.h **** //* \brief Enable PWM Interrupt
2885:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2886:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_InterruptEnable(
2887:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm,   // \arg  pointer to a PWM controller
2888:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  PWM interrupt to be enabled
2889:lib_AT91SAM7S64.h **** {
2890:lib_AT91SAM7S64.h ****         pPwm->PWMC_IER = flag;
2891:lib_AT91SAM7S64.h **** }
2892:lib_AT91SAM7S64.h **** 
2893:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2894:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_InterruptDisable
2895:lib_AT91SAM7S64.h **** //* \brief Disable PWM Interrupt
2896:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2897:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_InterruptDisable(
2898:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm,   // \arg  pointer to a PWM controller
2899:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  PWM interrupt to be disabled
2900:lib_AT91SAM7S64.h **** {
2901:lib_AT91SAM7S64.h ****         pPwm->PWMC_IDR = flag;
2902:lib_AT91SAM7S64.h **** }
2903:lib_AT91SAM7S64.h **** 
2904:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2905:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_GetInterruptMaskStatus
2906:lib_AT91SAM7S64.h **** //* \brief Return PWM Interrupt Mask Status
2907:lib_AT91SAM7S64.h **** 
2908:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2909:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_GetInterruptMaskStatus( // \return PWM Interrupt Mask Status
2910:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPwm) // \arg  pointer to a PWM controller
2911:lib_AT91SAM7S64.h **** {
2912:lib_AT91SAM7S64.h ****         return pPwm->PWMC_IMR;
2913:lib_AT91SAM7S64.h **** }
2914:lib_AT91SAM7S64.h **** 
2915:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2916:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_IsInterruptMasked
2917:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Masked
2918:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2919:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_IsInterruptMasked(
2920:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2921:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2922:lib_AT91SAM7S64.h **** {
2923:lib_AT91SAM7S64.h **** 	return (AT91F_PWMC_GetInterruptMaskStatus(pPWM) & flag);
2924:lib_AT91SAM7S64.h **** }
2925:lib_AT91SAM7S64.h **** 
2926:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2927:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_IsStatusSet
2928:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Set
2929:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2930:lib_AT91SAM7S64.h **** __inline unsigned int AT91F_PWMC_IsStatusSet(
2931:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2932:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  flag to be tested
2933:lib_AT91SAM7S64.h **** {
2934:lib_AT91SAM7S64.h **** 	return (AT91F_PWMC_GetStatus(pPWM) & flag);
2935:lib_AT91SAM7S64.h **** }
2936:lib_AT91SAM7S64.h **** 
2937:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2938:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_CfgChannel
2939:lib_AT91SAM7S64.h **** //* \brief Test if PWM Interrupt is Set
2940:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2941:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_CfgChannel(
2942:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2943:lib_AT91SAM7S64.h ****         unsigned int channelId, // \arg PWM channel ID
2944:lib_AT91SAM7S64.h ****         unsigned int mode, // \arg  PWM mode
2945:lib_AT91SAM7S64.h ****         unsigned int period, // \arg PWM period
2946:lib_AT91SAM7S64.h ****         unsigned int duty) // \arg PWM duty cycle
2947:lib_AT91SAM7S64.h **** {
2948:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CMR = mode;
2949:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CDTYR = duty;
2950:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CPRDR = period;
2951:lib_AT91SAM7S64.h **** }
2952:lib_AT91SAM7S64.h **** 
2953:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2954:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_StartChannel
2955:lib_AT91SAM7S64.h **** //* \brief Enable channel
2956:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2957:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_StartChannel(
2958:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2959:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  Channels IDs to be enabled
2960:lib_AT91SAM7S64.h **** {
2961:lib_AT91SAM7S64.h **** 	pPWM->PWMC_ENA = flag;
2962:lib_AT91SAM7S64.h **** }
2963:lib_AT91SAM7S64.h **** 
2964:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2965:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_StopChannel
2966:lib_AT91SAM7S64.h **** //* \brief Disable channel
2967:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2968:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_StopChannel(
2969:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2970:lib_AT91SAM7S64.h ****         unsigned int flag) // \arg  Channels IDs to be enabled
2971:lib_AT91SAM7S64.h **** {
2972:lib_AT91SAM7S64.h **** 	pPWM->PWMC_DIS = flag;
 1369              		.loc 2 2972 0
 1370 0a58 28209FE5 		ldr	r2, .L109
 1371              	.LBE153:
 1372              	.LBE152:
 1373              	.LBB154:
 1374              	.LBB155:
 1375              		.loc 2 2948 0
 1376 0a5c 28309FE5 		ldr	r3, .L109+4
 1377              	.LBE155:
 1378              	.LBE154:
 1379              	.LBB156:
 1380              	.LBB157:
 1381              		.loc 2 2972 0
 1382 0a60 0110A0E3 		mov	r1, #1
 1383 0a64 F71002E5 		str	r1, [r2, #-247]
 1384              	.LBE157:
 1385              	.LBE156:
 1386              	.LBB158:
 1387              	.LBB159:
 1388              		.loc 2 2948 0
 1389 0a68 013182E5 		str	r3, [r2, #257]
 1390              		.loc 2 2950 0
 1391 0a6c 1C309FE5 		ldr	r3, .L109+8
 1392              		.loc 2 2949 0
 1393 0a70 050182E5 		str	r0, [r2, #261]
 1394              		.loc 2 2950 0
 1395 0a74 093182E5 		str	r3, [r2, #265]
 1396              	.LBE159:
 1397              	.LBE158:
 1398              	.LBB160:
 1399              	.LBB161:
2973:lib_AT91SAM7S64.h **** }
2974:lib_AT91SAM7S64.h **** 
2975:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2976:lib_AT91SAM7S64.h **** //* \fn    AT91F_PWM_UpdateChannel
2977:lib_AT91SAM7S64.h **** //* \brief Update Period or Duty Cycle
2978:lib_AT91SAM7S64.h **** //*----------------------------------------------------------------------------
2979:lib_AT91SAM7S64.h **** __inline void AT91F_PWMC_UpdateChannel(
2980:lib_AT91SAM7S64.h ****         AT91PS_PWMC pPWM,   // \arg  pointer to a PWM controller
2981:lib_AT91SAM7S64.h ****         unsigned int channelId, // \arg PWM channel ID
2982:lib_AT91SAM7S64.h ****         unsigned int update) // \arg  Channels IDs to be enabled
2983:lib_AT91SAM7S64.h **** {
2984:lib_AT91SAM7S64.h **** 	pPWM->PWMC_CH[channelId].PWMC_CUPDR = update;
 1400              		.loc 2 2984 0
 1401 0a78 0030A0E3 		mov	r3, #0
 1402 0a7c 313182E5 		str	r3, [r2, #305]
 1403              	.LBE161:
 1404              	.LBE160:
 1405              		.loc 1 181 0
 1406              		@ lr needed for prologue
 1407              	.LBB162:
 1408              	.LBB163:
 1409              		.loc 2 2961 0
 1410 0a80 FB1002E5 		str	r1, [r2, #-251]
 1411              	.LBE163:
 1412              	.LBE162:
 1413              		.loc 1 186 0
 1414 0a84 1EFF2FE1 		bx	lr
 1415              	.L110:
 1416              		.align	2
 1417              	.L109:
 1418 0a88 FFC0FCFF 		.word	-212737
 1419 0a8c 01020000 		.word	513
 1420 0a90 A0860100 		.word	100000
 1421              	.LFE293:
 1423              		.align	2
 1424              		.global	lowerDown
 1426              	lowerDown:
 1427              	.LFB295:
 1428              		.loc 1 197 0
 1429              		@ args = 0, pretend = 0, frame = 0
 1430              		@ frame_needed = 0, uses_anonymous_args = 0
 1431              	.LVL28:
 1432 0a94 04E02DE5 		str	lr, [sp, #-4]!
 1433              	.LCFI7:
 1434              		.loc 1 198 0
 1435 0a98 FEFFFFEB 		bl	setForce
 1436              	.LVL29:
 1437              		.loc 1 201 0
 1438 0a9c 1C309FE5 		ldr	r3, .L113
 1439 0aa0 0120A0E3 		mov	r2, #1
 1440 0aa4 002083E5 		str	r2, [r3, #0]
 1441              	.LBB168:
 1442              	.LBB169:
 1443              		.loc 2 609 0
 1444 0aa8 0B1CE0E3 		mvn	r1, #2816
 1445 0aac 8030A0E3 		mov	r3, #128
 1446 0ab0 CF3001E5 		str	r3, [r1, #-207]
 1447              	.LBE169:
 1448              	.LBE168:
 1449              	.LBB170:
 1450              	.LBB171:
 1451              		.loc 2 620 0
 1452 0ab4 4030A0E3 		mov	r3, #64
 1453 0ab8 CB3001E5 		str	r3, [r1, #-203]
 1454              	.LBE171:
 1455              	.LBE170:
 1456              		.loc 1 202 0
 1457 0abc 04F09DE4 		ldr	pc, [sp], #4
 1458              	.L114:
 1459              		.align	2
 1460              	.L113:
 1461 0ac0 00000000 		.word	direction
 1462              	.LFE295:
 1464              		.align	2
 1465              		.global	liftUp
 1467              	liftUp:
 1468              	.LFB294:
 1469              		.loc 1 189 0
 1470              		@ args = 0, pretend = 0, frame = 0
 1471              		@ frame_needed = 0, uses_anonymous_args = 0
 1472              	.LVL30:
 1473 0ac4 04E02DE5 		str	lr, [sp, #-4]!
 1474              	.LCFI8:
 1475              		.loc 1 190 0
 1476 0ac8 FEFFFFEB 		bl	setForce
 1477              	.LVL31:
 1478              		.loc 1 193 0
 1479 0acc 1C309FE5 		ldr	r3, .L117
 1480 0ad0 0020E0E3 		mvn	r2, #0
 1481 0ad4 002083E5 		str	r2, [r3, #0]
 1482              	.LBB176:
 1483              	.LBB177:
 1484              		.loc 2 609 0
 1485 0ad8 0B1CE0E3 		mvn	r1, #2816
 1486 0adc 4030A0E3 		mov	r3, #64
 1487 0ae0 CF3001E5 		str	r3, [r1, #-207]
 1488              	.LBE177:
 1489              	.LBE176:
 1490              	.LBB178:
 1491              	.LBB179:
 1492              		.loc 2 620 0
 1493 0ae4 033083E0 		add	r3, r3, r3
 1494 0ae8 CB3001E5 		str	r3, [r1, #-203]
 1495              	.LBE179:
 1496              	.LBE178:
 1497              		.loc 1 194 0
 1498 0aec 04F09DE4 		ldr	pc, [sp], #4
 1499              	.L118:
 1500              		.align	2
 1501              	.L117:
 1502 0af0 00000000 		.word	direction
 1503              	.LFE294:
 1505              		.align	2
 1506              		.global	AT91F_USB_Open
 1508              	AT91F_USB_Open:
 1509              	.LFB287:
 1510              		.loc 1 101 0
 1511              		@ args = 0, pretend = 0, frame = 0
 1512              		@ frame_needed = 0, uses_anonymous_args = 0
 1513              		.loc 1 103 0
 1514 0af4 032CE0E3 		mvn	r2, #768
 1515 0af8 D33012E5 		ldr	r3, [r2, #-211]
 1516              		.loc 1 101 0
 1517 0afc 04E02DE5 		str	lr, [sp, #-4]!
 1518              	.LCFI9:
 1519              		.loc 1 103 0
 1520 0b00 013283E3 		orr	r3, r3, #268435456
 1521 0b04 D33002E5 		str	r3, [r2, #-211]
 1522              		.loc 1 117 0
 1523 0b08 2C009FE5 		ldr	r0, .L121
 1524              		.loc 1 107 0
 1525 0b0c 8030A0E3 		mov	r3, #128
 1526              		.loc 1 117 0
 1527 0b10 28109FE5 		ldr	r1, .L121+4
 1528              		.loc 1 107 0
 1529 0b14 FF3002E5 		str	r3, [r2, #-255]
 1530              	.LBB184:
 1531              	.LBB185:
 1532              		.loc 2 508 0
 1533 0b18 0BECE0E3 		mvn	lr, #2816
 1534 0b1c 01C8A0E3 		mov	ip, #65536
 1535              	.LBE185:
 1536              	.LBE184:
 1537              		.loc 1 108 0
 1538 0b20 1E3D83E2 		add	r3, r3, #1920
 1539 0b24 EF3002E5 		str	r3, [r2, #-239]
 1540              	.LBB186:
 1541              	.LBB187:
 1542              		.loc 2 508 0
 1543 0b28 FFC00EE5 		str	ip, [lr, #-255]
 1544              		.loc 2 509 0
 1545 0b2c EFC00EE5 		str	ip, [lr, #-239]
 1546              	.LBE187:
 1547              	.LBE186:
 1548              	.LBB188:
 1549              	.LBB189:
 1550              		.loc 2 620 0
 1551 0b30 CBC00EE5 		str	ip, [lr, #-203]
 1552              	.LBE189:
 1553              	.LBE188:
 1554              		.loc 1 118 0
 1555 0b34 04E09DE4 		ldr	lr, [sp], #4
 1556              		.loc 1 117 0
 1557 0b38 FEFFFFEA 		b	AT91F_CDC_Open
 1558              	.L122:
 1559              		.align	2
 1560              	.L121:
 1561 0b3c 00000000 		.word	pCDC
 1562 0b40 0000FBFF 		.word	-327680
 1563              	.LFE287:
 1565              		.align	2
 1566              		.global	Init_PWM
 1568              	Init_PWM:
 1569              	.LFB286:
 1570              		.loc 1 83 0
 1571              		@ args = 0, pretend = 0, frame = 0
 1572              		@ frame_needed = 0, uses_anonymous_args = 0
 1573              	.LBB214:
 1574              	.LBB215:
 1575              		.loc 2 2901 0
 1576 0b44 74209FE5 		ldr	r2, .L125
 1577 0b48 0100A0E3 		mov	r0, #1
 1578              	.LBE215:
 1579              	.LBE214:
 1580              	.LBB216:
 1581              	.LBB217:
 1582              		.loc 2 1044 0
 1583 0b4c 03CCE0E3 		mvn	ip, #768
 1584 0b50 0430A0E3 		mov	r3, #4
 1585              	.LBE217:
 1586              	.LBE216:
 1587              	.LBB218:
 1588              	.LBB219:
 1589              		.loc 2 2901 0
 1590 0b54 EB0002E5 		str	r0, [r2, #-235]
 1591              	.LBE219:
 1592              	.LBE218:
 1593              	.LBB220:
 1594              	.LBB221:
 1595              		.loc 2 1044 0
 1596 0b58 EF300CE5 		str	r3, [ip, #-239]
 1597              	.LBE221:
 1598              	.LBE220:
 1599              	.LBB222:
 1600              	.LBB223:
 1601              	.LBB224:
 1602              	.LBB225:
 1603              		.loc 2 496 0
 1604 0b5c 60309FE5 		ldr	r3, .L125+4
 1605              		.loc 2 495 0
 1606 0b60 0B1CE0E3 		mvn	r1, #2816
 1607 0b64 8F0001E5 		str	r0, [r1, #-143]
 1608              		.loc 2 496 0
 1609 0b68 8B3001E5 		str	r3, [r1, #-139]
 1610              		.loc 2 497 0
 1611 0b6c 003083E0 		add	r3, r3, r0
 1612 0b70 FB3001E5 		str	r3, [r1, #-251]
 1613              	.LBE225:
 1614              	.LBE224:
 1615              	.LBE223:
 1616              	.LBE222:
 1617              	.LBB226:
 1618              	.LBB227:
 1619              	.LBB228:
 1620              	.LBB229:
 1621              		.loc 2 1044 0
 1622 0b74 013BA0E3 		mov	r3, #1024
 1623 0b78 EF300CE5 		str	r3, [ip, #-239]
 1624              	.LBE229:
 1625              	.LBE228:
 1626              	.LBE227:
 1627              	.LBE226:
 1628              	.LBB230:
 1629              	.LBB231:
 1630              		.loc 2 2948 0
 1631 0b7c 44309FE5 		ldr	r3, .L125+8
 1632              	.LBE231:
 1633              	.LBE230:
 1634              		.loc 1 83 0
 1635 0b80 10402DE9 		stmfd	sp!, {r4, lr}
 1636              	.LCFI10:
 1637              	.LBB232:
 1638              	.LBB233:
 1639              		.loc 2 2972 0
 1640 0b84 F70002E5 		str	r0, [r2, #-247]
 1641              	.LBE233:
 1642              	.LBE232:
 1643              	.LBB234:
 1644              	.LBB235:
 1645              		.loc 2 2948 0
 1646 0b88 013182E5 		str	r3, [r2, #257]
 1647              		.loc 2 2949 0
 1648 0b8c 38309FE5 		ldr	r3, .L125+12
 1649 0b90 053182E5 		str	r3, [r2, #261]
 1650              		.loc 2 2950 0
 1651 0b94 34309FE5 		ldr	r3, .L125+16
 1652              	.LBE235:
 1653              	.LBE234:
 1654              	.LBB236:
 1655              	.LBB237:
 1656              		.loc 2 2984 0
 1657 0b98 00E0A0E3 		mov	lr, #0
 1658              	.LBE237:
 1659              	.LBE236:
 1660              	.LBB238:
 1661              	.LBB239:
 1662              		.loc 2 496 0
 1663 0b9c 0245A0E3 		mov	r4, #8388608
 1664              	.LBE239:
 1665              	.LBE238:
 1666              	.LBB240:
 1667              	.LBB241:
 1668              		.loc 2 2950 0
 1669 0ba0 093182E5 		str	r3, [r2, #265]
 1670              	.LBE241:
 1671              	.LBE240:
 1672              	.LBB242:
 1673              	.LBB243:
 1674              		.loc 2 2984 0
 1675 0ba4 31E182E5 		str	lr, [r2, #305]
 1676              	.LBE243:
 1677              	.LBE242:
 1678              	.LBB244:
 1679              	.LBB245:
 1680              		.loc 2 2972 0
 1681 0ba8 F70002E5 		str	r0, [r2, #-247]
 1682              	.LBE245:
 1683              	.LBE244:
 1684              	.LBB246:
 1685              	.LBB247:
 1686              		.loc 2 495 0
 1687 0bac 8FE001E5 		str	lr, [r1, #-143]
 1688              		.loc 2 496 0
 1689 0bb0 8B4001E5 		str	r4, [r1, #-139]
 1690              		.loc 2 497 0
 1691 0bb4 FB4001E5 		str	r4, [r1, #-251]
 1692              	.LBE247:
 1693              	.LBE246:
 1694              	.LBB248:
 1695              	.LBB249:
 1696              		.loc 2 2961 0
 1697 0bb8 FB0002E5 		str	r0, [r2, #-251]
 1698              	.LBE249:
 1699              	.LBE248:
 1700              		.loc 1 94 0
 1701 0bbc 1080BDE8 		ldmfd	sp!, {r4, pc}
 1702              	.L126:
 1703              		.align	2
 1704              	.L125:
 1705 0bc0 FFC0FCFF 		.word	-212737
 1706 0bc4 00088000 		.word	8390656
 1707 0bc8 01020000 		.word	513
 1708 0bcc D0010100 		.word	66000
 1709 0bd0 A0860100 		.word	100000
 1710              	.LFE286:
 1712              		.align	2
 1713              		.global	setPosition
 1715              	setPosition:
 1716              	.LFB297:
 1717              		.loc 1 211 0
 1718              		@ args = 0, pretend = 0, frame = 0
 1719              		@ frame_needed = 0, uses_anonymous_args = 0
 1720              	.LVL32:
 1721 0bd4 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 1722              	.LCFI11:
 1723              		.loc 1 213 0
 1724 0bd8 64509FE5 		ldr	r5, .L135
 1725 0bdc 64609FE5 		ldr	r6, .L135+4
 1726              		.loc 1 211 0
 1727 0be0 0040A0E1 		mov	r4, r0
 1728              		.loc 1 212 0
 1729 0be4 FEFFFFEB 		bl	setForce
 1730              	.LVL33:
 1731              		.loc 1 213 0
 1732 0be8 001095E5 		ldr	r1, [r5, #0]
 1733 0bec 002096E5 		ldr	r2, [r6, #0]
 1734 0bf0 013062E0 		rsb	r3, r2, r1
 1735 0bf4 000053E3 		cmp	r3, #0
 1736 0bf8 003063B2 		rsblt	r3, r3, #0
 1737 0bfc 050053E3 		cmp	r3, #5
 1738              	.LBB256:
 1739              	.LBB257:
 1740              	.LBB258:
 1741              	.LBB259:
 1742              		.loc 2 620 0
 1743 0c00 0B0CE0E3 		mvn	r0, #2816
 1744              	.LBE259:
 1745              	.LBE258:
 1746              	.LBE257:
 1747              	.LBE256:
 1748              		.loc 1 213 0
 1749 0c04 0A0300DA 		ble	.L128
 1750              		.loc 1 215 0
 1751 0c08 020051E1 		cmp	r1, r2
 1752              		.loc 1 217 0
 1753 0c0c 0400A0E1 		mov	r0, r4
 1754              		.loc 1 215 0
 1755              	.LVL34:
 1756              		.loc 1 217 0
 1757 0c10 FEFFFFCB 		blgt	lowerDown
 1758              	.LVL35:
 1759              	.L130:
 1760              		.loc 1 219 0
 1761 0c14 002095E5 		ldr	r2, [r5, #0]
 1762 0c18 003096E5 		ldr	r3, [r6, #0]
 1763 0c1c 030052E1 		cmp	r2, r3
 1764              		.loc 1 221 0
 1765 0c20 0400A0E1 		mov	r0, r4
 1766              		.loc 1 219 0
 1767 0c24 7080BDA8 		ldmgefd	sp!, {r4, r5, r6, pc}
 1768              	.LVL36:
 1769              		.loc 1 228 0
 1770 0c28 7040BDE8 		ldmfd	sp!, {r4, r5, r6, lr}
 1771              		.loc 1 221 0
 1772 0c2c FEFFFFEA 		b	liftUp
 1773              	.LVL37:
 1774              	.L128:
 1775              	.LBB260:
 1776              	.LBB261:
 1777              	.LBB262:
 1778              	.LBB263:
 1779              		.loc 2 620 0
 1780 0c30 8030A0E3 		mov	r3, #128
 1781 0c34 CB3000E5 		str	r3, [r0, #-203]
 1782              	.LBE263:
 1783              	.LBE262:
 1784              	.LBB264:
 1785              	.LBB265:
 1786 0c38 4030A0E3 		mov	r3, #64
 1787 0c3c CB3000E5 		str	r3, [r0, #-203]
 1788 0c40 7080BDE8 		ldmfd	sp!, {r4, r5, r6, pc}
 1789              	.L136:
 1790              		.align	2
 1791              	.L135:
 1792 0c44 00000000 		.word	curPos
 1793 0c48 00000000 		.word	position
 1794              	.LBE265:
 1795              	.LBE264:
 1796              	.LBE261:
 1797              	.LBE260:
 1798              	.LFE297:
 1800              		.section	.rodata.str1.4
 1801 02d2 0000     		.align	2
 1802              	.LC45:
 1803 02d4 44494147 		.ascii	"DIAG#2#FAILED\015\012\000"
 1803      23322346 
 1803      41494C45 
 1803      440D0A00 
 1804              		.align	2
 1805              	.LC46:
 1806 02e4 44494147 		.ascii	"DIAG#2#DONE\015\012\000"
 1806      23322344 
 1806      4F4E450D 
 1806      0A00
 1807 02f2 0000     		.align	2
 1808              	.LC47:
 1809 02f4 44494147 		.ascii	"DIAG#3#FAILED\015\012\000"
 1809      23332346 
 1809      41494C45 
 1809      440D0A00 
 1810              		.align	2
 1811              	.LC48:
 1812 0304 44494147 		.ascii	"DIAG#4#FAILED\015\012\000"
 1812      23342346 
 1812      41494C45 
 1812      440D0A00 
 1813              		.align	2
 1814              	.LC49:
 1815 0314 50524553 		.ascii	"PRESSURE: %d\015\012\000"
 1815      53555245 
 1815      3A202564 
 1815      0D0A00
 1816 0323 00       		.align	2
 1817              	.LC50:
 1818 0324 504F5349 		.ascii	"POSITION: %d\015\012\000"
 1818      54494F4E 
 1818      3A202564 
 1818      0D0A00
 1819 0333 00       		.align	2
 1820              	.LC51:
 1821 0334 25647C25 		.ascii	"%d|%d|%d|\015\012\000"
 1821      647C2564 
 1821      7C0D0A00 
 1822              		.align	2
 1823              	.LC44:
 1824 0340 7E00     		.ascii	"~\000"
 1825 0342 0000     		.text
 1826              		.align	2
 1827              		.global	main
 1829              	main:
 1830              	.LFB300:
 491:main.c        **** 
 492:main.c        **** 
 493:main.c        **** //*--------------------------------------------------------------------------------------
 494:main.c        **** //* Function Name       : Main
 495:main.c        **** //* Object              : Software entry point
 496:main.c        **** //* Input Parameters    : none.
 497:main.c        **** //* Output Parameters   : none.
 498:main.c        **** //*--------------------------------------------------------------------------------------
 499:main.c        **** int main(void)
 500:main.c        **** {
 1831              		.loc 1 500 0
 1832              		@ args = 0, pretend = 0, frame = 1208
 1833              		@ frame_needed = 0, uses_anonymous_args = 0
 1834 0c4c 70402DE9 		stmfd	sp!, {r4, r5, r6, lr}
 1835              	.LCFI12:
 1836 0c50 4BDE4DE2 		sub	sp, sp, #1200
 1837              	.LCFI13:
 1838 0c54 0CD04DE2 		sub	sp, sp, #12
 1839              	.LCFI14:
 1840              	.LBB293:
 1841              	.LBB294:
 1842              		.loc 1 73 0
 1843 0c58 FF30E0E3 		mvn	r3, #255
 1844 0c5c B4348DE5 		str	r3, [sp, #1204]
 1845              	.LVL38:
 1846              		.loc 1 76 0
 1847 0c60 B4249DE5 		ldr	r2, [sp, #1204]
 1848 0c64 DC349FE5 		ldr	r3, .L205
 1849              	.LBE294:
 1850              	.LBE293:
 501:main.c        ****     char data[MSG_SIZE];
 502:main.c        ****     unsigned int length;
 503:main.c        ****     int stepCnt = 0;
 504:main.c        **** 
 505:main.c        ****     flashInit();
 506:main.c        **** 
 507:main.c        **** 
 508:main.c        ****     // Enable User Reset and set its minimal assertion to 960 us
 509:main.c        ****     AT91C_BASE_RSTC->RSTC_RMR = AT91C_RSTC_URSTEN | (0x4<<8) | (unsigned int)(0xA5<<24);
 1851              		.loc 1 509 0
 1852 0c68 DC149FE5 		ldr	r1, .L205+4
 1853              	.LBB295:
 1854              	.LBB296:
 1855              		.loc 1 76 0
 1856 0c6c 603082E5 		str	r3, [r2, #96]
 1857              	.LBE296:
 1858              	.LBE295:
 1859              		.loc 1 509 0
 1860 0c70 023CE0E3 		mvn	r3, #512
 1861 0c74 F71003E5 		str	r1, [r3, #-247]
 1862              	.LBB297:
 1863              	.LBB298:
 1864              		.loc 2 508 0
 1865 0c78 0B0CE0E3 		mvn	r0, #2816
 1866 0c7c F820A0E3 		mov	r2, #248
 1867              	.LBE298:
 1868              	.LBE297:
 1869              	.LBB299:
 1870              	.LBB300:
 1871              		.loc 2 1044 0
 1872 0c80 0410A0E3 		mov	r1, #4
 1873 0c84 033CE0E3 		mvn	r3, #768
 1874 0c88 EF1003E5 		str	r1, [r3, #-239]
 1875              	.LBE300:
 1876              	.LBE299:
 1877              	.LBB301:
 1878              	.LBB302:
 1879              		.loc 2 508 0
 1880 0c8c FF2000E5 		str	r2, [r0, #-255]
 1881              		.loc 2 509 0
 1882 0c90 EF2000E5 		str	r2, [r0, #-239]
 1883              	.LBE302:
 1884              	.LBE301:
 1885              	.LBB303:
 1886              	.LBB304:
 1887              		.loc 2 609 0
 1888 0c94 CF2000E5 		str	r2, [r0, #-207]
 1889              	.LBE304:
 1890              	.LBE303:
 1891              	.LBB305:
 1892              	.LBB306:
 1893              		.loc 2 620 0
 1894 0c98 CB2000E5 		str	r2, [r0, #-203]
 1895              	.LBE306:
 1896              	.LBE305:
 510:main.c        ****     // Led init
 511:main.c        ****     // First, enable the clock of the PIOB
 512:main.c        ****     AT91F_PMC_EnablePeriphClock ( AT91C_BASE_PMC, 1 << AT91C_ID_PIOA ) ;
 513:main.c        ****     //* to be outputs. No need to set these pins to be driven by the PIO because it is GPIO pins on
 514:main.c        ****     AT91F_PIO_CfgOutput( AT91C_BASE_PIOA, OUTPUT_MASK );
 515:main.c        ****     //* Clear the LED's.
 516:main.c        ****     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, OUTPUT_MASK );
 517:main.c        ****     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, OUTPUT_MASK );
 518:main.c        **** 
 519:main.c        ****     // Init USB device
 520:main.c        ****     AT91F_USB_Open();
 1897              		.loc 1 520 0
 1898 0c9c FEFFFFEB 		bl	AT91F_USB_Open
 1899              	.L138:
 521:main.c        ****     // Init USB device
 522:main.c        ****     // Wait for the end of enumeration
 523:main.c        ****     while (!pCDC.IsConfigured(&pCDC));
 1900              		.loc 1 523 0
 1901 0ca0 A8349FE5 		ldr	r3, .L205+8
 1902 0ca4 0300A0E1 		mov	r0, r3
 1903 0ca8 0FE0A0E1 		mov	lr, pc
 1904 0cac 0CF093E5 		ldr	pc, [r3, #12]
 1905 0cb0 000050E3 		cmp	r0, #0
 1906 0cb4 2603000A 		beq	.L138
 524:main.c        **** 
 525:main.c        ****     // Set Usart in interrupt
 526:main.c        ****     //Usart_init();
 527:main.c        **** 
 528:main.c        ****     //Read and set settings
 529:main.c        ****     memcpy(settings, OUR_FLASH_ADDR, 128);
 1907              		.loc 1 529 0
 1908 0cb8 8020A0E3 		mov	r2, #128
 1909 0cbc 90149FE5 		ldr	r1, .L205+12
 1910 0cc0 90049FE5 		ldr	r0, .L205+16
 1911 0cc4 FEFFFFEB 		bl	memcpy
 530:main.c        ****     int i;
 531:main.c        ****     int j;
 532:main.c        ****     char *settingsBlocks[50];
 533:main.c        ****     char settingsDelim[] = "~";
 1912              		.loc 1 533 0
 1913 0cc8 8C349FE5 		ldr	r3, .L205+20
 1914 0ccc 4B1E8DE2 		add	r1, sp, #1200
 1915 0cd0 B030D3E1 		ldrh	r3, [r3, #0]
 1916 0cd4 0C1081E2 		add	r1, r1, #12
 1917 0cd8 B23061E1 		strh	r3, [r1, #-2]!	@ movhi
 534:main.c        ****     char *settingsParts = strtok( settings, settingsDelim );
 1918              		.loc 1 534 0
 1919 0cdc 74049FE5 		ldr	r0, .L205+16
 1920 0ce0 FEFFFFEB 		bl	strtok
 1921 0ce4 0050A0E3 		mov	r5, #0
 1922              	.LVL39:
 1923 0ce8 0020A0E1 		mov	r2, r0
 1924              	.LVL40:
 1925 0cec 3F0300EA 		b	.L140
 1926              	.L141:
 535:main.c        ****     i = 0;
 536:main.c        ****     while( settingsParts != NULL )
 537:main.c        ****     {
 538:main.c        ****       settingsBlocks[i++] = settingsParts;
 1927              		.loc 1 538 0
 1928 0cf0 FB3F8DE2 		add	r3, sp, #1004
 1929 0cf4 052183E7 		str	r2, [r3, r5, asl #2]
 539:main.c        ****       settingsParts = strtok( NULL, settingsDelim );
 1930              		.loc 1 539 0
 1931 0cf8 FEFFFFEB 		bl	strtok
 1932              	.LVL41:
 1933              		.loc 1 538 0
 1934 0cfc 015085E2 		add	r5, r5, #1
 1935              		.loc 1 539 0
 1936 0d00 0020A0E1 		mov	r2, r0
 1937              	.LVL42:
 1938              	.L140:
 1939 0d04 0000A0E3 		mov	r0, #0
 1940 0d08 4B1E8DE2 		add	r1, sp, #1200
 1941              		.loc 1 536 0
 1942 0d0c 000052E1 		cmp	r2, r0
 1943              		.loc 1 539 0
 1944 0d10 0A1081E2 		add	r1, r1, #10
 1945              		.loc 1 536 0
 1946 0d14 3A03001A 		bne	.L141
 1947 0d18 0240A0E1 		mov	r4, r2
 1948              	.LVL43:
 1949 0d1c 4A0300EA 		b	.L143
 1950              	.L144:
 540:main.c        ****     }
 541:main.c        ****     for (j = 0; j < i; j++)
 542:main.c        ****     {
 543:main.c        ****        parseSettings(settingsBlocks[j]);
 1951              		.loc 1 543 0
 1952 0d20 FB3F8DE2 		add	r3, sp, #1004
 1953 0d24 040193E7 		ldr	r0, [r3, r4, asl #2]
 1954 0d28 FEFFFFEB 		bl	parseSettings
 1955              	.LVL44:
 1956              		.loc 1 541 0
 1957 0d2c 014084E2 		add	r4, r4, #1
 1958              	.LVL45:
 1959              	.L143:
 1960 0d30 050054E1 		cmp	r4, r5
 1961 0d34 460300BA 		blt	.L144
 544:main.c        ****     }
 545:main.c        **** 
 546:main.c        ****     InitADC();
 1962              		.loc 1 546 0
 1963 0d38 FEFFFFEB 		bl	InitADC
 1964              	.LVL46:
 547:main.c        **** 
 548:main.c        ****     Init_PWM();
 1965              		.loc 1 548 0
 1966 0d3c FEFFFFEB 		bl	Init_PWM
 1967              	.LBB307:
 1968              	.LBB308:
 1969              		.loc 2 521 0
 1970 0d40 0B2CE0E3 		mvn	r2, #2816
 1971 0d44 0237A0E3 		mov	r3, #524288
 1972 0d48 EB3002E5 		str	r3, [r2, #-235]
 1973              	.LBE308:
 1974              	.LBE307:
 549:main.c        **** 
 550:main.c        ****     AT91F_PIO_CfgInput(AT91C_BASE_PIOA, SW1_MASK);
 551:main.c        **** 
 552:main.c        ****     startBlinking(250000);
 1975              		.loc 1 552 0
 1976 0d4c 0C049FE5 		ldr	r0, .L205+24
 1977              	.LBB309:
 1978              	.LBB310:
 1979              		.loc 2 522 0
 1980 0d50 FF3002E5 		str	r3, [r2, #-255]
 1981              	.LBE310:
 1982              	.LBE309:
 1983              		.loc 1 552 0
 1984 0d54 FEFFFFEB 		bl	startBlinking
 1985              	.L146:
 553:main.c        **** 
 554:main.c        ****     while (1)
 555:main.c        ****     {
 556:main.c        ****         pressure = (int)GetValue_chanel6();
 1986              		.loc 1 556 0
 1987 0d58 FEFFFFEB 		bl	GetValue_chanel6
 1988 0d5c 00349FE5 		ldr	r3, .L205+28
 1989 0d60 000083E5 		str	r0, [r3, #0]
 557:main.c        ****         position = (int)GetValue_chanel5();
 1990              		.loc 1 557 0
 1991 0d64 FEFFFFEB 		bl	GetValue_chanel5
 558:main.c        **** 
 559:main.c        **** 
 560:main.c        ****         if (aatDiag == 0)
 1992              		.loc 1 560 0
 1993 0d68 F8339FE5 		ldr	r3, .L205+32
 1994 0d6c 0030D3E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 1995 0d70 000053E3 		cmp	r3, #0
 1996              		.loc 1 557 0
 1997 0d74 F0339FE5 		ldr	r3, .L205+36
 1998 0d78 000083E5 		str	r0, [r3, #0]
 1999              		.loc 1 560 0
 2000 0d7c 6203001A 		bne	.L147
 561:main.c        ****         {
 562:main.c        ****             setPosition(curForce);
 2001              		.loc 1 562 0
 2002 0d80 E8339FE5 		ldr	r3, .L205+40
 2003 0d84 000093E5 		ldr	r0, [r3, #0]
 2004 0d88 FEFFFFEB 		bl	setPosition
 2005 0d8c F60300EA 		b	.L149
 2006              	.L147:
 563:main.c        ****         }
 564:main.c        ****         else
 565:main.c        ****         {
 566:main.c        ****             switch (aatDiagStep)
 2007              		.loc 1 566 0
 2008 0d90 DC339FE5 		ldr	r3, .L205+44
 2009 0d94 0030D3E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 2010 0d98 040053E3 		cmp	r3, #4
 2011 0d9c 03F19F97 		ldrls	pc, [pc, r3, asl #2]
 2012 0da0 F60300EA 		b	.L149
 2013              		.p2align 2
 2014              	.L155:
 2015 0da4 B80D0000 		.word	.L150
 2016 0da8 EC0D0000 		.word	.L151
 2017 0dac 8C0E0000 		.word	.L152
 2018 0db0 000F0000 		.word	.L153
 2019 0db4 C00F0000 		.word	.L154
 2020              	.L150:
 2021 0db8 0040A0E3 		mov	r4, #0
 2022              	.LVL47:
 2023              	.L156:
 567:main.c        ****             {
 568:main.c        ****             case 0:
 569:main.c        ****                 for (i = 0; i < 5; i++)
 2024              		.loc 1 569 0
 2025 0dbc 014084E2 		add	r4, r4, #1
 570:main.c        ****                 {
 571:main.c        ****                     startBlinking(50000);
 2026              		.loc 1 571 0
 2027 0dc0 B0039FE5 		ldr	r0, .L205+48
 2028 0dc4 FEFFFFEB 		bl	startBlinking
 2029              		.loc 1 569 0
 2030 0dc8 050054E3 		cmp	r4, #5
 2031 0dcc 6D03001A 		bne	.L156
 572:main.c        ****                 }
 573:main.c        ****                 curPos = maxPos;
 2032              		.loc 1 573 0
 2033 0dd0 A4339FE5 		ldr	r3, .L205+52
 2034 0dd4 002093E5 		ldr	r2, [r3, #0]
 2035 0dd8 A0339FE5 		ldr	r3, .L205+56
 2036 0ddc 002083E5 		str	r2, [r3, #0]
 574:main.c        ****                 aatDiagStep = 1;
 2037              		.loc 1 574 0
 2038 0de0 8C339FE5 		ldr	r3, .L205+44
 2039 0de4 0120A0E3 		mov	r2, #1
 2040 0de8 B40300EA 		b	.L199
 2041              	.LVL48:
 2042              	.L151:
 575:main.c        ****                 break;
 576:main.c        ****             case 1:
 577:main.c        ****                 if (abs(curPos - position) > 5)
 2043              		.loc 1 577 0
 2044 0dec 8C439FE5 		ldr	r4, .L205+56
 2045              	.LVL49:
 2046 0df0 002094E5 		ldr	r2, [r4, #0]
 2047 0df4 023060E0 		rsb	r3, r0, r2
 2048 0df8 000053E3 		cmp	r3, #0
 2049 0dfc 003063B2 		rsblt	r3, r3, #0
 2050 0e00 050053E3 		cmp	r3, #5
 2051 0e04 8A0300DA 		ble	.L158
 578:main.c        ****                 {
 579:main.c        ****                     if (curPos > position)
 2052              		.loc 1 579 0
 2053 0e08 000052E1 		cmp	r2, r0
 580:main.c        ****                     {
 581:main.c        ****                         lowerDown(85000);
 2054              		.loc 1 581 0
 2055 0e0c 70039FC5 		ldrgt	r0, .L205+60
 2056 0e10 FEFFFFCB 		blgt	lowerDown
 2057              	.L160:
 582:main.c        ****                     }
 583:main.c        ****                     if (curPos < position)
 2058              		.loc 1 583 0
 2059 0e14 50239FE5 		ldr	r2, .L205+36
 2060 0e18 003094E5 		ldr	r3, [r4, #0]
 2061 0e1c 002092E5 		ldr	r2, [r2, #0]
 2062 0e20 020053E1 		cmp	r3, r2
 584:main.c        ****                     {
 585:main.c        ****                         liftUp(85000);
 2063              		.loc 1 585 0
 2064 0e24 58039FB5 		ldrlt	r0, .L205+60
 2065              		.loc 1 583 0
 2066 0e28 F50300BA 		blt	.L200
 2067 0e2c F60300EA 		b	.L149
 2068              	.L158:
 2069              	.LBB311:
 2070              	.LBB312:
 2071              	.LBB313:
 2072              	.LBB314:
 2073              		.loc 2 620 0
 2074 0e30 0B3CE0E3 		mvn	r3, #2816
 2075 0e34 8020A0E3 		mov	r2, #128
 2076 0e38 CB2003E5 		str	r2, [r3, #-203]
 2077              	.LBE314:
 2078              	.LBE313:
 2079              	.LBB315:
 2080              	.LBB316:
 2081 0e3c 4020A0E3 		mov	r2, #64
 2082 0e40 CB2003E5 		str	r2, [r3, #-203]
 2083 0e44 0040A0E3 		mov	r4, #0
 2084              	.LVL50:
 2085              	.L163:
 2086              	.LBE316:
 2087              	.LBE315:
 2088              	.LBE312:
 2089              	.LBE311:
 586:main.c        ****                     }
 587:main.c        ****                 }
 588:main.c        ****                 else
 589:main.c        ****                 {
 590:main.c        ****                     releasePosition();
 591:main.c        ****                     for (i = 0; i < 5; i++)
 2090              		.loc 1 591 0
 2091 0e48 014084E2 		add	r4, r4, #1
 592:main.c        ****                     {
 593:main.c        ****                         startBlinking(50000);
 2092              		.loc 1 593 0
 2093 0e4c 24039FE5 		ldr	r0, .L205+48
 2094 0e50 FEFFFFEB 		bl	startBlinking
 2095              		.loc 1 591 0
 2096 0e54 050054E3 		cmp	r4, #5
 2097 0e58 9003001A 		bne	.L163
 594:main.c        ****                     }
 595:main.c        ****                     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED1);
 596:main.c        ****                     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED2);
 597:main.c        ****                     AT91F_PIO_ClearOutput( AT91C_BASE_PIOA, LED3);
 598:main.c        ****                     AT91F_PIO_SetOutput( AT91C_BASE_PIOA, LED2);
 599:main.c        ****                     aatDiagStep = 2;
 2098              		.loc 1 599 0
 2099 0e5c 10339FE5 		ldr	r3, .L205+44
 2100 0e60 0210A0E3 		mov	r1, #2
 2101 0e64 0010C3E5 		strb	r1, [r3, #0]
 2102              	.LBB317:
 2103              	.LBB318:
 2104              		.loc 2 620 0
 2105 0e68 0B2CE0E3 		mvn	r2, #2816
 2106 0e6c 0830A0E3 		mov	r3, #8
 2107 0e70 CB3002E5 		str	r3, [r2, #-203]
 2108              	.LBE318:
 2109              	.LBE317:
 2110              	.LBB319:
 2111              	.LBB320:
 2112 0e74 1000A0E3 		mov	r0, #16
 2113              	.LBE320:
 2114              	.LBE319:
 2115              	.LBB321:
 2116              	.LBB322:
 2117 0e78 183083E2 		add	r3, r3, #24
 2118              	.LBE322:
 2119              	.LBE321:
 2120              	.LBB323:
 2121              	.LBB324:
 2122 0e7c CB0002E5 		str	r0, [r2, #-203]
 2123              	.LBE324:
 2124              	.LBE323:
 2125              	.LBB325:
 2126              	.LBB326:
 2127 0e80 CB3002E5 		str	r3, [r2, #-203]
 2128              	.LBE326:
 2129              	.LBE325:
 2130              	.LBB327:
 2131              	.LBB328:
 2132              		.loc 2 609 0
 2133 0e84 CF0002E5 		str	r0, [r2, #-207]
 2134 0e88 F60300EA 		b	.L149
 2135              	.LVL51:
 2136              	.L152:
 2137              	.LBE328:
 2138              	.LBE327:
 600:main.c        ****                 }
 601:main.c        ****                 break;
 602:main.c        ****             case 2:
 603:main.c        ****                 if (pressure < 25 && position > minPos)
 2139              		.loc 1 603 0
 2140 0e8c D0329FE5 		ldr	r3, .L205+28
 2141 0e90 003093E5 		ldr	r3, [r3, #0]
 2142 0e94 180053E3 		cmp	r3, #24
 2143 0e98 B60300CA 		bgt	.L165
 2144 0e9c E4329FE5 		ldr	r3, .L205+64
 2145 0ea0 003093E5 		ldr	r3, [r3, #0]
 2146 0ea4 030050E1 		cmp	r0, r3
 604:main.c        ****                 {
 605:main.c        ****                     liftUp(minDiagForce);
 2147              		.loc 1 605 0
 2148 0ea8 DC329FC5 		ldrgt	r3, .L205+68
 2149              		.loc 1 603 0
 2150 0eac F40300CA 		bgt	.L204
 606:main.c        ****                 }
 607:main.c        ****                 else
 608:main.c        ****                 {
 609:main.c        ****                     if (pressure < 25)
 610:main.c        ****                     {
 611:main.c        ****                         curPos = maxPos;
 2151              		.loc 1 611 0
 2152 0eb0 C4329FE5 		ldr	r3, .L205+52
 2153 0eb4 002093E5 		ldr	r2, [r3, #0]
 2154 0eb8 C0329FE5 		ldr	r3, .L205+56
 612:main.c        ****                         Delay(100000);
 2155              		.loc 1 612 0
 2156 0ebc CC029FE5 		ldr	r0, .L205+72
 2157              		.loc 1 611 0
 2158 0ec0 002083E5 		str	r2, [r3, #0]
 2159              		.loc 1 612 0
 2160 0ec4 FEFFFFEB 		bl	Delay
 613:main.c        ****                         printTrace("DIAG#2#FAILED\r\n");
 2161              		.loc 1 613 0
 2162 0ec8 C4029FE5 		ldr	r0, .L205+76
 2163              	.L203:
 2164 0ecc FEFFFFEB 		bl	printTrace
 614:main.c        ****                         aatDiag = 0;
 2165              		.loc 1 614 0
 2166 0ed0 90329FE5 		ldr	r3, .L205+32
 2167 0ed4 0020A0E3 		mov	r2, #0
 2168              	.LVL52:
 2169              	.L199:
 2170 0ed8 0020C3E5 		strb	r2, [r3, #0]
 2171 0edc F60300EA 		b	.L149
 2172              	.LVL53:
 2173              	.L165:
 615:main.c        ****                     }
 616:main.c        ****                     else
 617:main.c        ****                     {
 618:main.c        ****                         Delay(100000);
 2174              		.loc 1 618 0
 2175 0ee0 A8029FE5 		ldr	r0, .L205+72
 2176 0ee4 FEFFFFEB 		bl	Delay
 619:main.c        ****                         printTrace("DIAG#2#DONE\r\n");
 2177              		.loc 1 619 0
 2178 0ee8 A8029FE5 		ldr	r0, .L205+80
 2179 0eec FEFFFFEB 		bl	printTrace
 620:main.c        ****                         aatDiagStep = 3;
 621:main.c        ****                         diagForce = minDiagForce;
 2180              		.loc 1 621 0
 2181 0ef0 94329FE5 		ldr	r3, .L205+68
 2182 0ef4 001093E5 		ldr	r1, [r3, #0]
 2183              		.loc 1 620 0
 2184 0ef8 0320A0E3 		mov	r2, #3
 2185 0efc E90300EA 		b	.L201
 2186              	.L153:
 622:main.c        ****                     }
 623:main.c        ****                     //releasePosition();
 624:main.c        ****                 }
 625:main.c        ****                 break;
 626:main.c        ****             case 3:
 627:main.c        ****                 if (pressure < lockDiagPressure && position > minPos)
 2187              		.loc 1 627 0
 2188 0f00 5C329FE5 		ldr	r3, .L205+28
 2189 0f04 002093E5 		ldr	r2, [r3, #0]
 2190 0f08 8C329FE5 		ldr	r3, .L205+84
 2191 0f0c 003093E5 		ldr	r3, [r3, #0]
 2192 0f10 030052E1 		cmp	r2, r3
 2193 0f14 D10300AA 		bge	.L169
 2194 0f18 68329FE5 		ldr	r3, .L205+64
 2195 0f1c 003093E5 		ldr	r3, [r3, #0]
 2196 0f20 030050E1 		cmp	r0, r3
 2197 0f24 D10300DA 		ble	.L169
 628:main.c        ****                 {
 629:main.c        ****                     if (diagForce < lockDiagForce)
 2198              		.loc 1 629 0
 2199 0f28 70029FE5 		ldr	r0, .L205+88
 2200 0f2c 70329FE5 		ldr	r3, .L205+92
 2201 0f30 002090E5 		ldr	r2, [r0, #0]
 2202 0f34 003093E5 		ldr	r3, [r3, #0]
 2203 0f38 030052E1 		cmp	r2, r3
 630:main.c        ****                     {
 631:main.c        ****                         diagForce += 100;
 2204              		.loc 1 631 0
 2205 0f3c 643082B2 		addlt	r3, r2, #100
 2206 0f40 003080B5 		strlt	r3, [r0, #0]
 632:main.c        ****                     }
 633:main.c        ****                     liftUp(diagForce);
 2207              		.loc 1 633 0
 2208 0f44 000090E5 		ldr	r0, [r0, #0]
 2209 0f48 F50300EA 		b	.L200
 2210              	.L169:
 634:main.c        ****                 }
 635:main.c        ****                 else
 636:main.c        ****                 {
 637:main.c        ****                     if (position < minPos)
 2211              		.loc 1 637 0
 2212 0f4c 34329FE5 		ldr	r3, .L205+64
 2213 0f50 003093E5 		ldr	r3, [r3, #0]
 2214 0f54 030050E1 		cmp	r0, r3
 2215 0f58 DC0300AA 		bge	.L174
 638:main.c        ****                     {
 639:main.c        ****                         Delay(100000);
 2216              		.loc 1 639 0
 2217 0f5c 2C029FE5 		ldr	r0, .L205+72
 2218 0f60 FEFFFFEB 		bl	Delay
 640:main.c        ****                         printTrace("DIAG#3#FAILED\r\n");
 2219              		.loc 1 640 0
 2220 0f64 3C029FE5 		ldr	r0, .L205+96
 2221 0f68 FEFFFFEB 		bl	printTrace
 641:main.c        ****                         aatDiag = 0;
 2222              		.loc 1 641 0
 2223 0f6c F4319FE5 		ldr	r3, .L205+32
 2224 0f70 0020A0E3 		mov	r2, #0
 2225 0f74 0020C3E5 		strb	r2, [r3, #0]
 2226              	.L174:
 642:main.c        ****                     }
 643:main.c        ****                     if (pressure >= lockDiagPressure)
 2227              		.loc 1 643 0
 2228 0f78 E4319FE5 		ldr	r3, .L205+28
 2229 0f7c 002093E5 		ldr	r2, [r3, #0]
 2230 0f80 14329FE5 		ldr	r3, .L205+84
 2231 0f84 003093E5 		ldr	r3, [r3, #0]
 2232 0f88 030052E1 		cmp	r2, r3
 2233 0f8c F60300BA 		blt	.L149
 644:main.c        ****                     {
 645:main.c        ****                         Delay(100000);
 2234              		.loc 1 645 0
 2235 0f90 F8019FE5 		ldr	r0, .L205+72
 2236 0f94 FEFFFFEB 		bl	Delay
 646:main.c        ****                         printTrace("DIAG#3#DONE\r\n");
 2237              		.loc 1 646 0
 2238 0f98 0C029FE5 		ldr	r0, .L205+100
 2239 0f9c FEFFFFEB 		bl	printTrace
 647:main.c        ****                         aatDiagStep = 4;
 648:main.c        ****                         diagForce = maxForce;
 2240              		.loc 1 648 0
 2241 0fa0 08329FE5 		ldr	r3, .L205+104
 2242 0fa4 001093E5 		ldr	r1, [r3, #0]
 2243              		.loc 1 647 0
 2244 0fa8 0420A0E3 		mov	r2, #4
 2245              	.L201:
 2246 0fac C0319FE5 		ldr	r3, .L205+44
 2247 0fb0 0020C3E5 		strb	r2, [r3, #0]
 2248              		.loc 1 648 0
 2249 0fb4 E4319FE5 		ldr	r3, .L205+88
 2250 0fb8 001083E5 		str	r1, [r3, #0]
 2251 0fbc F60300EA 		b	.L149
 2252              	.L154:
 649:main.c        ****                     }
 650:main.c        ****                 }
 651:main.c        ****                 break;
 652:main.c        ****             case 4:
 653:main.c        ****                 if (position < minPos)
 2253              		.loc 1 653 0
 2254 0fc0 C0319FE5 		ldr	r3, .L205+64
 2255 0fc4 003093E5 		ldr	r3, [r3, #0]
 2256 0fc8 030050E1 		cmp	r0, r3
 654:main.c        ****                 {
 655:main.c        ****                     printTrace("DIAG#4#FAILED\r\n");
 2257              		.loc 1 655 0
 2258 0fcc E0019FB5 		ldrlt	r0, .L205+108
 2259              		.loc 1 653 0
 2260 0fd0 B10300BA 		blt	.L203
 656:main.c        ****                     aatDiag = 0;
 657:main.c        ****                 }
 658:main.c        ****                 else
 659:main.c        ****                 {
 660:main.c        ****                     liftUp(diagForce);
 2261              		.loc 1 660 0
 2262 0fd4 C4319FE5 		ldr	r3, .L205+88
 2263              	.L204:
 2264 0fd8 000093E5 		ldr	r0, [r3, #0]
 2265              	.L200:
 2266 0fdc FEFFFFEB 		bl	liftUp
 2267              	.LVL54:
 2268              	.L149:
 661:main.c        ****                 }
 662:main.c        ****                 break;
 663:main.c        ****             }
 664:main.c        ****         }
 665:main.c        **** 
 666:main.c        ****         length = pCDC.Read(&pCDC, data, MSG_SIZE);
 2269              		.loc 1 666 0
 2270 0fe0 68319FE5 		ldr	r3, .L205+8
 2271 0fe4 0C408DE2 		add	r4, sp, #12
 2272              	.LVL55:
 2273 0fe8 084044E2 		sub	r4, r4, #8
 2274 0fec 0300A0E1 		mov	r0, r3
 2275 0ff0 0410A0E1 		mov	r1, r4
 2276 0ff4 FA2FA0E3 		mov	r2, #1000
 2277 0ff8 0FE0A0E1 		mov	lr, pc
 2278 0ffc 14F093E5 		ldr	pc, [r3, #20]
 667:main.c        **** 
 668:main.c        ****         if (length > 0)
 2279              		.loc 1 668 0
 2280 1000 000050E3 		cmp	r0, #0
 669:main.c        ****         {
 670:main.c        ****             parseSettings(data);
 2281              		.loc 1 670 0
 2282 1004 0400A011 		movne	r0, r4
 2283 1008 FEFFFF1B 		blne	parseSettings
 2284              	.L179:
 2285 100c 0010A0E3 		mov	r1, #0
 2286              	.LVL56:
 2287              	.L181:
 2288              	.LBB329:
 671:main.c        ****         }
 672:main.c        ****         for(int r = 0; r < MSG_SIZE; r++)
 673:main.c        ****         {
 674:main.c        ****             data[r] = '\0';
 2289              		.loc 1 674 0
 2290 1010 0C308DE2 		add	r3, sp, #12
 2291 1014 083043E2 		sub	r3, r3, #8
 2292 1018 0020A0E3 		mov	r2, #0
 2293 101c 0320C1E7 		strb	r2, [r1, r3]
 2294              		.loc 1 672 0
 2295 1020 011081E2 		add	r1, r1, #1
 2296 1024 FA0F51E3 		cmp	r1, #1000
 2297 1028 0204001A 		bne	.L181
 2298              	.LBE329:
 675:main.c        ****         }
 676:main.c        **** 
 677:main.c        ****         if (aatDiag == 0)
 2299              		.loc 1 677 0
 2300 102c 34319FE5 		ldr	r3, .L205+32
 2301 1030 0030D3E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 2302 1034 020053E1 		cmp	r3, r2
 2303 1038 3404001A 		bne	.L183
 678:main.c        ****         {
 679:main.c        ****             if (reading == 1)
 2304              		.loc 1 679 0
 2305 103c 74319FE5 		ldr	r3, .L205+112
 2306 1040 0030D3E5 		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 2307 1044 010053E3 		cmp	r3, #1
 2308 1048 4604001A 		bne	.L185
 680:main.c        ****             {
 681:main.c        ****                 if (dataReading == 0)
 2309              		.loc 1 681 0
 2310 104c 68419FE5 		ldr	r4, .L205+116
 2311 1050 0030D4E5 		ldrb	r3, [r4, #0]	@ zero_extendqisi2
 2312 1054 020053E1 		cmp	r3, r2
 2313 1058 2304001A 		bne	.L187
 682:main.c        ****                 {
 683:main.c        ****                     sprintf((char *)res,"PRESSURE: %d\r\n", pressure);
 2314              		.loc 1 683 0
 2315 105c 00319FE5 		ldr	r3, .L205+28
 2316 1060 58119FE5 		ldr	r1, .L205+120
 2317              	.LVL57:
 2318 1064 002093E5 		ldr	r2, [r3, #0]
 2319 1068 54019FE5 		ldr	r0, .L205+124
 2320 106c FEFFFFEB 		bl	sprintf
 684:main.c        ****                     printTrace(res);
 2321              		.loc 1 684 0
 2322 1070 4C019FE5 		ldr	r0, .L205+124
 2323 1074 FEFFFFEB 		bl	printTrace
 685:main.c        ****                     sprintf((char *)pos,"POSITION: %d\r\n", position);
 2324              		.loc 1 685 0
 2325 1078 EC309FE5 		ldr	r3, .L205+36
 2326 107c 44019FE5 		ldr	r0, .L205+128
 2327 1080 002093E5 		ldr	r2, [r3, #0]
 2328 1084 40119FE5 		ldr	r1, .L205+132
 2329 1088 FEFFFFEB 		bl	sprintf
 686:main.c        ****                     printTrace(pos);
 2330              		.loc 1 686 0
 2331 108c 34019FE5 		ldr	r0, .L205+128
 2332 1090 FEFFFFEB 		bl	printTrace
 2333              	.LVL58:
 2334              	.L187:
 687:main.c        ****                 }
 688:main.c        ****                 if (dataReading == 1)
 2335              		.loc 1 688 0
 2336 1094 0030D4E5 		ldrb	r3, [r4, #0]	@ zero_extendqisi2
 2337 1098 010053E3 		cmp	r3, #1
 2338 109c 4604001A 		bne	.L185
 689:main.c        ****                 {
 690:main.c        ****                     sprintf((char *)res,"%d|%d|%d|\r\n", pressure, position, direction);
 2339              		.loc 1 690 0
 2340 10a0 28319FE5 		ldr	r3, .L205+136
 2341 10a4 00C093E5 		ldr	ip, [r3, #0]
 2342 10a8 B4309FE5 		ldr	r3, .L205+28
 2343 10ac 002093E5 		ldr	r2, [r3, #0]
 2344 10b0 B4309FE5 		ldr	r3, .L205+36
 2345 10b4 18119FE5 		ldr	r1, .L205+140
 2346              	.LVL59:
 2347 10b8 003093E5 		ldr	r3, [r3, #0]
 2348 10bc 00019FE5 		ldr	r0, .L205+124
 2349 10c0 00C08DE5 		str	ip, [sp, #0]
 2350 10c4 FEFFFFEB 		bl	sprintf
 691:main.c        ****                     pCDC.Write(&pCDC, res, strlen(res));
 2351              		.loc 1 691 0
 2352 10c8 F4009FE5 		ldr	r0, .L205+124
 2353 10cc 7C409FE5 		ldr	r4, .L205+8
 2354 10d0 FEFFFFEB 		bl	strlen
 2355 10d4 410400EA 		b	.L202
 2356              	.LVL60:
 2357              	.L183:
 692:main.c        ****                 }
 693:main.c        ****             }
 694:main.c        ****         }
 695:main.c        ****         else
 696:main.c        ****         {
 697:main.c        ****             sprintf((char *)res,"%d|%d|%d|\r\n", pressure, position, direction);
 2358              		.loc 1 697 0
 2359 10d8 F0309FE5 		ldr	r3, .L205+136
 2360 10dc 00C093E5 		ldr	ip, [r3, #0]
 2361 10e0 7C309FE5 		ldr	r3, .L205+28
 2362 10e4 002093E5 		ldr	r2, [r3, #0]
 2363 10e8 7C309FE5 		ldr	r3, .L205+36
 2364 10ec E0109FE5 		ldr	r1, .L205+140
 2365              	.LVL61:
 2366 10f0 003093E5 		ldr	r3, [r3, #0]
 2367 10f4 C8009FE5 		ldr	r0, .L205+124
 2368 10f8 00C08DE5 		str	ip, [sp, #0]
 2369 10fc FEFFFFEB 		bl	sprintf
 698:main.c        ****             pCDC.Write(&pCDC, res, strlen(res));
 2370              		.loc 1 698 0
 2371 1100 BC009FE5 		ldr	r0, .L205+124
 2372 1104 44409FE5 		ldr	r4, .L205+8
 2373 1108 FEFFFFEB 		bl	strlen
 2374              	.L202:
 2375 110c 0020A0E1 		mov	r2, r0
 2376 1110 AC109FE5 		ldr	r1, .L205+124
 2377 1114 0400A0E1 		mov	r0, r4
 2378 1118 0FE0A0E1 		mov	lr, pc
 2379 111c 10F094E5 		ldr	pc, [r4, #16]
 2380              	.LVL62:
 2381              	.L185:
 699:main.c        ****         }
 700:main.c        **** 
 701:main.c        ****         pos[strlen(pos)] = '\0';
 2382              		.loc 1 701 0
 2383 1120 A0409FE5 		ldr	r4, .L205+128
 2384 1124 0400A0E1 		mov	r0, r4
 2385 1128 FEFFFFEB 		bl	strlen
 2386              	.LVL63:
 702:main.c        ****         res[strlen(res)] = '\0';
 2387              		.loc 1 702 0
 2388 112c 90609FE5 		ldr	r6, .L205+124
 2389              		.loc 1 701 0
 2390 1130 0050A0E3 		mov	r5, #0
 2391              	.LVL64:
 2392 1134 0050C4E7 		strb	r5, [r4, r0]
 2393              		.loc 1 702 0
 2394 1138 0600A0E1 		mov	r0, r6
 2395 113c FEFFFFEB 		bl	strlen
 2396 1140 0050C6E7 		strb	r5, [r6, r0]
 2397 1144 540300EA 		b	.L146
 2398              	.L206:
 2399              		.align	2
 2400              	.L205:
 2401 1148 00014800 		.word	4718848
 2402 114c 010400A5 		.word	-1526725631
 2403 1150 00000000 		.word	pCDC
 2404 1154 80FF1100 		.word	1179520
 2405 1158 00000000 		.word	settings
 2406 115c 40030000 		.word	.LC44
 2407 1160 90D00300 		.word	250000
 2408 1164 00000000 		.word	pressure
 2409 1168 00000000 		.word	aatDiag
 2410 116c 00000000 		.word	position
 2411 1170 00000000 		.word	curForce
 2412 1174 00000000 		.word	aatDiagStep
 2413 1178 50C30000 		.word	50000
 2414 117c 00000000 		.word	maxPos
 2415 1180 00000000 		.word	curPos
 2416 1184 084C0100 		.word	85000
 2417 1188 00000000 		.word	minPos
 2418 118c 00000000 		.word	minDiagForce
 2419 1190 A0860100 		.word	100000
 2420 1194 D4020000 		.word	.LC45
 2421 1198 E4020000 		.word	.LC46
 2422 119c 00000000 		.word	lockDiagPressure
 2423 11a0 00000000 		.word	diagForce
 2424 11a4 00000000 		.word	lockDiagForce
 2425 11a8 F4020000 		.word	.LC47
 2426 11ac 38000000 		.word	.LC7
 2427 11b0 00000000 		.word	maxForce
 2428 11b4 04030000 		.word	.LC48
 2429 11b8 00000000 		.word	reading
 2430 11bc 00000000 		.word	dataReading
 2431 11c0 14030000 		.word	.LC49
 2432 11c4 00000000 		.word	res
 2433 11c8 00000000 		.word	pos
 2434 11cc 24030000 		.word	.LC50
 2435 11d0 00000000 		.word	direction
 2436 11d4 34030000 		.word	.LC51
 2437              	.LFE300:
 2439              		.global	LedSpeed
 2440              		.data
 2441              		.align	2
 2444              	LedSpeed:
 2445 0000 F0A70300 		.word	239600
 2446              		.global	maxPos
 2447              		.align	2
 2450              	maxPos:
 2451 0004 84030000 		.word	900
 2452              		.global	minPos
 2453              		.align	2
 2456              	minPos:
 2457 0008 2C010000 		.word	300
 2458              		.global	curPos
 2459              		.align	2
 2462              	curPos:
 2463 000c 58020000 		.word	600
 2464              		.global	maxForce
 2465              		.align	2
 2468              	maxForce:
 2469 0010 A0860100 		.word	100000
 2470              		.global	minForce
 2471              		.align	2
 2474              	minForce:
 2475 0014 D0010100 		.word	66000
 2476              		.global	curForce
 2477              		.align	2
 2480              	curForce:
 2481 0018 D0010100 		.word	66000
 2482              		.global	reading
 2483              		.bss
 2486              	reading:
 2487 0000 00       		.space	1
 2488              		.global	dataReading
 2491              	dataReading:
 2492 0001 00       		.space	1
 2493              		.global	aatDiag
 2496              	aatDiag:
 2497 0002 00       		.space	1
 2498              		.global	aatDiagStep
 2501              	aatDiagStep:
 2502 0003 00       		.space	1
 2503              		.global	minDiagForce
 2504              		.data
 2505              		.align	2
 2508              	minDiagForce:
 2509 001c 905F0100 		.word	90000
 2510              		.global	lockDiagForce
 2511              		.align	2
 2514              	lockDiagForce:
 2515 0020 A0860100 		.word	100000
 2516              		.global	lockDiagPressure
 2517              		.bss
 2518              		.align	2
 2521              	lockDiagPressure:
 2522 0004 00000000 		.space	4
 2523              		.global	diagForce
 2524              		.data
 2525              		.align	2
 2528              	diagForce:
 2529 0024 80380100 		.word	80000
 2530              		.comm	res,1000,1
 2531              		.comm	pos,1000,1
 2532              		.comm	cmd,1000,1
 2533              		.comm	msg,1000,1
 2534              		.comm	settings,128,1
 2535              		.comm	pressure,4,4
 2536              		.comm	position,4,4
 2537              		.comm	direction,4,4
 2538              		.comm	pCDC,24,4
 2793              	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 main.c
     /tmp/cc8JX1Ih.s:13     .text:00000000 flashInit
     /tmp/cc8JX1Ih.s:20     .text:00000000 $a
     /tmp/cc8JX1Ih.s:39     .text:00000020 $d
     /tmp/cc8JX1Ih.s:45     .text:00000024 Delay
     /tmp/cc8JX1Ih.s:52     .text:00000024 $a
     /tmp/cc8JX1Ih.s:77     .text:00000050 printTrace
     /tmp/cc8JX1Ih.s:107    .text:00000088 $d
     /tmp/cc8JX1Ih.s:2491   .bss:00000001 dataReading
                            *COM*:00000018 pCDC
     /tmp/cc8JX1Ih.s:114    .text:00000090 clearLEDs
     /tmp/cc8JX1Ih.s:124    .text:00000090 $a
     /tmp/cc8JX1Ih.s:155    .text:000000b0 releasePosition
     /tmp/cc8JX1Ih.s:189    .text:000000c8 startBlinking
     /tmp/cc8JX1Ih.s:283    .text:00000128 blinkingGreen
     /tmp/cc8JX1Ih.s:457    .text:00000150 parseSettings
     /tmp/cc8JX1Ih.s:1290   .text:00000954 $d
     /tmp/cc8JX1Ih.s:2496   .bss:00000002 aatDiag
     /tmp/cc8JX1Ih.s:2501   .bss:00000003 aatDiagStep
     /tmp/cc8JX1Ih.s:2468   .data:00000010 maxForce
     /tmp/cc8JX1Ih.s:2528   .data:00000024 diagForce
     /tmp/cc8JX1Ih.s:2450   .data:00000004 maxPos
                            *COM*:000003e8 msg
     /tmp/cc8JX1Ih.s:2456   .data:00000008 minPos
     /tmp/cc8JX1Ih.s:2462   .data:0000000c curPos
     /tmp/cc8JX1Ih.s:2474   .data:00000014 minForce
     /tmp/cc8JX1Ih.s:2480   .data:00000018 curForce
     /tmp/cc8JX1Ih.s:2508   .data:0000001c minDiagForce
     /tmp/cc8JX1Ih.s:2514   .data:00000020 lockDiagForce
                            *COM*:00000004 pressure
     /tmp/cc8JX1Ih.s:2521   .bss:00000004 lockDiagPressure
                            *COM*:00000080 settings
     /tmp/cc8JX1Ih.s:2486   .bss:00000000 reading
     /tmp/cc8JX1Ih.s:1360   .text:00000a58 setForce
     /tmp/cc8JX1Ih.s:1370   .text:00000a58 $a
     /tmp/cc8JX1Ih.s:1418   .text:00000a88 $d
     /tmp/cc8JX1Ih.s:1426   .text:00000a94 lowerDown
     /tmp/cc8JX1Ih.s:1432   .text:00000a94 $a
     /tmp/cc8JX1Ih.s:1461   .text:00000ac0 $d
                            *COM*:00000004 direction
     /tmp/cc8JX1Ih.s:1467   .text:00000ac4 liftUp
     /tmp/cc8JX1Ih.s:1473   .text:00000ac4 $a
     /tmp/cc8JX1Ih.s:1502   .text:00000af0 $d
     /tmp/cc8JX1Ih.s:1508   .text:00000af4 AT91F_USB_Open
     /tmp/cc8JX1Ih.s:1514   .text:00000af4 $a
     /tmp/cc8JX1Ih.s:1561   .text:00000b3c $d
     /tmp/cc8JX1Ih.s:1568   .text:00000b44 Init_PWM
     /tmp/cc8JX1Ih.s:1576   .text:00000b44 $a
     /tmp/cc8JX1Ih.s:1705   .text:00000bc0 $d
     /tmp/cc8JX1Ih.s:1715   .text:00000bd4 setPosition
     /tmp/cc8JX1Ih.s:1721   .text:00000bd4 $a
     /tmp/cc8JX1Ih.s:1792   .text:00000c44 $d
                            *COM*:00000004 position
     /tmp/cc8JX1Ih.s:1829   .text:00000c4c main
     /tmp/cc8JX1Ih.s:1834   .text:00000c4c $a
     /tmp/cc8JX1Ih.s:2015   .text:00000da4 $d
     /tmp/cc8JX1Ih.s:2021   .text:00000db8 $a
     /tmp/cc8JX1Ih.s:2401   .text:00001148 $d
                            *COM*:000003e8 res
                            *COM*:000003e8 pos
     /tmp/cc8JX1Ih.s:2444   .data:00000000 LedSpeed
     /tmp/cc8JX1Ih.s:2445   .data:00000000 $d
                            *COM*:000003e8 cmd

UNDEFINED SYMBOLS
strlen
strtok
strcmp
atoi
sprintf
flashWrite
AT91F_CDC_Open
memcpy
InitADC
GetValue_chanel6
GetValue_chanel5
